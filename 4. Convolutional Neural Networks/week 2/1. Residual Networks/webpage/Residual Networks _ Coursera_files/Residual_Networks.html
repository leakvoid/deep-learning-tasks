<!DOCTYPE html>
<!-- saved from url=(0074)https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb# -->
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Residual_Networks - Jupyter Notebook</title>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distinguish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./codemirror.css">


    <link rel="stylesheet" href="./style.min.css" type="text/css">
    

<link rel="stylesheet" href="./override.css" type="text/css">
<link rel="stylesheet" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./custom.css" type="text/css">
    <script src="./promise.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./react.production.min.js" type="text/javascript"></script>
    <script src="./react-dom.production.min.js" type="text/javascript"></script>
    <script src="./index.js" type="text/javascript"></script>
    <script src="./require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20210605174542",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jed: 'components/jed/jed',
            jquery: 'components/jquery/jquery.min',
            json: 'components/requirejs-plugins/src/json',
            text: 'components/requirejs-text/text',
            bootstrap: 'components/bootstrap/dist/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/jquery-ui.min',
            moment: 'components/moment/min/moment-with-locales',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })

    document.nbjs_translations = {"domain": "nbjs", "locale_data": {"nbjs": {"": {"domain": "nbjs"}}}};
    document.documentElement.lang = navigator.language.toLowerCase();
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./custom.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/jupyter-js-widgets/extension" src="./extension.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/submit-button/main" src="./main.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/* Override the correction for the prompt area in https://github.com/jupyter/notebook/blob/dd41d9fd5c4f698bd7468612d877828a7eeb0e7a/IPython/html/static/notebook/less/outputarea.less#L110 */
.jupyter-widgets-output-area div.output_subarea {
    max-width: 100%;
}

/* Work-around for the bug fixed in https://github.com/jupyter/notebook/pull/2961 */
.jupyter-widgets-output-area > .out_prompt_overlay {
    display: none;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-Widget {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  cursor: default;
}


.p-Widget.p-mod-hidden {
  display: none !important;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-CommandPalette {
  display: flex;
  flex-direction: column;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.p-CommandPalette-search {
  flex: 0 0 auto;
}


.p-CommandPalette-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  min-height: 0;
  overflow: auto;
  list-style-type: none;
}


.p-CommandPalette-header {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}


.p-CommandPalette-item {
  display: flex;
  flex-direction: row;
}


.p-CommandPalette-itemIcon {
  flex: 0 0 auto;
}


.p-CommandPalette-itemContent {
  flex: 1 1 auto;
  overflow: hidden;
}


.p-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}


.p-CommandPalette-itemLabel {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-DockPanel {
  z-index: 0;
}


.p-DockPanel-widget {
  z-index: 0;
}


.p-DockPanel-tabBar {
  z-index: 1;
}


.p-DockPanel-handle {
  z-index: 2;
}


.p-DockPanel-handle.p-mod-hidden {
  display: none !important;
}


.p-DockPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}


.p-DockPanel-handle[data-orientation='horizontal'] {
  cursor: ew-resize;
}


.p-DockPanel-handle[data-orientation='vertical'] {
  cursor: ns-resize;
}


.p-DockPanel-handle[data-orientation='horizontal']:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}


.p-DockPanel-handle[data-orientation='vertical']:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}


.p-DockPanel-overlay {
  z-index: 3;
  box-sizing: border-box;
  pointer-events: none;
}


.p-DockPanel-overlay.p-mod-hidden {
  display: none !important;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-Menu {
  z-index: 10000;
  position: absolute;
  white-space: nowrap;
  overflow-x: hidden;
  overflow-y: auto;
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.p-Menu-content {
  margin: 0;
  padding: 0;
  display: table;
  list-style-type: none;
}


.p-Menu-item {
  display: table-row;
}


.p-Menu-item.p-mod-hidden,
.p-Menu-item.p-mod-collapsed {
  display: none !important;
}


.p-Menu-itemIcon,
.p-Menu-itemSubmenuIcon {
  display: table-cell;
  text-align: center;
}


.p-Menu-itemLabel {
  display: table-cell;
  text-align: left;
}


.p-Menu-itemShortcut {
  display: table-cell;
  text-align: right;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-MenuBar {
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.p-MenuBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  list-style-type: none;
}


.p-MenuBar-item {
  box-sizing: border-box;
}


.p-MenuBar-itemIcon,
.p-MenuBar-itemLabel {
  display: inline-block;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-ScrollBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.p-ScrollBar[data-orientation='horizontal'] {
  flex-direction: row;
}


.p-ScrollBar[data-orientation='vertical'] {
  flex-direction: column;
}


.p-ScrollBar-button {
  box-sizing: border-box;
  flex: 0 0 auto;
}


.p-ScrollBar-track {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
}


.p-ScrollBar-thumb {
  box-sizing: border-box;
  position: absolute;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-SplitPanel-child {
  z-index: 0;
}


.p-SplitPanel-handle {
  z-index: 1;
}


.p-SplitPanel-handle.p-mod-hidden {
  display: none !important;
}


.p-SplitPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}


.p-SplitPanel[data-orientation='horizontal'] > .p-SplitPanel-handle {
  cursor: ew-resize;
}


.p-SplitPanel[data-orientation='vertical'] > .p-SplitPanel-handle {
  cursor: ns-resize;
}


.p-SplitPanel[data-orientation='horizontal'] > .p-SplitPanel-handle:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}


.p-SplitPanel[data-orientation='vertical'] > .p-SplitPanel-handle:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.p-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
}


.p-TabBar[data-orientation='vertical'] {
  flex-direction: column;
}


.p-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}


.p-TabBar[data-orientation='horizontal'] > .p-TabBar-content {
  flex-direction: row;
}


.p-TabBar[data-orientation='vertical'] > .p-TabBar-content {
  flex-direction: column;
}


.p-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
}


.p-TabBar-tabIcon,
.p-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}


.p-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}


.p-TabBar-tab.p-mod-hidden {
  display: none !important;
}


.p-TabBar.p-mod-dragging .p-TabBar-tab {
  position: relative;
}


.p-TabBar.p-mod-dragging[data-orientation='horizontal'] .p-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}


.p-TabBar.p-mod-dragging[data-orientation='vertical'] .p-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}


.p-TabBar.p-mod-dragging .p-TabBar-tab.p-mod-dragging {
  transition: none;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/


.p-TabPanel-tabBar {
  z-index: 1;
}


.p-TabPanel-stackedPanel {
  z-index: 0;
}
</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/
</style><style type="text/css">/* Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

 .jupyter-widgets-disconnected::before {
    content: "\f127"; /* chain-broken */
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    color: #d9534f;
    padding: 3px;
    align-self: flex-start;
}
</style><style type="text/css">/**
 * The material design colors are adapted from google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 * https://github.com/danlevan/google-material-color/blob/f67ca5f4028b2f1b34862f64b0ca67323f91b088/dist/palette.var.css
 *
 * The license for the material design color CSS variables is as follows (see
 * https://github.com/danlevan/google-material-color/blob/f67ca5f4028b2f1b34862f64b0ca67323f91b088/LICENSE)
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014 Dan Le Van
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
:root {
  --md-red-50: #FFEBEE;
  --md-red-100: #FFCDD2;
  --md-red-200: #EF9A9A;
  --md-red-300: #E57373;
  --md-red-400: #EF5350;
  --md-red-500: #F44336;
  --md-red-600: #E53935;
  --md-red-700: #D32F2F;
  --md-red-800: #C62828;
  --md-red-900: #B71C1C;
  --md-red-A100: #FF8A80;
  --md-red-A200: #FF5252;
  --md-red-A400: #FF1744;
  --md-red-A700: #D50000;

  --md-pink-50: #FCE4EC;
  --md-pink-100: #F8BBD0;
  --md-pink-200: #F48FB1;
  --md-pink-300: #F06292;
  --md-pink-400: #EC407A;
  --md-pink-500: #E91E63;
  --md-pink-600: #D81B60;
  --md-pink-700: #C2185B;
  --md-pink-800: #AD1457;
  --md-pink-900: #880E4F;
  --md-pink-A100: #FF80AB;
  --md-pink-A200: #FF4081;
  --md-pink-A400: #F50057;
  --md-pink-A700: #C51162;

  --md-purple-50: #F3E5F5;
  --md-purple-100: #E1BEE7;
  --md-purple-200: #CE93D8;
  --md-purple-300: #BA68C8;
  --md-purple-400: #AB47BC;
  --md-purple-500: #9C27B0;
  --md-purple-600: #8E24AA;
  --md-purple-700: #7B1FA2;
  --md-purple-800: #6A1B9A;
  --md-purple-900: #4A148C;
  --md-purple-A100: #EA80FC;
  --md-purple-A200: #E040FB;
  --md-purple-A400: #D500F9;
  --md-purple-A700: #AA00FF;

  --md-deep-purple-50: #EDE7F6;
  --md-deep-purple-100: #D1C4E9;
  --md-deep-purple-200: #B39DDB;
  --md-deep-purple-300: #9575CD;
  --md-deep-purple-400: #7E57C2;
  --md-deep-purple-500: #673AB7;
  --md-deep-purple-600: #5E35B1;
  --md-deep-purple-700: #512DA8;
  --md-deep-purple-800: #4527A0;
  --md-deep-purple-900: #311B92;
  --md-deep-purple-A100: #B388FF;
  --md-deep-purple-A200: #7C4DFF;
  --md-deep-purple-A400: #651FFF;
  --md-deep-purple-A700: #6200EA;

  --md-indigo-50: #E8EAF6;
  --md-indigo-100: #C5CAE9;
  --md-indigo-200: #9FA8DA;
  --md-indigo-300: #7986CB;
  --md-indigo-400: #5C6BC0;
  --md-indigo-500: #3F51B5;
  --md-indigo-600: #3949AB;
  --md-indigo-700: #303F9F;
  --md-indigo-800: #283593;
  --md-indigo-900: #1A237E;
  --md-indigo-A100: #8C9EFF;
  --md-indigo-A200: #536DFE;
  --md-indigo-A400: #3D5AFE;
  --md-indigo-A700: #304FFE;

  --md-blue-50: #E3F2FD;
  --md-blue-100: #BBDEFB;
  --md-blue-200: #90CAF9;
  --md-blue-300: #64B5F6;
  --md-blue-400: #42A5F5;
  --md-blue-500: #2196F3;
  --md-blue-600: #1E88E5;
  --md-blue-700: #1976D2;
  --md-blue-800: #1565C0;
  --md-blue-900: #0D47A1;
  --md-blue-A100: #82B1FF;
  --md-blue-A200: #448AFF;
  --md-blue-A400: #2979FF;
  --md-blue-A700: #2962FF;

  --md-light-blue-50: #E1F5FE;
  --md-light-blue-100: #B3E5FC;
  --md-light-blue-200: #81D4FA;
  --md-light-blue-300: #4FC3F7;
  --md-light-blue-400: #29B6F6;
  --md-light-blue-500: #03A9F4;
  --md-light-blue-600: #039BE5;
  --md-light-blue-700: #0288D1;
  --md-light-blue-800: #0277BD;
  --md-light-blue-900: #01579B;
  --md-light-blue-A100: #80D8FF;
  --md-light-blue-A200: #40C4FF;
  --md-light-blue-A400: #00B0FF;
  --md-light-blue-A700: #0091EA;

  --md-cyan-50: #E0F7FA;
  --md-cyan-100: #B2EBF2;
  --md-cyan-200: #80DEEA;
  --md-cyan-300: #4DD0E1;
  --md-cyan-400: #26C6DA;
  --md-cyan-500: #00BCD4;
  --md-cyan-600: #00ACC1;
  --md-cyan-700: #0097A7;
  --md-cyan-800: #00838F;
  --md-cyan-900: #006064;
  --md-cyan-A100: #84FFFF;
  --md-cyan-A200: #18FFFF;
  --md-cyan-A400: #00E5FF;
  --md-cyan-A700: #00B8D4;

  --md-teal-50: #E0F2F1;
  --md-teal-100: #B2DFDB;
  --md-teal-200: #80CBC4;
  --md-teal-300: #4DB6AC;
  --md-teal-400: #26A69A;
  --md-teal-500: #009688;
  --md-teal-600: #00897B;
  --md-teal-700: #00796B;
  --md-teal-800: #00695C;
  --md-teal-900: #004D40;
  --md-teal-A100: #A7FFEB;
  --md-teal-A200: #64FFDA;
  --md-teal-A400: #1DE9B6;
  --md-teal-A700: #00BFA5;

  --md-green-50: #E8F5E9;
  --md-green-100: #C8E6C9;
  --md-green-200: #A5D6A7;
  --md-green-300: #81C784;
  --md-green-400: #66BB6A;
  --md-green-500: #4CAF50;
  --md-green-600: #43A047;
  --md-green-700: #388E3C;
  --md-green-800: #2E7D32;
  --md-green-900: #1B5E20;
  --md-green-A100: #B9F6CA;
  --md-green-A200: #69F0AE;
  --md-green-A400: #00E676;
  --md-green-A700: #00C853;

  --md-light-green-50: #F1F8E9;
  --md-light-green-100: #DCEDC8;
  --md-light-green-200: #C5E1A5;
  --md-light-green-300: #AED581;
  --md-light-green-400: #9CCC65;
  --md-light-green-500: #8BC34A;
  --md-light-green-600: #7CB342;
  --md-light-green-700: #689F38;
  --md-light-green-800: #558B2F;
  --md-light-green-900: #33691E;
  --md-light-green-A100: #CCFF90;
  --md-light-green-A200: #B2FF59;
  --md-light-green-A400: #76FF03;
  --md-light-green-A700: #64DD17;

  --md-lime-50: #F9FBE7;
  --md-lime-100: #F0F4C3;
  --md-lime-200: #E6EE9C;
  --md-lime-300: #DCE775;
  --md-lime-400: #D4E157;
  --md-lime-500: #CDDC39;
  --md-lime-600: #C0CA33;
  --md-lime-700: #AFB42B;
  --md-lime-800: #9E9D24;
  --md-lime-900: #827717;
  --md-lime-A100: #F4FF81;
  --md-lime-A200: #EEFF41;
  --md-lime-A400: #C6FF00;
  --md-lime-A700: #AEEA00;

  --md-yellow-50: #FFFDE7;
  --md-yellow-100: #FFF9C4;
  --md-yellow-200: #FFF59D;
  --md-yellow-300: #FFF176;
  --md-yellow-400: #FFEE58;
  --md-yellow-500: #FFEB3B;
  --md-yellow-600: #FDD835;
  --md-yellow-700: #FBC02D;
  --md-yellow-800: #F9A825;
  --md-yellow-900: #F57F17;
  --md-yellow-A100: #FFFF8D;
  --md-yellow-A200: #FFFF00;
  --md-yellow-A400: #FFEA00;
  --md-yellow-A700: #FFD600;

  --md-amber-50: #FFF8E1;
  --md-amber-100: #FFECB3;
  --md-amber-200: #FFE082;
  --md-amber-300: #FFD54F;
  --md-amber-400: #FFCA28;
  --md-amber-500: #FFC107;
  --md-amber-600: #FFB300;
  --md-amber-700: #FFA000;
  --md-amber-800: #FF8F00;
  --md-amber-900: #FF6F00;
  --md-amber-A100: #FFE57F;
  --md-amber-A200: #FFD740;
  --md-amber-A400: #FFC400;
  --md-amber-A700: #FFAB00;

  --md-orange-50: #FFF3E0;
  --md-orange-100: #FFE0B2;
  --md-orange-200: #FFCC80;
  --md-orange-300: #FFB74D;
  --md-orange-400: #FFA726;
  --md-orange-500: #FF9800;
  --md-orange-600: #FB8C00;
  --md-orange-700: #F57C00;
  --md-orange-800: #EF6C00;
  --md-orange-900: #E65100;
  --md-orange-A100: #FFD180;
  --md-orange-A200: #FFAB40;
  --md-orange-A400: #FF9100;
  --md-orange-A700: #FF6D00;

  --md-deep-orange-50: #FBE9E7;
  --md-deep-orange-100: #FFCCBC;
  --md-deep-orange-200: #FFAB91;
  --md-deep-orange-300: #FF8A65;
  --md-deep-orange-400: #FF7043;
  --md-deep-orange-500: #FF5722;
  --md-deep-orange-600: #F4511E;
  --md-deep-orange-700: #E64A19;
  --md-deep-orange-800: #D84315;
  --md-deep-orange-900: #BF360C;
  --md-deep-orange-A100: #FF9E80;
  --md-deep-orange-A200: #FF6E40;
  --md-deep-orange-A400: #FF3D00;
  --md-deep-orange-A700: #DD2C00;

  --md-brown-50: #EFEBE9;
  --md-brown-100: #D7CCC8;
  --md-brown-200: #BCAAA4;
  --md-brown-300: #A1887F;
  --md-brown-400: #8D6E63;
  --md-brown-500: #795548;
  --md-brown-600: #6D4C41;
  --md-brown-700: #5D4037;
  --md-brown-800: #4E342E;
  --md-brown-900: #3E2723;

  --md-grey-50: #FAFAFA;
  --md-grey-100: #F5F5F5;
  --md-grey-200: #EEEEEE;
  --md-grey-300: #E0E0E0;
  --md-grey-400: #BDBDBD;
  --md-grey-500: #9E9E9E;
  --md-grey-600: #757575;
  --md-grey-700: #616161;
  --md-grey-800: #424242;
  --md-grey-900: #212121;

  --md-blue-grey-50: #ECEFF1;
  --md-blue-grey-100: #CFD8DC;
  --md-blue-grey-200: #B0BEC5;
  --md-blue-grey-300: #90A4AE;
  --md-blue-grey-400: #78909C;
  --md-blue-grey-500: #607D8B;
  --md-blue-grey-600: #546E7A;
  --md-blue-grey-700: #455A64;
  --md-blue-grey-800: #37474F;
  --md-blue-grey-900: #263238;
}</style><style type="text/css">/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
This file is copied from the JupyterLab project to define default styling for
when the widget styling is compiled down to eliminate CSS variables. We make one
change - we comment out the font import below.
*/

/*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/


/*
 * Optional monospace font for input/output prompt.
 */
 /* Commented out in ipywidgets since we don't need it. */
/* @import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); */

/*
 * Added for compabitility with output area
 */
:root {
  --jp-icon-search: none;
  --jp-ui-select-caret: none;
}


:root {

  /* Borders

  The following variables, specify the visual styling of borders in JupyterLab.
   */

  --jp-border-width: 1px;
  --jp-border-color0: var(--md-grey-700);
  --jp-border-color1: var(--md-grey-500);
  --jp-border-color2: var(--md-grey-300);
  --jp-border-color3: var(--md-grey-100);

  /* UI Fonts

  The UI font CSS variables are used for the typography all of the JupyterLab
  user interface elements that are not directly user generated content.
  */

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: calc(var(--jp-ui-font-size1)/var(--jp-ui-font-scale-factor));
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: calc(var(--jp-ui-font-size1)*var(--jp-ui-font-scale-factor));
  --jp-ui-font-size3: calc(var(--jp-ui-font-size2)*var(--jp-ui-font-scale-factor));
  --jp-ui-icon-font-size: 14px; /* Ensures px perfect FontAwesome icons */
  --jp-ui-font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;

  /* Use these font colors against the corresponding main layout colors.
     In a light theme, these go from dark to light.
  */

  --jp-ui-font-color0: rgba(0,0,0,1.0);
  --jp-ui-font-color1: rgba(0,0,0,0.8);
  --jp-ui-font-color2: rgba(0,0,0,0.5);
  --jp-ui-font-color3: rgba(0,0,0,0.3);

  /* Use these against the brand/accent/warn/error colors.
     These will typically go from light to darker, in both a dark and light theme
   */

  --jp-inverse-ui-font-color0: rgba(255,255,255,1);
  --jp-inverse-ui-font-color1: rgba(255,255,255,1.0);
  --jp-inverse-ui-font-color2: rgba(255,255,255,0.7);
  --jp-inverse-ui-font-color3: rgba(255,255,255,0.5);

  /* Content Fonts

  Content font variables are used for typography of user generated content.
  */

  --jp-content-font-size: 13px;
  --jp-content-line-height: 1.5;
  --jp-content-font-color0: black;
  --jp-content-font-color1: black;
  --jp-content-font-color2: var(--md-grey-700);
  --jp-content-font-color3: var(--md-grey-500);

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: calc(var(--jp-ui-font-size1)/var(--jp-ui-font-scale-factor));
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: calc(var(--jp-ui-font-size1)*var(--jp-ui-font-scale-factor));
  --jp-ui-font-size3: calc(var(--jp-ui-font-size2)*var(--jp-ui-font-scale-factor));

  --jp-code-font-size: 13px;
  --jp-code-line-height: 1.307;
  --jp-code-padding: 5px;
  --jp-code-font-family: monospace;


  /* Layout

  The following are the main layout colors use in JupyterLab. In a light
  theme these would go from light to dark.
  */

  --jp-layout-color0: white;
  --jp-layout-color1: white;
  --jp-layout-color2: var(--md-grey-200);
  --jp-layout-color3: var(--md-grey-400);

  /* Brand/accent */

  --jp-brand-color0: var(--md-blue-700);
  --jp-brand-color1: var(--md-blue-500);
  --jp-brand-color2: var(--md-blue-300);
  --jp-brand-color3: var(--md-blue-100);

  --jp-accent-color0: var(--md-green-700);
  --jp-accent-color1: var(--md-green-500);
  --jp-accent-color2: var(--md-green-300);
  --jp-accent-color3: var(--md-green-100);

  /* State colors (warn, error, success, info) */

  --jp-warn-color0: var(--md-orange-700);
  --jp-warn-color1: var(--md-orange-500);
  --jp-warn-color2: var(--md-orange-300);
  --jp-warn-color3: var(--md-orange-100);

  --jp-error-color0: var(--md-red-700);
  --jp-error-color1: var(--md-red-500);
  --jp-error-color2: var(--md-red-300);
  --jp-error-color3: var(--md-red-100);

  --jp-success-color0: var(--md-green-700);
  --jp-success-color1: var(--md-green-500);
  --jp-success-color2: var(--md-green-300);
  --jp-success-color3: var(--md-green-100);

  --jp-info-color0: var(--md-cyan-700);
  --jp-info-color1: var(--md-cyan-500);
  --jp-info-color2: var(--md-cyan-300);
  --jp-info-color3: var(--md-cyan-100);

  /* Cell specific styles */

  --jp-cell-padding: 5px;
  --jp-cell-editor-background: #f7f7f7;
  --jp-cell-editor-border-color: #cfcfcf;
  --jp-cell-editor-background-edit: var(--jp-ui-layout-color1);
  --jp-cell-editor-border-color-edit: var(--jp-brand-color1);
  --jp-cell-prompt-width: 100px;
  --jp-cell-prompt-font-family: 'Roboto Mono', monospace;
  --jp-cell-prompt-letter-spacing: 0px;
  --jp-cell-prompt-opacity: 1.0;
  --jp-cell-prompt-opacity-not-active: 0.4;
  --jp-cell-prompt-font-color-not-active: var(--md-grey-700);
  /* A custom blend of MD grey and blue 600
   * See https://meyerweb.com/eric/tools/color-blend/#546E7A:1E88E5:5:hex */
  --jp-cell-inprompt-font-color: #307FC1;
  /* A custom blend of MD grey and orange 600
   * https://meyerweb.com/eric/tools/color-blend/#546E7A:F4511E:5:hex */
  --jp-cell-outprompt-font-color: #BF5B3D;

  /* Notebook specific styles */

  --jp-notebook-padding: 10px;
  --jp-notebook-scroll-padding: 100px;

  /* Console specific styles */

  --jp-console-background: var(--md-grey-100);

  /* Toolbar specific styles */

  --jp-toolbar-border-color: var(--md-grey-400);
  --jp-toolbar-micro-height: 8px;
  --jp-toolbar-background: var(--jp-layout-color0);
  --jp-toolbar-box-shadow: 0px 0px 2px 0px rgba(0,0,0,0.24);
  --jp-toolbar-header-margin: 4px 4px 0px 4px;
  --jp-toolbar-active-background: var(--md-grey-300);
}
</style><style type="text/css">/* This file has code derived from PhosphorJS CSS files, as noted below. The license for this PhosphorJS code is:

Copyright (c) 2014-2017, PhosphorJS Contributors
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the copyright holder nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

/*
 * The following section is derived from https://github.com/phosphorjs/phosphor/blob/23b9d075ebc5b73ab148b6ebfc20af97f85714c4/packages/widgets/style/tabbar.css 
 * We've scoped the rules so that they are consistent with exactly our code.
 */

.jupyter-widgets.widget-tab > .p-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}


.jupyter-widgets.widget-tab > .p-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
}


.jupyter-widgets.widget-tab > .p-TabBar[data-orientation='vertical'] {
  flex-direction: column;
}


.jupyter-widgets.widget-tab > .p-TabBar > .p-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}


.jupyter-widgets.widget-tab > .p-TabBar[data-orientation='horizontal'] > .p-TabBar-content {
  flex-direction: row;
}


.jupyter-widgets.widget-tab > .p-TabBar[data-orientation='vertical'] > .p-TabBar-content {
  flex-direction: column;
}


.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
}


.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabIcon,
.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}


.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}


.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab.p-mod-hidden {
  display: none !important;
}


.jupyter-widgets.widget-tab > .p-TabBar.p-mod-dragging .p-TabBar-tab {
  position: relative;
}


.jupyter-widgets.widget-tab > .p-TabBar.p-mod-dragging[data-orientation='horizontal'] .p-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}


.jupyter-widgets.widget-tab > .p-TabBar.p-mod-dragging[data-orientation='vertical'] .p-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}


.jupyter-widgets.widget-tab > .p-TabBar.p-mod-dragging .p-TabBar-tab.p-mod-dragging {
  transition: none;
}

/* End tabbar.css */
</style><style type="text/css">/* Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*
 * We assume that the CSS variables in
 * https://github.com/jupyterlab/jupyterlab/blob/master/src/default-theme/variables.css
 * have been defined.
 */

:root {
    --jp-widgets-color: var(--jp-content-font-color1);
    --jp-widgets-label-color: var(--jp-widgets-color);
    --jp-widgets-readout-color: var(--jp-widgets-color);
    --jp-widgets-font-size: var(--jp-ui-font-size1);
    --jp-widgets-margin: 2px;
    --jp-widgets-inline-height: 28px;
    --jp-widgets-inline-width: 300px;
    --jp-widgets-inline-width-short: calc(var(--jp-widgets-inline-width) / 2 - var(--jp-widgets-margin));
    --jp-widgets-inline-width-tiny: calc(var(--jp-widgets-inline-width-short) / 2 - var(--jp-widgets-margin));
    --jp-widgets-inline-margin: 4px; /* margin between inline elements */
    --jp-widgets-inline-label-width: 80px;
    --jp-widgets-border-width: var(--jp-border-width);
    --jp-widgets-vertical-height: 200px;
    --jp-widgets-horizontal-tab-height: 24px;
    --jp-widgets-horizontal-tab-width: 144px;
    --jp-widgets-horizontal-tab-top-border: 2px;
    --jp-widgets-progress-thickness: 20px;
    --jp-widgets-container-padding: 15px;
    --jp-widgets-input-padding: 4px;
    --jp-widgets-radio-item-height-adjustment: 8px;
    --jp-widgets-radio-item-height: calc(var(--jp-widgets-inline-height) - var(--jp-widgets-radio-item-height-adjustment));
    --jp-widgets-slider-track-thickness: 4px;
    --jp-widgets-slider-border-width: var(--jp-widgets-border-width);
    --jp-widgets-slider-handle-size: 16px;
    --jp-widgets-slider-handle-border-color: var(--jp-border-color1);
    --jp-widgets-slider-handle-background-color: var(--jp-layout-color1);
    --jp-widgets-slider-active-handle-color: var(--jp-brand-color1);
    --jp-widgets-menu-item-height: 24px;
    --jp-widgets-dropdown-arrow: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOCAxOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDpub25lO30KPC9zdHlsZT4KPHBhdGggZD0iTTUuMiw1LjlMOSw5LjdsMy44LTMuOGwxLjIsMS4ybC00LjksNWwtNC45LTVMNS4yLDUuOXoiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTAtMC42aDE4djE4SDBWLTAuNnoiLz4KPC9zdmc+Cg");
    --jp-widgets-input-color: var(--jp-ui-font-color1);
    --jp-widgets-input-background-color: var(--jp-layout-color1);
    --jp-widgets-input-border-color: var(--jp-border-color1);
    --jp-widgets-input-focus-border-color: var(--jp-brand-color2);
    --jp-widgets-input-border-width: var(--jp-widgets-border-width);
    --jp-widgets-disabled-opacity: 0.6;

    /* From Material Design Lite */
    --md-shadow-key-umbra-opacity: 0.2;
    --md-shadow-key-penumbra-opacity: 0.14;
    --md-shadow-ambient-shadow-opacity: 0.12;
}

.jupyter-widgets {
    margin: var(--jp-widgets-margin);
    box-sizing: border-box;
    color: var(--jp-widgets-color);
    overflow: visible;
}

.jupyter-widgets.jupyter-widgets-disconnected::before {
    line-height: var(--jp-widgets-inline-height);
    height: var(--jp-widgets-inline-height);
}

.jp-Output-result > .jupyter-widgets {
    margin-left: 0;
    margin-right: 0;
}

/* vbox and hbox */

.widget-inline-hbox {
    /* Horizontal widgets */
    box-sizing: border-box;
    display: flex;
    flex-direction: row;
    align-items: baseline;
}

.widget-inline-vbox {
    /* Vertical Widgets */
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.widget-box {
    box-sizing: border-box;
    display: flex;
    margin: 0;
    overflow: auto;
}

.widget-gridbox {
    box-sizing: border-box;
    display: grid;
    margin: 0;
    overflow: auto;
}

.widget-hbox {
    flex-direction: row;
}

.widget-vbox {
    flex-direction: column;
}

/* General Button Styling */

.jupyter-button {
    padding-left: 10px;
    padding-right: 10px;
    padding-top: 0px;
    padding-bottom: 0px;
    display: inline-block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: center;
    font-size: var(--jp-widgets-font-size);
    cursor: pointer;

    height: var(--jp-widgets-inline-height);
    border: 0px solid;
    line-height: var(--jp-widgets-inline-height);
    box-shadow: none;

    color: var(--jp-ui-font-color1);
    background-color: var(--jp-layout-color2);
    border-color: var(--jp-border-color2);
    border: none;
    user-select: none;
}

.jupyter-button i.fa {
    margin-right: var(--jp-widgets-inline-margin);
    pointer-events: none;
}

.jupyter-button:empty:before {
    content: "\200b"; /* zero-width space */
}

.jupyter-widgets.jupyter-button:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

.jupyter-button i.fa.center {
    margin-right: 0;
}

.jupyter-button:hover:enabled, .jupyter-button:focus:enabled {
    /* MD Lite 2dp shadow */
    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, var(--md-shadow-key-penumbra-opacity)),
                0 3px 1px -2px rgba(0, 0, 0, var(--md-shadow-key-umbra-opacity)),
                0 1px 5px 0 rgba(0, 0, 0, var(--md-shadow-ambient-shadow-opacity));
}

.jupyter-button:active, .jupyter-button.mod-active {
    /* MD Lite 4dp shadow */
    box-shadow: 0 4px 5px 0 rgba(0, 0, 0, var(--md-shadow-key-penumbra-opacity)),
                0 1px 10px 0 rgba(0, 0, 0, var(--md-shadow-ambient-shadow-opacity)),
                0 2px 4px -1px rgba(0, 0, 0, var(--md-shadow-key-umbra-opacity));
    color: var(--jp-ui-font-color1);
    background-color: var(--jp-layout-color3);
}

.jupyter-button:focus:enabled {
    outline: 1px solid var(--jp-widgets-input-focus-border-color);
}

/* Button "Primary" Styling */

.jupyter-button.mod-primary {
    color: var(--jp-inverse-ui-font-color1);
    background-color: var(--jp-brand-color1);
}

.jupyter-button.mod-primary.mod-active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-brand-color0);
}

.jupyter-button.mod-primary:active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-brand-color0);
}

/* Button "Success" Styling */

.jupyter-button.mod-success {
    color: var(--jp-inverse-ui-font-color1);
    background-color: var(--jp-success-color1);
}

.jupyter-button.mod-success.mod-active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-success-color0);
 }

.jupyter-button.mod-success:active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-success-color0);
 }

 /* Button "Info" Styling */

.jupyter-button.mod-info {
    color: var(--jp-inverse-ui-font-color1);
    background-color: var(--jp-info-color1);
}

.jupyter-button.mod-info.mod-active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-info-color0);
}

.jupyter-button.mod-info:active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-info-color0);
}

/* Button "Warning" Styling */

.jupyter-button.mod-warning {
    color: var(--jp-inverse-ui-font-color1);
    background-color: var(--jp-warn-color1);
}

.jupyter-button.mod-warning.mod-active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-warn-color0);
}

.jupyter-button.mod-warning:active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-warn-color0);
}

/* Button "Danger" Styling */

.jupyter-button.mod-danger {
    color: var(--jp-inverse-ui-font-color1);
    background-color: var(--jp-error-color1);
}

.jupyter-button.mod-danger.mod-active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-error-color0);
}

.jupyter-button.mod-danger:active {
    color: var(--jp-inverse-ui-font-color0);
    background-color: var(--jp-error-color0);
}

/* Widget Button, Widget Toggle Button, Widget Upload */

.widget-button, .widget-toggle-button, .widget-upload {
    width: var(--jp-widgets-inline-width-short);
}

/* Widget Label Styling */

/* Override Bootstrap label css */
.jupyter-widgets label {
    margin-bottom: initial;
}

.widget-label-basic {
    /* Basic Label */
    color: var(--jp-widgets-label-color);
    font-size: var(--jp-widgets-font-size);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    line-height: var(--jp-widgets-inline-height);
}

.widget-label {
    /* Label */
    color: var(--jp-widgets-label-color);
    font-size: var(--jp-widgets-font-size);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    line-height: var(--jp-widgets-inline-height);
}

.widget-inline-hbox .widget-label {
    /* Horizontal Widget Label */
    color: var(--jp-widgets-label-color);
    text-align: right;
    margin-right: calc( var(--jp-widgets-inline-margin) * 2 );
    width: var(--jp-widgets-inline-label-width);
    flex-shrink: 0;
}

.widget-inline-vbox .widget-label {
    /* Vertical Widget Label */
    color: var(--jp-widgets-label-color);
    text-align: center;
    line-height: var(--jp-widgets-inline-height);
}

/* Widget Readout Styling */

.widget-readout {
    color: var(--jp-widgets-readout-color);
    font-size: var(--jp-widgets-font-size);
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
    overflow: hidden;
    white-space: nowrap;
    text-align: center;
}

.widget-readout.overflow {
    /* Overflowing Readout */

    /* From Material Design Lite
        shadow-key-umbra-opacity: 0.2;
        shadow-key-penumbra-opacity: 0.14;
        shadow-ambient-shadow-opacity: 0.12;
     */
    -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.2),
                        0 3px 1px -2px rgba(0, 0, 0, 0.14),
                        0 1px 5px 0 rgba(0, 0, 0, 0.12);

    -moz-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.2),
                     0 3px 1px -2px rgba(0, 0, 0, 0.14),
                     0 1px 5px 0 rgba(0, 0, 0, 0.12);

    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.2),
                0 3px 1px -2px rgba(0, 0, 0, 0.14),
                0 1px 5px 0 rgba(0, 0, 0, 0.12);
}

.widget-inline-hbox .widget-readout {
    /* Horizontal Readout */
    text-align: center;
    max-width: var(--jp-widgets-inline-width-short);
    min-width: var(--jp-widgets-inline-width-tiny);
    margin-left: var(--jp-widgets-inline-margin);
}

.widget-inline-vbox .widget-readout {
    /* Vertical Readout */
    margin-top: var(--jp-widgets-inline-margin);
    /* as wide as the widget */
    width: inherit;
}

/* Widget Checkbox Styling */

.widget-checkbox {
    width: var(--jp-widgets-inline-width);
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
}

.widget-checkbox input[type="checkbox"] {
    margin: 0px calc( var(--jp-widgets-inline-margin) * 2 ) 0px 0px;
    line-height: var(--jp-widgets-inline-height);
    font-size: large;
    flex-grow: 1;
    flex-shrink: 0;
    align-self: center;
}

/* Widget Valid Styling */

.widget-valid {
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
    width: var(--jp-widgets-inline-width-short);
    font-size: var(--jp-widgets-font-size);
}

.widget-valid i:before {
    line-height: var(--jp-widgets-inline-height);
    margin-right: var(--jp-widgets-inline-margin);
    margin-left: var(--jp-widgets-inline-margin);

    /* from the fa class in FontAwesome: https://github.com/FortAwesome/Font-Awesome/blob/49100c7c3a7b58d50baa71efef11af41a66b03d3/css/font-awesome.css#L14 */
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.widget-valid.mod-valid i:before {
    content: "\f00c";
    color: green;
}

.widget-valid.mod-invalid i:before {
    content: "\f00d";
    color: red;
}

.widget-valid.mod-valid .widget-valid-readout {
    display: none;
}

/* Widget Text and TextArea Stying */

.widget-textarea, .widget-text {
    width: var(--jp-widgets-inline-width);
}

.widget-text input[type="text"], .widget-text input[type="number"]{
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
}

.widget-text input[type="text"]:disabled, .widget-text input[type="number"]:disabled, .widget-textarea textarea:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

.widget-text input[type="text"], .widget-text input[type="number"], .widget-textarea textarea {
    box-sizing: border-box;
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    background-color: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    font-size: var(--jp-widgets-font-size);
    flex-grow: 1;
    min-width: 0; /* This makes it possible for the flexbox to shrink this input */
    flex-shrink: 1;
    outline: none !important;
}
    
.widget-text input[type="text"], .widget-textarea textarea {
    padding: var(--jp-widgets-input-padding) calc( var(--jp-widgets-input-padding) *  2);
}

.widget-text input[type="number"] {
    padding: var(--jp-widgets-input-padding) 0 var(--jp-widgets-input-padding) calc(var(--jp-widgets-input-padding) *  2);
}

.widget-textarea textarea {
    height: inherit;
    width: inherit;
}

.widget-text input:focus, .widget-textarea textarea:focus {
    border-color: var(--jp-widgets-input-focus-border-color);
}

/* Widget Slider */

.widget-slider .ui-slider {
    /* Slider Track */
    border: var(--jp-widgets-slider-border-width) solid var(--jp-layout-color3);
    background: var(--jp-layout-color3);
    box-sizing: border-box;
    position: relative;
    border-radius: 0px;
}

.widget-slider .ui-slider .ui-slider-handle {
    /* Slider Handle */
    outline: none !important; /* focused slider handles are colored - see below */
    position: absolute;
    background-color: var(--jp-widgets-slider-handle-background-color);
    border: var(--jp-widgets-slider-border-width) solid var(--jp-widgets-slider-handle-border-color);
    box-sizing: border-box;
    z-index: 1;
    background-image: none; /* Override jquery-ui */
}

/* Override jquery-ui */
.widget-slider .ui-slider .ui-slider-handle:hover, .widget-slider .ui-slider .ui-slider-handle:focus {
    background-color: var(--jp-widgets-slider-active-handle-color);
    border: var(--jp-widgets-slider-border-width) solid var(--jp-widgets-slider-active-handle-color);
}

.widget-slider .ui-slider .ui-slider-handle:active {
    background-color: var(--jp-widgets-slider-active-handle-color);
    border-color: var(--jp-widgets-slider-active-handle-color);
    z-index: 2;
    transform: scale(1.2);
}

.widget-slider  .ui-slider .ui-slider-range {
    /* Interval between the two specified value of a double slider */
    position: absolute;
    background: var(--jp-widgets-slider-active-handle-color);
    z-index: 0;
}

/* Shapes of Slider Handles */

.widget-hslider .ui-slider .ui-slider-handle {
    width: var(--jp-widgets-slider-handle-size);
    height: var(--jp-widgets-slider-handle-size);
    margin-top: calc((var(--jp-widgets-slider-track-thickness) - var(--jp-widgets-slider-handle-size)) / 2 - var(--jp-widgets-slider-border-width));
    margin-left: calc(var(--jp-widgets-slider-handle-size) / -2 + var(--jp-widgets-slider-border-width));
    border-radius: 50%;
    top: 0;
}

.widget-vslider .ui-slider .ui-slider-handle {
    width: var(--jp-widgets-slider-handle-size);
    height: var(--jp-widgets-slider-handle-size);
    margin-bottom: calc(var(--jp-widgets-slider-handle-size) / -2 + var(--jp-widgets-slider-border-width));
    margin-left: calc((var(--jp-widgets-slider-track-thickness) - var(--jp-widgets-slider-handle-size)) / 2 - var(--jp-widgets-slider-border-width));
    border-radius: 50%;
    left: 0;
}

.widget-hslider .ui-slider .ui-slider-range {
    height: calc( var(--jp-widgets-slider-track-thickness) * 2 );
    margin-top: calc((var(--jp-widgets-slider-track-thickness) - var(--jp-widgets-slider-track-thickness) * 2 ) / 2 - var(--jp-widgets-slider-border-width));
}

.widget-vslider .ui-slider .ui-slider-range {
    width: calc( var(--jp-widgets-slider-track-thickness) * 2 );
    margin-left: calc((var(--jp-widgets-slider-track-thickness) - var(--jp-widgets-slider-track-thickness) * 2 ) / 2 - var(--jp-widgets-slider-border-width));
}

/* Horizontal Slider */

.widget-hslider {
    width: var(--jp-widgets-inline-width);
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);

    /* Override the align-items baseline. This way, the description and readout
    still seem to align their baseline properly, and we don't have to have
    align-self: stretch in the .slider-container. */
    align-items: center;
}

.widgets-slider .slider-container {
    overflow: visible;
}

.widget-hslider .slider-container {
    height: var(--jp-widgets-inline-height);
    margin-left: calc(var(--jp-widgets-slider-handle-size) / 2 - 2 * var(--jp-widgets-slider-border-width));
    margin-right: calc(var(--jp-widgets-slider-handle-size) / 2 - 2 * var(--jp-widgets-slider-border-width));
    flex: 1 1 var(--jp-widgets-inline-width-short);
}

.widget-hslider .ui-slider {
    /* Inner, invisible slide div */
    height: var(--jp-widgets-slider-track-thickness);
    margin-top: calc((var(--jp-widgets-inline-height) - var(--jp-widgets-slider-track-thickness)) / 2);
    width: 100%;
}

/* Vertical Slider */

.widget-vbox .widget-label {
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
}

.widget-vslider {
    /* Vertical Slider */
    height: var(--jp-widgets-vertical-height);
    width: var(--jp-widgets-inline-width-tiny);
}

.widget-vslider .slider-container {
    flex: 1 1 var(--jp-widgets-inline-width-short);
    margin-left: auto;
    margin-right: auto;
    margin-bottom: calc(var(--jp-widgets-slider-handle-size) / 2 - 2 * var(--jp-widgets-slider-border-width));
    margin-top: calc(var(--jp-widgets-slider-handle-size) / 2 - 2 * var(--jp-widgets-slider-border-width));
    display: flex;
    flex-direction: column;
}

.widget-vslider .ui-slider-vertical {
    /* Inner, invisible slide div */
    width: var(--jp-widgets-slider-track-thickness);
    flex-grow: 1;
    margin-left: auto;
    margin-right: auto;
}

/* Widget Progress Styling */

.progress-bar {
    -webkit-transition: none;
    -moz-transition: none;
    -ms-transition: none;
    -o-transition: none;
    transition: none;
}

.progress-bar {
    height: var(--jp-widgets-inline-height);
}

.progress-bar {
    background-color: var(--jp-brand-color1);
}

.progress-bar-success {
    background-color: var(--jp-success-color1);
}

.progress-bar-info {
    background-color: var(--jp-info-color1);
}

.progress-bar-warning {
    background-color: var(--jp-warn-color1);
}

.progress-bar-danger {
    background-color: var(--jp-error-color1);
}

.progress {
    background-color: var(--jp-layout-color2);
    border: none;
    box-shadow: none;
}

/* Horisontal Progress */

.widget-hprogress {
    /* Progress Bar */
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
    width: var(--jp-widgets-inline-width);
    align-items: center;

}

.widget-hprogress .progress {
    flex-grow: 1;
    margin-top: var(--jp-widgets-input-padding);
    margin-bottom: var(--jp-widgets-input-padding);
    align-self: stretch;
    /* Override bootstrap style */
    height: initial;
}

/* Vertical Progress */

.widget-vprogress {
    height: var(--jp-widgets-vertical-height);
    width: var(--jp-widgets-inline-width-tiny);
}

.widget-vprogress .progress {
    flex-grow: 1;
    width: var(--jp-widgets-progress-thickness);
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 0;
}

/* Select Widget Styling */

.widget-dropdown {
    height: var(--jp-widgets-inline-height);
    width: var(--jp-widgets-inline-width);
    line-height: var(--jp-widgets-inline-height);
}

.widget-dropdown > select {
    padding-right: 20px;
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    border-radius: 0;
    height: inherit;
    flex: 1 1 var(--jp-widgets-inline-width-short);
    min-width: 0; /* This makes it possible for the flexbox to shrink this input */
    box-sizing: border-box;
    outline: none !important;
    box-shadow: none;
    background-color: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    font-size: var(--jp-widgets-font-size);
    vertical-align: top;
    padding-left: calc( var(--jp-widgets-input-padding) * 2);
	appearance: none;
	-webkit-appearance: none;
	-moz-appearance: none;
    background-repeat: no-repeat;
	background-size: 20px;
	background-position: right center;
    background-image: var(--jp-widgets-dropdown-arrow);
}
.widget-dropdown > select:focus {
    border-color: var(--jp-widgets-input-focus-border-color);
}

.widget-dropdown > select:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

/* To disable the dotted border in Firefox around select controls.
   See http://stackoverflow.com/a/18853002 */
.widget-dropdown > select:-moz-focusring {
    color: transparent;
    text-shadow: 0 0 0 #000;
}

/* Select and SelectMultiple */

.widget-select {
    width: var(--jp-widgets-inline-width);
    line-height: var(--jp-widgets-inline-height);

    /* Because Firefox defines the baseline of a select as the bottom of the
    control, we align the entire control to the top and add padding to the
    select to get an approximate first line baseline alignment. */
    align-items: flex-start;
}

.widget-select > select {
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    background-color: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    font-size: var(--jp-widgets-font-size);
    flex: 1 1 var(--jp-widgets-inline-width-short);
    outline: none !important;
    overflow: auto;
    height: inherit;

    /* Because Firefox defines the baseline of a select as the bottom of the
    control, we align the entire control to the top and add padding to the
    select to get an approximate first line baseline alignment. */
    padding-top: 5px;
}

.widget-select > select:focus {
    border-color: var(--jp-widgets-input-focus-border-color);
}

.wiget-select > select > option {
    padding-left: var(--jp-widgets-input-padding);
    line-height: var(--jp-widgets-inline-height);
    /* line-height doesn't work on some browsers for select options */
    padding-top: calc(var(--jp-widgets-inline-height)-var(--jp-widgets-font-size)/2);
    padding-bottom: calc(var(--jp-widgets-inline-height)-var(--jp-widgets-font-size)/2);
}



/* Toggle Buttons Styling */

.widget-toggle-buttons {
    line-height: var(--jp-widgets-inline-height);
}

.widget-toggle-buttons .widget-toggle-button {
    margin-left: var(--jp-widgets-margin);
    margin-right: var(--jp-widgets-margin);
}

.widget-toggle-buttons .jupyter-button:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

/* Radio Buttons Styling */

.widget-radio {
    width: var(--jp-widgets-inline-width);
    line-height: var(--jp-widgets-inline-height);
}

.widget-radio-box {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    box-sizing: border-box;
    flex-grow: 1;
    margin-bottom: var(--jp-widgets-radio-item-height-adjustment);
}

.widget-radio-box label {
    height: var(--jp-widgets-radio-item-height);
    line-height: var(--jp-widgets-radio-item-height);
    font-size: var(--jp-widgets-font-size);
}

.widget-radio-box input {
    height: var(--jp-widgets-radio-item-height);
    line-height: var(--jp-widgets-radio-item-height);
    margin: 0 calc( var(--jp-widgets-input-padding) * 2 ) 0 1px;
    float: left;
}

/* Color Picker Styling */

.widget-colorpicker {
    width: var(--jp-widgets-inline-width);
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
}

.widget-colorpicker > .widget-colorpicker-input {
    flex-grow: 1;
    flex-shrink: 1;
    min-width: var(--jp-widgets-inline-width-tiny);
}

.widget-colorpicker input[type="color"] {
    width: var(--jp-widgets-inline-height);
    height: var(--jp-widgets-inline-height);
    padding: 0 2px; /* make the color square actually square on Chrome on OS X */
    background: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    border-left: none;
    flex-grow: 0;
    flex-shrink: 0;
    box-sizing: border-box;
    align-self: stretch;
    outline: none !important;
}

.widget-colorpicker.concise input[type="color"] {
    border-left: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
}

.widget-colorpicker input[type="color"]:focus, .widget-colorpicker input[type="text"]:focus {
    border-color: var(--jp-widgets-input-focus-border-color);
}

.widget-colorpicker input[type="text"] {
    flex-grow: 1;
    outline: none !important;
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
    background: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    font-size: var(--jp-widgets-font-size);
    padding: var(--jp-widgets-input-padding) calc( var(--jp-widgets-input-padding) *  2 );
    min-width: 0; /* This makes it possible for the flexbox to shrink this input */
    flex-shrink: 1;
    box-sizing: border-box;
}

.widget-colorpicker input[type="text"]:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

/* Date Picker Styling */

.widget-datepicker {
    width: var(--jp-widgets-inline-width);
    height: var(--jp-widgets-inline-height);
    line-height: var(--jp-widgets-inline-height);
}

.widget-datepicker input[type="date"] {
    flex-grow: 1;
    flex-shrink: 1;
    min-width: 0; /* This makes it possible for the flexbox to shrink this input */
    outline: none !important;
    height: var(--jp-widgets-inline-height);
    border: var(--jp-widgets-input-border-width) solid var(--jp-widgets-input-border-color);
    background-color: var(--jp-widgets-input-background-color);
    color: var(--jp-widgets-input-color);
    font-size: var(--jp-widgets-font-size);
    padding: var(--jp-widgets-input-padding) calc( var(--jp-widgets-input-padding) *  2 );
    box-sizing: border-box;
}

.widget-datepicker input[type="date"]:focus {
    border-color: var(--jp-widgets-input-focus-border-color);
}

.widget-datepicker input[type="date"]:invalid {
    border-color: var(--jp-warn-color1);
}

.widget-datepicker input[type="date"]:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

/* Play Widget */

.widget-play {
    width: var(--jp-widgets-inline-width-short);
    display: flex;
    align-items: stretch;
}

.widget-play .jupyter-button {
    flex-grow: 1;
    height: auto;
}

.widget-play .jupyter-button:disabled {
    opacity: var(--jp-widgets-disabled-opacity);
}

/* Tab Widget */

.jupyter-widgets.widget-tab {
    display: flex;
    flex-direction: column;
}

.jupyter-widgets.widget-tab > .p-TabBar {
    /* Necessary so that a tab can be shifted down to overlay the border of the box below. */
    overflow-x: visible;
    overflow-y: visible;
}

.jupyter-widgets.widget-tab > .p-TabBar > .p-TabBar-content {
    /* Make sure that the tab grows from bottom up */
    align-items: flex-end;
    min-width: 0;
    min-height: 0;
}

.jupyter-widgets.widget-tab > .widget-tab-contents {
    width: 100%;
    box-sizing: border-box;
    margin: 0;
    background: var(--jp-layout-color1);
    color: var(--jp-ui-font-color1);
    border: var(--jp-border-width) solid var(--jp-border-color1);
    padding: var(--jp-widgets-container-padding);
    flex-grow: 1;
    overflow: auto;
}

.jupyter-widgets.widget-tab > .p-TabBar {
    font: var(--jp-widgets-font-size) Helvetica, Arial, sans-serif;
    min-height: calc(var(--jp-widgets-horizontal-tab-height) + var(--jp-border-width));
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab {
    flex: 0 1 var(--jp-widgets-horizontal-tab-width);
    min-width: 35px;
    min-height: calc(var(--jp-widgets-horizontal-tab-height) + var(--jp-border-width));
    line-height: var(--jp-widgets-horizontal-tab-height);
    margin-left: calc(-1 * var(--jp-border-width));
    padding: 0px 10px;
    background: var(--jp-layout-color2);
    color: var(--jp-ui-font-color2);
    border: var(--jp-border-width) solid var(--jp-border-color1);
    border-bottom: none;
    position: relative;
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab.p-mod-current {
    color: var(--jp-ui-font-color0);
    /* We want the background to match the tab content background */
    background: var(--jp-layout-color1);
    min-height: calc(var(--jp-widgets-horizontal-tab-height) + 2 * var(--jp-border-width));
    transform: translateY(var(--jp-border-width));
    overflow: visible;
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab.p-mod-current:before {
    position: absolute;
    top: calc(-1 * var(--jp-border-width));
    left: calc(-1 * var(--jp-border-width));
    content: '';
    height: var(--jp-widgets-horizontal-tab-top-border);
    width: calc(100% + 2 * var(--jp-border-width));
    background: var(--jp-brand-color1);
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab:first-child {
    margin-left: 0;
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tab:hover:not(.p-mod-current) {
    background: var(--jp-layout-color1);
    color: var(--jp-ui-font-color1);
}

.jupyter-widgets.widget-tab > .p-TabBar .p-mod-closable > .p-TabBar-tabCloseIcon {
    margin-left: 4px;
}

.jupyter-widgets.widget-tab > .p-TabBar .p-mod-closable > .p-TabBar-tabCloseIcon:before {
    font-family: FontAwesome;
    content: '\f00d'; /* close */
}

.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabIcon,
.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabLabel,
.jupyter-widgets.widget-tab > .p-TabBar .p-TabBar-tabCloseIcon {
    line-height: var(--jp-widgets-horizontal-tab-height);
}

/* Accordion Widget */

.p-Collapse {
    display: flex;
    flex-direction: column;
    align-items: stretch;
}

.p-Collapse-header {
    padding: var(--jp-widgets-input-padding);
    cursor: pointer;
    color: var(--jp-ui-font-color2);
    background-color: var(--jp-layout-color2);
    border: var(--jp-widgets-border-width) solid var(--jp-border-color1);
    padding: calc(var(--jp-widgets-container-padding) * 2 / 3) var(--jp-widgets-container-padding);
    font-weight: bold;
}

.p-Collapse-header:hover {
    background-color: var(--jp-layout-color1);
    color: var(--jp-ui-font-color1);
}

.p-Collapse-open > .p-Collapse-header {
    background-color: var(--jp-layout-color1);
    color: var(--jp-ui-font-color0);
    cursor: default;
    border-bottom: none;
}

.p-Collapse .p-Collapse-header::before {
    content: '\f0da\00A0';  /* caret-right, non-breaking space */
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.p-Collapse-open > .p-Collapse-header::before {
    content: '\f0d7\00A0'; /* caret-down, non-breaking space */
}

.p-Collapse-contents {
    padding: var(--jp-widgets-container-padding);
    background-color: var(--jp-layout-color1);
    color: var(--jp-ui-font-color1);
    border-left: var(--jp-widgets-border-width) solid var(--jp-border-color1);
    border-right: var(--jp-widgets-border-width) solid var(--jp-border-color1);
    border-bottom: var(--jp-widgets-border-width) solid var(--jp-border-color1);
    overflow: auto;
}

.p-Accordion {
    display: flex;
    flex-direction: column;
    align-items: stretch;
}

.p-Accordion .p-Collapse {
    margin-bottom: 0;
}

.p-Accordion .p-Collapse + .p-Collapse {
    margin-top: 4px;
}



/* HTML widget */

.widget-html, .widget-htmlmath {
    font-size: var(--jp-widgets-font-size);
}

.widget-html > .widget-html-content, .widget-htmlmath > .widget-html-content {
    /* Fill out the area in the HTML widget */
    align-self: stretch;
    flex-grow: 1;
    flex-shrink: 1;
    /* Makes sure the baseline is still aligned with other elements */
    line-height: var(--jp-widgets-inline-height);
    /* Make it possible to have absolutely-positioned elements in the html */
    position: relative;
}


/* Image widget  */

.widget-image {
    max-width: 100%;
    height: auto;
}
</style><style type="text/css">/* Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main-italic; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Normal-italic; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Normal-Italic.woff?V=2.7.9') format('woff'), url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Normal-Italic.otf?V=2.7.9') format('opentype')}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main; src: url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://zbwlncob.labs.coursera.org/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
</style><link id="favicon" type="image/x-icon" rel="shortcut icon" href="https://zbwlncob.labs.coursera.org/static/base/images/favicon-notebook.ico"></head>

<body class="notebook_app ctb_global_show command_mode" data-base-url="/" data-ws-url="" data-notebook-name="Residual_Networks.ipynb" data-notebook-path="W2A1/Residual_Networks.ipynb" dir="ltr"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed. 
  </div>
</noscript>

<div id="header" role="navigation" aria-label="Top Menu" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand"><a href="https://zbwlncob.labs.coursera.org/tree" title="dashboard">
      <img src="./logo.png" alt="Jupyter Notebook">
  </a></div>

  


<span id="save_widget" class="save_widget">
    <span id="notebook_name" class="filename">Residual_Networks</span>
    <span class="checkpoint_status" title="Sat, Jun 5, 2021 10:03 PM">Last Checkpoint: 6 minutes ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>


  

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" alt="Current Kernel Logo" src="./logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  
  
  
  

    <span id="login_widget">
      
    </span>

  

  
  
  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" disabled="disabled" style="cursor: help;"><span title="Javascript enabled for notebook display">Trusted</span></div><div id="notification_widgets" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" id="filelink" data-toggle="dropdown" aria-haspopup="true" aria-controls="file_menu" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu" role="menu" aria-labelledby="filelink">
                        <li id="new_notebook" class="menu_focus_highlight dropdown dropdown-submenu" role="none">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">New Notebook<span class="sr-only">Dropdown</span></a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu" role="menu">
                            <li id="new-notebook-submenu-python3"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" role="none" title="Opens a new window with the Dashboard view">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider" role="none"></li>
                        <li id="copy_notebook" role="none" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Make a Copy...</a></li>
                        <li id="save_notebook_as" role="none" title="Save a copy of the notebook&#39;s contents and start a new kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Save as...</a></li>
                        <li id="rename_notebook" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Rename...</a></li>
                        <li id="save_checkpoint" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Save and Checkpoint</span><span class="kb"><kbd>Ctrl-S</kbd></span></a></li>
                        <!-- <hr/> -->
                        <li class="divider" role="none"></li>
                        <li id="restore_checkpoint" class="menu_focus_highlight dropdown-submenu" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Revert to Checkpoint<span class="sr-only">Dropdown</span></a>
                          <ul class="dropdown-menu"><li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Saturday, June 5, 2021 10:03 PM</a></li></ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="print_preview" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Print Preview</a></li>
                        <li class="dropdown-submenu menu_focus_highlight" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Download as<span class="sr-only">Dropdown</span></a>
                            <ul id="download_menu" class="dropdown-menu">
                                
                                <li id="download_asciidoc">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">AsciiDoc (.asciidoc)</a>
                                </li>
                                
                                <li id="download_html">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">HTML (.html)</a>
                                </li>
                                
                                <li id="download_latex">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">LaTeX (.tex)</a>
                                </li>
                                
                                <li id="download_markdown">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Markdown (.md)</a>
                                </li>
                                
                                <li id="download_notebook">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Notebook (.ipynb)</a>
                                </li>
                                
                                <li id="download_pdf">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">PDF via LaTeX (.pdf)</a>
                                </li>
                                
                                <li id="download_rst">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">reST (.rst)</a>
                                </li>
                                
                                <li id="download_script">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Python (.py)</a>
                                </li>
                                
                                <li id="download_slides">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Reveal.js slides (.slides.html)</a>
                                </li>
                                
                                <li id="download_webpdf">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">PDF via pyppeteer (.html)</a>
                                </li>
                                
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="trust_notebook" role="none" title="Trust the output of this notebook" class="disabled">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Trusted Notebook</a></li>
                        <li class="divider" role="none"></li>
                        <li id="close_and_halt" role="none" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Close and Halt</a></li>
                    </ul>
                </li>

                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" id="editlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="edit_menu">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu" role="menu" aria-labelledby="editlink">
                        <li id="cut_cell" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Cut Cells</span><span class="kb"><kbd>X</kbd></span></a></li>
                        <li id="copy_cell" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Copy Cells</span><span class="kb"><kbd>C</kbd></span></a></li>
                        <li id="paste_cell_above" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Paste Cells Above</span><span class="kb"><kbd>Shift-V</kbd></span></a></li>
                        <li id="paste_cell_below" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Paste Cells Below</span><span class="kb"><kbd>V</kbd></span></a></li>
                        <li id="paste_cell_replace" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Delete Cells</span><span class="kb"><kbd>D</kbd>,<kbd>D</kbd></span></a></li>
                        <li id="undelete_cell" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Undo Delete Cells</span><span class="kb"><kbd>Z</kbd></span></a></li>
                        <li class="divider" role="none"></li>
                        <li id="split_cell" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Split Cell</span><span class="kb"><kbd>Ctrl-Shift-Minus</kbd></span></a></li>
                        <li id="merge_cell_above" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Merge Cell Above</a></li>
                        <li id="merge_cell_below" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Merge Cell Below</a></li>
                        <li class="divider" role="none"></li>
                        <li id="move_cell_up" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Move Cell Up</a></li>
                        <li id="move_cell_down" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Move Cell Down</a></li>
                        <li class="divider" role="none"></li>
                        <li id="edit_nb_metadata" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Edit Notebook Metadata</a></li>
                        <li class="divider" role="none"></li>
                        <li id="find_and_replace" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem"> Find and Replace </a></li>
                        <li class="divider" role="none"></li>
                        <li id="cut_cell_attachments" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true">Paste Cell Attachments</a></li>
                        <li class="divider" role="none"></li>
                        <li id="insert_image" class="disabled" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-disabled="true">  Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" id="viewlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="view_menu">View</a>
                    <ul id="view_menu" class="dropdown-menu" role="menu" aria-labelledby="viewlink">
                        <li id="toggle_header" role="none" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" role="none" title="Show/Hide the action icons (below menu bar)">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" role="none" title="Show/Hide line numbers in cells">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Toggle Line Numbers</span><span class="kb"><kbd>Shift-L</kbd></span></a>
                        </li>
                        <li id="menu-cell-toolbar" class="menu_focus_highlight dropdown-submenu" role="none">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Attachments</a></li><li data-name="Tags"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" id="insertlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="insert_menu">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu" role="menu" aria-labelledby="insertlink">
                        <li id="insert_cell_above" role="none" title="Insert an empty Code cell above the currently active cell">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Insert Cell Above</span><span class="kb"><kbd>A</kbd></span></a></li>
                        <li id="insert_cell_below" role="none" title="Insert an empty Code cell below the currently active cell">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Insert Cell Below</span><span class="kb"><kbd>B</kbd></span></a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" id="celllink" data-toggle="dropdown" aria-haspopup="true" aria-controls="cell_menu">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu" role="menu" aria-labelledby="celllink">
                        <li id="run_cell" role="none" title="Run this cell, and move cursor to the next one">
                            <a role="menuitem" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Run Cells</span><span class="kb"><kbd>Ctrl-Enter</kbd></span></a></li>
                        <li id="run_cell_select_below" role="none" title="Run this cell, select below">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Run Cells and Select Below</span><span class="kb"><kbd>Shift-Enter</kbd></span></a></li>
                        <li id="run_cell_insert_below" role="none" title="Run this cell, insert below">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Run Cells and Insert Below</span><span class="kb"><kbd>Alt-Enter</kbd></span></a></li>
                        <li id="run_all_cells" role="none" title="Run all cells in the notebook">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Run All</a></li>
                        <li id="run_all_cells_above" role="none" title="Run all cells above (but not including) this cell">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Run All Above</a></li>
                        <li id="run_all_cells_below" role="none" title="Run this cell and all cells below it">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem">Run All Below</a></li>
                        <li class="divider" role="none"></li>
                        <li id="change_cell_type" class="menu_focus_highlight dropdown-submenu" role="none" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Cell Type</a>
                            <ul class="dropdown-menu" role="menu">
                              <li id="to_code" role="none" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Code</span><span class="kb"><kbd>Y</kbd></span></a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Markdown</span><span class="kb"><kbd>M</kbd></span></a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Raw NBConvert</span><span class="kb"><kbd>R</kbd></span></a></li>
                            </ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="current_outputs" class="menu_focus_highlight dropdown-submenu" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Current Outputs</a>
                            <ul class="dropdown-menu" role="menu">
                                <li id="toggle_current_output" role="none" title="Hide/Show the output of the current cell">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Toggle</span><span class="kb"><kbd>O</kbd></span></a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Toggle Scrolling</span><span class="kb"><kbd>Shift-O</kbd></span></a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="menu_focus_highlight dropdown-submenu" role="none"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">All Output</a>
                            <ul class="dropdown-menu" role="menu">
                                <li id="toggle_all_output" role="none" title="Hide/Show the output of all cells">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" data-toggle="dropdown" id="kernellink">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu" aria-labelledby="kernellink">
                        <li id="int_kernel" title="Send Keyboard Interrupt (CTRL-C) to the Kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Interrupt</span><span class="kb"><kbd>I</kbd>,<kbd>I</kbd></span></a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Restart</span><span class="kb"><kbd>0</kbd>,<kbd>0</kbd></span></a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="menu-change-kernel" class="menu_focus_highlight dropdown-submenu" role="menuitem">
                            <a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python3"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" data-toggle="dropdown" class="dropdown-toggle">Widgets</a><ul id="widget-submenu" class="dropdown-menu"><li title="Save the notebook with the widget state information for static rendering"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Save Notebook Widget State</a></li><li title="Clear the widget state information from the notebook"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Clear Notebook Widget State</a></li><ul class="divider"></ul><li title="Download the widget state as a JSON file"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Download Widget State</a></li><li title="Embed interactive widgets"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Embed Widgets</a></li></ul></li><li class="dropdown"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" class="menu-shortcut-container"><span class="action">Keyboard Shortcuts</span><span class="kb"><kbd>H</kbd></span></a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

						
                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.jupyter.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="https://docs.python.org/3.6?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://ipython.org/documentation.html?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/numpy/reference/?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/scipy/reference/?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://matplotlib.org/contents.html?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://pandas.pydata.org/pandas-docs/stable/?v=20210605174542"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas Reference</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" aria-label="Run" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-play fa"></i><span class="toolbar-btn-label">Run</span></button><button class="btn btn-default" title="interrupt the kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button><button class="btn btn-default" title="restart the kernel, then re-run the whole notebook (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel-and-run-all-cells"><i class="fa-forward fa"></i></button></div><select id="cell_type" aria-label="combobox, select cell type" role="combobox" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group" id="cmd_palette"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="display: block; height: 764px;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 304px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 21px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-1"># Residual Networks</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Welcome to the first assignment of this week! You'll be building a very deep convolutional network, using Residual Networks (ResNets). In theory, very deep networks can represent very complex functions; but in practice, they are hard to train. Residual Networks, introduced by <span class="cm-link">[He et al.]</span><span class="cm-string cm-url">(https://arxiv.org/pdf/1512.03385.pdf)</span>, allow you to train much deeper networks than were previously feasible.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**By the end of this assignment, you'll be able to:**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Implement the basic building blocks of ResNets in a deep neural network using Keras</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Put together these building blocks to implement and train a state-of-the-art neural network for image classification</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Implement a skip connection in your network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">For this assignment, you'll use Keras. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Before jumping into the problem, run the cell below to load the required packages.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 304px;"></div><div class="CodeMirror-gutters" style="display: none; height: 339px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><h1 id="Residual-Networks">Residual Networks<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#Residual-Networks">¶</a></h1>
<p>Welcome to the first assignment of this week! You'll be building a very deep convolutional network, using Residual Networks (ResNets). In theory, very deep networks can represent very complex functions; but in practice, they are hard to train. Residual Networks, introduced by <a href="https://arxiv.org/pdf/1512.03385.pdf" target="_blank">He et al.</a>, allow you to train much deeper networks than were previously feasible.</p>
<p><strong>By the end of this assignment, you'll be able to:</strong></p>
<ul>
<li>Implement the basic building blocks of ResNets in a deep neural network using Keras</li>
<li>Put together these building blocks to implement and train a state-of-the-art neural network for image classification</li>
<li>Implement a skip connection in your network</li>
</ul>
<p>For this assignment, you'll use Keras. </p>
<p>Before jumping into the problem, run the cell below to load the required packages.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 235px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Table of Content</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[1 - Packages]</span><span class="cm-string cm-url cm-variable-2">(#1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[2 - The Problem of Very Deep Neural Networks]</span><span class="cm-string cm-url cm-variable-2">(#2)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[3 - Building a Residual Network]</span><span class="cm-string cm-url cm-variable-2">(#3)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-link cm-variable-3">[3.1 - The Identity Block]</span><span class="cm-string cm-url cm-variable-3">(#3-1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-link cm-keyword">[Exercise 1 - identity_block]</span><span class="cm-string cm-url cm-keyword">(#ex-1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-link cm-variable-3">[3.2 - The Convolutional Block]</span><span class="cm-string cm-url cm-variable-3">(#3-2)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">- </span><span class="cm-link cm-keyword">[Exercise 2 - convolutional_block]</span><span class="cm-string cm-url cm-keyword">(#ex-2)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[4 - Building Your First ResNet Model (50 layers)]</span><span class="cm-string cm-url cm-variable-2">(#4)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">- </span><span class="cm-link cm-variable-3">[Exercise 3 - ResNet50]</span><span class="cm-string cm-url cm-variable-3">(#ex-3)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[5 - Test on Your Own Image (Optional/Ungraded)]</span><span class="cm-string cm-url cm-variable-2">(#5)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-link cm-variable-2">[6 - Bibliography]</span><span class="cm-string cm-url cm-variable-2">(#6)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 235px;"></div><div class="CodeMirror-gutters" style="display: none; height: 270px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><h2 id="Table-of-Content">Table of Content<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#Table-of-Content">¶</a></h2>
<ul>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#1">1 - Packages</a></li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#2">2 - The Problem of Very Deep Neural Networks</a></li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3">3 - Building a Residual Network</a><ul>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3-1">3.1 - The Identity Block</a><ul>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#ex-1">Exercise 1 - identity_block</a></li>
</ul>
</li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3-2">3.2 - The Convolutional Block</a><ul>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#ex-2">Exercise 2 - convolutional_block</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#4">4 - Building Your First ResNet Model (50 layers)</a><ul>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#ex-3">Exercise 3 - ResNet50</a></li>
</ul>
</li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#5">5 - Test on Your Own Image (Optional/Ungraded)</a></li>
<li><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#6">6 - Bibliography</a></li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 48px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'1'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 1 - Packages</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 48px;"></div><div class="CodeMirror-gutters" style="display: none; height: 83px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="1"></a></p>
<h2 id="1---Packages">1 - Packages<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#1---Packages">¶</a></h2>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[48]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 147.328px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1432px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1431.64px; margin-bottom: -15px; border-right-width: 35px; min-height: 317px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 147.328px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">scipy</span>.<span class="cm-property">misc</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">applications</span>.<span class="cm-property">resnet_v2</span> <span class="cm-keyword">import</span> <span class="cm-variable">ResNet50V2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">image</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">applications</span>.<span class="cm-property">resnet_v2</span> <span class="cm-keyword">import</span> <span class="cm-variable">preprocess_input</span>, <span class="cm-variable">decode_predictions</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span> <span class="cm-keyword">import</span> <span class="cm-variable">layers</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">Input</span>, <span class="cm-variable">Add</span>, <span class="cm-variable">Dense</span>, <span class="cm-variable">Activation</span>, <span class="cm-variable">ZeroPadding2D</span>, <span class="cm-variable">BatchNormalization</span>, <span class="cm-variable">Flatten</span>, <span class="cm-variable">Conv2D</span>, <span class="cm-variable">AveragePooling2D</span>, <span class="cm-variable">MaxPooling2D</span>, <span class="cm-variable">GlobalMaxPooling2D</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Model</span>, <span class="cm-variable">load_model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">resnets_utils</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">keras</span>.<span class="cm-property">initializers</span> <span class="cm-keyword">import</span> <span class="cm-variable">random_uniform</span>, <span class="cm-variable">glorot_uniform</span>, <span class="cm-variable">constant</span>, <span class="cm-variable">identity</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">tensorflow</span>.<span class="cm-property">python</span>.<span class="cm-property">framework</span>.<span class="cm-property">ops</span> <span class="cm-keyword">import</span> <span class="cm-variable">EagerTensor</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">import</span> <span class="cm-variable">imshow</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">test_utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">summary</span>, <span class="cm-variable">comparator</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">public_tests</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">matplotlib</span> <span class="cm-variable">inline</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 317px;"></div><div class="CodeMirror-gutters" style="display: none; height: 367px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 405px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'2'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 2 - The Problem of Very Deep Neural Networks</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Last week, you built your first convolutional neural networks: first manually with numpy, then using Tensorflow and Keras. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">In recent years, neural networks have become much deeper, with state-of-the-art networks evolving from having just a few layers (e.g., AlexNet) to over a hundred layers.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">* The main benefit of a very deep network is that it can represent very complex functions. It can also learn features at many different levels of abstraction, from edges (at the shallower layers, closer to the input) to very complex features (at the deeper layers, closer to the output). </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">* However, using a deeper network doesn't always help. A huge barrier to training them is vanishing gradients: very deep networks often have a gradient signal that goes to zero quickly, thus making gradient descent prohibitively slow.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">* More specifically, during gradient descent, as you backpropagate from the final layer back to the first layer, you are multiplying by the weight matrix on each step, and thus the gradient can decrease exponentially quickly to zero (or, in rare cases, grow exponentially quickly and "explode," from gaining very large values). </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">* During training, you might therefore see the magnitude (or norm) of the gradient for the shallower layers decrease to zero very rapidly as training proceeds, as shown below: </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 405px;"></div><div class="CodeMirror-gutters" style="display: none; height: 440px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="2"></a></p>
<h2 id="2---The-Problem-of-Very-Deep-Neural-Networks">2 - The Problem of Very Deep Neural Networks<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#2---The-Problem-of-Very-Deep-Neural-Networks">¶</a></h2>
<p>Last week, you built your first convolutional neural networks: first manually with numpy, then using Tensorflow and Keras. </p>
<p>In recent years, neural networks have become much deeper, with state-of-the-art networks evolving from having just a few layers (e.g., AlexNet) to over a hundred layers.</p>
<ul>
<li><p>The main benefit of a very deep network is that it can represent very complex functions. It can also learn features at many different levels of abstraction, from edges (at the shallower layers, closer to the input) to very complex features (at the deeper layers, closer to the output). </p>
</li>
<li><p>However, using a deeper network doesn't always help. A huge barrier to training them is vanishing gradients: very deep networks often have a gradient signal that goes to zero quickly, thus making gradient descent prohibitively slow.</p>
</li>
<li><p>More specifically, during gradient descent, as you backpropagate from the final layer back to the first layer, you are multiplying by the weight matrix on each step, and thus the gradient can decrease exponentially quickly to zero (or, in rare cases, grow exponentially quickly and "explode," from gaining very large values). </p>
</li>
<li><p>During training, you might therefore see the magnitude (or norm) of the gradient for the shallower layers decrease to zero very rapidly as training proceeds, as shown below: </p>
</li>
</ul>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/vanishing_grad_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:450px;height:220px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 1<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Vanishing gradient<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> The speed of learning decreases very rapidly for the shallower layers as the network trains <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Not to worry! You are now going to solve this problem by building a Residual Network!</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><img src="./vanishing_grad_kiank.png" style="width: 450px ; height: 220px">
<center> <u> <font color="purple"> <b>Figure 1</b> </font></u><font color="purple">  : <b>Vanishing gradient</b> <br> The speed of learning decreases very rapidly for the shallower layers as the network trains </font></center>

<p>Not to worry! You are now going to solve this problem by building a Residual Network!</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 371px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'3'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 3 - Building a Residual Network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">In ResNets, a "shortcut" or a "skip connection" allows the model to skip layers:<span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/skip_connection_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:650px;height:200px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 2<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : A ResNet block showing a skip-connection <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The image on the left shows the "main path" through the network. The image on the right adds a shortcut to the main path. By stacking these ResNet blocks on top of each other, you can form a very deep network. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The lecture mentioned that having ResNet blocks with the shortcut also makes it very easy for one of the blocks to learn an identity function. This means that you can stack on additional ResNet blocks with little risk of harming training set performance. &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">On that note, there is also some evidence that the ease of learning an identity function accounts for ResNets' remarkable performance even more than skip connections help with vanishing gradients.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Two main types of blocks are used in a ResNet, depending mainly on whether the input/output dimensions are the same or different. You are going to implement both of them: the "identity block" and the "convolutional block."</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 371px;"></div><div class="CodeMirror-gutters" style="display: none; height: 406px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="3"></a></p>
<h2 id="3---Building-a-Residual-Network">3 - Building a Residual Network<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3---Building-a-Residual-Network">¶</a></h2>
<p>In ResNets, a "shortcut" or a "skip connection" allows the model to skip layers:  </p>
<img src="./skip_connection_kiank.png" style="width: 650px ; height: 200px">
<center> <u> <font color="purple"> <b>Figure 2</b> </font></u><font color="purple">  : A ResNet block showing a skip-connection <br> </font></center>

<p>The image on the left shows the "main path" through the network. The image on the right adds a shortcut to the main path. By stacking these ResNet blocks on top of each other, you can form a very deep network. </p>
<p>The lecture mentioned that having ResNet blocks with the shortcut also makes it very easy for one of the blocks to learn an identity function. This means that you can stack on additional ResNet blocks with little risk of harming training set performance.  </p>
<p>On that note, there is also some evidence that the ease of learning an identity function accounts for ResNets' remarkable performance even more than skip connections help with vanishing gradients.</p>
<p>Two main types of blocks are used in a ResNet, depending mainly on whether the input/output dimensions are the same or different. You are going to implement both of them: the "identity block" and the "convolutional block."</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 369px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'3-1'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.1 - The Identity Block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The identity block is the standard block used in ResNets, and corresponds to the case where the input activation (say <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{[</span>l<span class="cm-bracket">]}</span><span class="cm-delimit cm-delimit-close">$</span>) has the same dimension as the output activation (say <span class="cm-delimit cm-delimit-open">$</span>a^<span class="cm-bracket">{[</span>l+2<span class="cm-bracket">]}</span><span class="cm-delimit cm-delimit-close">$</span>). To flesh out the different steps of what happens in a ResNet's identity block, here is an alternative diagram showing the individual steps:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/idblock2_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:650px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 3<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Identity block.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> Skip connection "skips over" 2 layers. <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The upper path is the "shortcut path." The lower path is the "main path." In this diagram, notice the CONV2D and ReLU steps in each layer. To speed up training, a BatchNorm step has been added. Don't worry about this being complicated to implement--you'll see that BatchNorm is just one line of code in Keras! </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">In this exercise, you'll actually implement a slightly more powerful version of this identity block, in which the skip connection "skips over" 3 hidden layers rather than 2 layers. It looks like this: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/idblock3_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:650px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 4<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Identity block.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> Skip connection "skips over" 3 layers.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 369px;"></div><div class="CodeMirror-gutters" style="display: none; height: 404px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="3-1"></a></p>
<h3 id="3.1---The-Identity-Block">3.1 - The Identity Block<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3.1---The-Identity-Block">¶</a></h3>
<p>The identity block is the standard block used in ResNets, and corresponds to the case where the input activation (say <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.584em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.174em, 1001.29em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.291em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXMathJax_Normal-italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.53em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="font-size: 70.7%; font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑙</span><span class="mo" id="MathJax-Span-9" style="font-size: 70.7%; font-family: STIXMathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">a^{[l]}</script>) has the same dimension as the output activation (say <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 2.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.111em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.174em, 1002.11em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 2.111em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: STIXMathJax_Normal-italic;">𝑎</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.53em;"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mo" id="MathJax-Span-16" style="font-size: 70.7%; font-family: STIXMathJax_Main;">[</span><span class="mi" id="MathJax-Span-17" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑙</span><span class="mo" id="MathJax-Span-18" style="font-size: 70.7%; font-family: STIXMathJax_Main;">+</span><span class="mn" id="MathJax-Span-19" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span class="mo" id="MathJax-Span-20" style="font-size: 70.7%; font-family: STIXMathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>+</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">a^{[l+2]}</script>). To flesh out the different steps of what happens in a ResNet's identity block, here is an alternative diagram showing the individual steps:</p>
<img src="./idblock2_kiank.png" style="width: 650px ; height: 150px">
<center> <u> <font color="purple"> <b>Figure 3</b> </font></u><font color="purple">  : <b>Identity block.</b> Skip connection "skips over" 2 layers. </font></center>

<p>The upper path is the "shortcut path." The lower path is the "main path." In this diagram, notice the CONV2D and ReLU steps in each layer. To speed up training, a BatchNorm step has been added. Don't worry about this being complicated to implement--you'll see that BatchNorm is just one line of code in Keras! </p>
<p>In this exercise, you'll actually implement a slightly more powerful version of this identity block, in which the skip connection "skips over" 3 hidden layers rather than 2 layers. It looks like this: </p>
<img src="./idblock3_kiank.png" style="width: 650px ; height: 150px">
    <center> <u> <font color="purple"> <b>Figure 4</b> </font></u><font color="purple">  : <b>Identity block.</b> Skip connection "skips over" 3 layers.</font></center></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 811px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">These are the individual steps:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">First component of main path: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The first CONV2D has </span><span class="cm-delimit cm-delimit-open">$</span>F_1<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> filters of shape (1,1) and a stride of (1,1). Its padding is "valid". Use 0 as the seed for the random uniform initialization: </span><span class="cm-comment cm-variable-2">`kernel_initializer = initializer(seed=0)`</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The first BatchNorm is normalizing the 'channels' axis.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Then apply the ReLU activation function. This has no hyperparameters. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Second component of main path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The second CONV2D has </span><span class="cm-delimit cm-delimit-open">$</span>F_2<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> filters of shape </span><span class="cm-delimit cm-delimit-open">$</span>(f,f)<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> and a stride of (1,1). Its padding is "same". Use 0 as the seed for the random uniform initialization: </span><span class="cm-comment cm-variable-2">`kernel_initializer = initializer(seed=0)`</span><span class="cm-variable-2">.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The second BatchNorm is normalizing the 'channels' axis.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Then apply the ReLU activation function. This has no hyperparameters.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Third component of main path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The third CONV2D has </span><span class="cm-delimit cm-delimit-open">$</span>F_3<span class="cm-delimit cm-delimit-close">$</span><span class="cm-variable-2"> filters of shape (1,1) and a stride of (1,1). Its padding is "valid". Use 0 as the seed for the random uniform initialization: </span><span class="cm-comment cm-variable-2">`kernel_initializer = initializer(seed=0)`</span><span class="cm-variable-2">. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The third BatchNorm is normalizing the 'channels' axis.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Note that there is </span><span class="cm-strong cm-variable-2">**no**</span><span class="cm-variable-2"> ReLU activation function in this component. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Final step: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- The </span><span class="cm-comment cm-variable-2">`X_shortcut`</span><span class="cm-variable-2"> and the output from the 3rd layer </span><span class="cm-comment cm-variable-2">`X`</span><span class="cm-variable-2"> are added together.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- </span><span class="cm-strong cm-variable-2">**Hint**</span><span class="cm-variable-2">: The syntax will look something like </span><span class="cm-comment cm-variable-2">`Add()([var1,var2])`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Then apply the ReLU activation function. This has no hyperparameters. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'ex-1'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Exercise 1 - identity_block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Implement the ResNet identity block. The first component of the main path has been implemented for you already! First, you should read these docs carefully to make sure you understand what's happening. Then, implement the rest. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- To implement the Conv2D step: </span><span class="cm-link cm-variable-2">[Conv2D]</span><span class="cm-string cm-url cm-variable-2">(https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- To implement BatchNorm: </span><span class="cm-link cm-variable-2">[BatchNormalization]</span><span class="cm-string cm-url cm-variable-2">(https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization)</span><span class="cm-variable-2"> </span><span class="cm-comment cm-variable-2">`BatchNormalization(axis = 3)(X, training = training)`</span><span class="cm-variable-2">. If training is set to False, its weights are not updated with the new examples. I.e when the model is used in prediction mode.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- For the activation, use: &nbsp;</span><span class="cm-comment cm-variable-2">`Activation('relu')(X)`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- To add the value passed forward by the shortcut: </span><span class="cm-link cm-variable-2">[Add]</span><span class="cm-string cm-url cm-variable-2">(https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">We have added the initializer argument to our functions. This parameter receives an initializer function like the ones included in the package <span class="cm-link">[tensorflow.keras.initializers]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/keras/initializers)</span> or any other custom initializer. By default it will be set to <span class="cm-link">[random_uniform]</span><span class="cm-string cm-url">(https://www.tensorflow.org/api_docs/python/tf/keras/initializers/RandomUniform)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Remember that these functions accept a <span class="cm-comment">`seed`</span> argument that can be any value you want, but that in this notebook must set to 0 for <span class="cm-strong">**grading purposes**</span>.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 811px;"></div><div class="CodeMirror-gutters" style="display: none; height: 846px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>These are the individual steps:</p>
<p>First component of main path: </p>
<ul>
<li>The first CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="msubsup" id="MathJax-Span-23"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-24" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-25" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">F_1</script> filters of shape (1,1) and a stride of (1,1). Its padding is "valid". Use 0 as the seed for the random uniform initialization: <code>kernel_initializer = initializer(seed=0)</code>. </li>
<li>The first BatchNorm is normalizing the 'channels' axis.</li>
<li>Then apply the ReLU activation function. This has no hyperparameters. </li>
</ul>
<p>Second component of main path:</p>
<ul>
<li>The second CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="msubsup" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-30" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">F_2</script> filters of shape <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 2.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.345em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.584em, 1002.29em, 2.813em, -999.997em); top: -2.456em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mo" id="MathJax-Span-33" style="font-family: STIXMathJax_Main;">(</span><span class="mi" id="MathJax-Span-34" style="font-family: STIXMathJax_Normal-italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXMathJax_Main;">,</span><span class="mi" id="MathJax-Span-36" style="font-family: STIXMathJax_Normal-italic; padding-left: 0.179em;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-37" style="font-family: STIXMathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.462em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>f</mi><mo>,</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">(f,f)</script> and a stride of (1,1). Its padding is "same". Use 0 as the seed for the random uniform initialization: <code>kernel_initializer = initializer(seed=0)</code>.</li>
<li>The second BatchNorm is normalizing the 'channels' axis.</li>
<li>Then apply the ReLU activation function. This has no hyperparameters.</li>
</ul>
<p>Third component of main path:</p>
<ul>
<li>The third CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-38" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-39"><span class="msubsup" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-41" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-42" style="font-size: 70.7%; font-family: STIXMathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">F_3</script> filters of shape (1,1) and a stride of (1,1). Its padding is "valid". Use 0 as the seed for the random uniform initialization: <code>kernel_initializer = initializer(seed=0)</code>. </li>
<li>The third BatchNorm is normalizing the 'channels' axis.</li>
<li>Note that there is <strong>no</strong> ReLU activation function in this component. </li>
</ul>
<p>Final step: </p>
<ul>
<li>The <code>X_shortcut</code> and the output from the 3rd layer <code>X</code> are added together.</li>
<li><strong>Hint</strong>: The syntax will look something like <code>Add()([var1,var2])</code></li>
<li>Then apply the ReLU activation function. This has no hyperparameters. </li>
</ul>
<p><a name="ex-1"></a></p>
<h3 id="Exercise-1---identity_block">Exercise 1 - identity_block<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#Exercise-1---identity_block">¶</a></h3>
<p>Implement the ResNet identity block. The first component of the main path has been implemented for you already! First, you should read these docs carefully to make sure you understand what's happening. Then, implement the rest. </p>
<ul>
<li>To implement the Conv2D step: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D" target="_blank">Conv2D</a></li>
<li>To implement BatchNorm: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization" target="_blank">BatchNormalization</a> <code>BatchNormalization(axis = 3)(X, training = training)</code>. If training is set to False, its weights are not updated with the new examples. I.e when the model is used in prediction mode.</li>
<li>For the activation, use:  <code>Activation('relu')(X)</code></li>
<li>To add the value passed forward by the shortcut: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add" target="_blank">Add</a></li>
</ul>
<p>We have added the initializer argument to our functions. This parameter receives an initializer function like the ones included in the package <a href="https://www.tensorflow.org/api_docs/python/tf/keras/initializers" target="_blank">tensorflow.keras.initializers</a> or any other custom initializer. By default it will be set to <a href="https://www.tensorflow.org/api_docs/python/tf/keras/initializers/RandomUniform" target="_blank">random_uniform</a></p>
<p>Remember that these functions accept a <code>seed</code> argument that can be any value you want, but that in this notebook must set to 0 for <strong>grading purposes</strong>.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> Here is where you're actually using the power of the Functional API to create a shortcut path: </span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p> Here is where you're actually using the power of the Functional API to create a shortcut path: </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[49]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1069px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1069.38px; margin-bottom: -15px; border-right-width: 35px; min-height: 793px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># UNQ_C1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: identity_block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span>, <span class="cm-variable">filters</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">initializer</span><span class="cm-operator">=</span><span class="cm-variable">random_uniform</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Implementation of the identity block as defined in Figure 4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    X -- input tensor of shape (m, n_H_prev, n_W_prev, n_C_prev)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    f -- integer, specifying the shape of the middle CONV's window for the main path</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    filters -- python list of integers, defining the number of filters in the CONV layers of the main path</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    training -- True: Behave in training mode</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">                False: Behave in inference mode</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    initializer -- to set up the initial weights of a layer. Equals to random uniform initializer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    X -- output of the identity block, tensor of shape (n_H, n_W, n_C)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve Filters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">F1</span>, <span class="cm-variable">F2</span>, <span class="cm-variable">F3</span> <span class="cm-operator">=</span> <span class="cm-variable">filters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Save the input value. You'll need this later to add back to the main path. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X_shortcut</span> <span class="cm-operator">=</span> <span class="cm-variable">X</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># First component of main path</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F1</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">1</span>,<span class="cm-number">1</span>), <span class="cm-variable">padding</span> <span class="cm-operator">=</span> <span class="cm-string">'valid'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span> <span class="cm-operator">=</span> <span class="cm-variable">training</span>) <span class="cm-comment"># Default axis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Second component of main path (≈3 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F2</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-variable">f</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">1</span>,<span class="cm-number">1</span>), <span class="cm-variable">padding</span> <span class="cm-operator">=</span> <span class="cm-string">'same'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span> <span class="cm-operator">=</span> <span class="cm-variable">training</span>) <span class="cm-comment"># Default axis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Third component of main path (≈2 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F3</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">1</span>,<span class="cm-number">1</span>), <span class="cm-variable">padding</span> <span class="cm-operator">=</span> <span class="cm-string">'valid'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span> <span class="cm-operator">=</span> <span class="cm-variable">training</span>) <span class="cm-comment"># Default axis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Final step: Add shortcut value to main path, and pass it through a RELU activation (≈2 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Add</span>()([<span class="cm-variable">X</span>, <span class="cm-variable">X_shortcut</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">X</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 793px;"></div><div class="CodeMirror-gutters" style="display: none; height: 843px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[50]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 538.125px; margin-bottom: -15px; border-right-width: 35px; min-height: 419px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X1</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X2</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X3</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">concatenate</span>((<span class="cm-variable">X1</span>, <span class="cm-variable">X2</span>, <span class="cm-variable">X3</span>), <span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>).<span class="cm-property">astype</span>(<span class="cm-variable">np</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A3</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span><span class="cm-operator">=</span><span class="cm-number">2</span>, <span class="cm-variable">filters</span><span class="cm-operator">=</span>[<span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                   <span class="cm-variable">initializer</span><span class="cm-operator">=</span><span class="cm-keyword">lambda</span> <span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>:<span class="cm-variable">constant</span>(<span class="cm-variable">value</span><span class="cm-operator">=</span><span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                   <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'\033[1mWith training=False\033[0m\n'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A3np</span> <span class="cm-operator">=</span> <span class="cm-variable">A3</span>.<span class="cm-property">numpy</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">np</span>.<span class="cm-property">around</span>(<span class="cm-variable">A3</span>.<span class="cm-property">numpy</span>()[:,(<span class="cm-number">0</span>,<span class="cm-operator">-</span><span class="cm-number">1</span>),:,:].<span class="cm-property">mean</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>), <span class="cm-number">5</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resume</span> <span class="cm-operator">=</span> <span class="cm-variable">A3np</span>[:,(<span class="cm-number">0</span>,<span class="cm-operator">-</span><span class="cm-number">1</span>),:,:].<span class="cm-property">mean</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">resume</span>[<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'\n\033[1mWith training=True\033[0m\n'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A4</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span><span class="cm-operator">=</span><span class="cm-number">2</span>, <span class="cm-variable">filters</span><span class="cm-operator">=</span>[<span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                   <span class="cm-variable">initializer</span><span class="cm-operator">=</span><span class="cm-keyword">lambda</span> <span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>:<span class="cm-variable">constant</span>(<span class="cm-variable">value</span><span class="cm-operator">=</span><span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                   <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">np</span>.<span class="cm-property">around</span>(<span class="cm-variable">A4</span>.<span class="cm-property">numpy</span>()[:,(<span class="cm-number">0</span>,<span class="cm-operator">-</span><span class="cm-number">1</span>),:,:].<span class="cm-property">mean</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>), <span class="cm-number">5</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">public_tests</span>.<span class="cm-property">identity_block_test</span>(<span class="cm-variable">identity_block</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 419px;"></div><div class="CodeMirror-gutters" style="display: none; height: 454px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre><span class="ansi-bold">With training=False</span>

[[[  0.        0.        0.        0.     ]
  [  0.        0.        0.        0.     ]]

 [[192.71234 192.71234 192.71234  96.85617]
  [ 96.85617  96.85617  96.85617  48.92808]]

 [[578.1371  578.1371  578.1371  290.5685 ]
  [290.5685  290.5685  290.5685  146.78426]]]
96.85617

<span class="ansi-bold">With training=True</span>

[[[0.      0.      0.      0.     ]
  [0.      0.      0.      0.     ]]

 [[0.40739 0.40739 0.40739 0.40739]
  [0.40739 0.40739 0.40739 0.40739]]

 [[4.99991 4.99991 4.99991 3.25948]
  [3.25948 3.25948 3.25948 2.40739]]]
<span class="ansi-green-fg">All tests passed!</span>
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 453px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**Expected value**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">With training=False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">[[[  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; ]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; &nbsp;  0. &nbsp; &nbsp; ]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">[[192.71234 192.71234 192.71234  96.85617]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[ 96.85617  96.85617  96.85617  48.92808]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">[[578.1371  578.1371  578.1371  290.5685 ]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[290.5685  290.5685  290.5685  146.78426]]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">96.85617</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">With training=True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">[[[0. &nbsp; &nbsp;  0. &nbsp; &nbsp;  0. &nbsp; &nbsp;  0. &nbsp; &nbsp; ]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[0. &nbsp; &nbsp;  0. &nbsp; &nbsp;  0. &nbsp; &nbsp;  0. &nbsp; &nbsp; ]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">[[0.40739 0.40739 0.40739 0.40739]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[0.40739 0.40739 0.40739 0.40739]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">[[4.99991 4.99991 4.99991 3.25948]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[3.25948 3.25948 3.25948 2.40739]]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 453px;"></div><div class="CodeMirror-gutters" style="display: none; height: 488px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><strong>Expected value</strong></p>
<pre><code>With training=False

[[[  0.        0.        0.        0.     ]
  [  0.        0.        0.        0.     ]]

 [[192.71234 192.71234 192.71234  96.85617]
  [ 96.85617  96.85617  96.85617  48.92808]]

 [[578.1371  578.1371  578.1371  290.5685 ]
  [290.5685  290.5685  290.5685  146.78426]]]
96.85617

With training=True

[[[0.      0.      0.      0.     ]
  [0.      0.      0.      0.     ]]

 [[0.40739 0.40739 0.40739 0.40739]
  [0.40739 0.40739 0.40739 0.40739]]

 [[4.99991 4.99991 4.99991 3.25948]
  [3.25948 3.25948 3.25948 2.40739]]]</code></pre></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 1253px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'3-2'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### 3.2 - The Convolutional Block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The ResNet "convolutional block" is the second block type. You can use this type of block when the input and output dimensions don't match up. The difference with the identity block is that there is a CONV2D layer in the shortcut path: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/convblock_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:650px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 4<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Convolutional block<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">* The CONV2D layer in the shortcut path is used to resize the input <span class="cm-delimit cm-delimit-open">$</span>x<span class="cm-delimit cm-delimit-close">$</span> to a different dimension, so that the dimensions match up in the final addition needed to add the shortcut value back to the main path. (This plays a similar role as the matrix <span class="cm-delimit cm-delimit-open">$</span>W_s<span class="cm-delimit cm-delimit-close">$</span> discussed in lecture.) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">* For example, to reduce the activation dimensions's height and width by a factor of 2, you can use a 1x1 convolution with a stride of 2. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">* The CONV2D layer on the shortcut path does not use any non-linear activation function. Its main role is to just apply a (learned) linear function that reduces the dimension of the input, so that the dimensions match up for the later addition step. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">* As for the previous exercise, the additional `initializer` argument is required for grading purposes, and it has been set by default to [glorot_uniform](https://www.tensorflow.org/api_docs/python/tf/keras/initializers/GlorotUniform)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The details of the convolutional block are as follows. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">First component of main path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The first CONV2D has <span class="cm-delimit cm-delimit-open">$</span>F_1<span class="cm-delimit cm-delimit-close">$</span> filters of shape (1,1) and a stride of (s,s). Its padding is "valid". Use 0 as the `glorot_uniform` seed `kernel_initializer = initializer(seed=0)`.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The first BatchNorm is normalizing the 'channels' axis.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Then apply the ReLU activation function. This has no hyperparameters. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Second component of main path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The second CONV2D has <span class="cm-delimit cm-delimit-open">$</span>F_2<span class="cm-delimit cm-delimit-close">$</span> filters of shape (f,f) and a stride of (1,1). Its padding is "same".  Use 0 as the `glorot_uniform` seed `kernel_initializer = initializer(seed=0)`.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The second BatchNorm is normalizing the 'channels' axis.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Then apply the ReLU activation function. This has no hyperparameters. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Third component of main path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The third CONV2D has <span class="cm-delimit cm-delimit-open">$</span>F_3<span class="cm-delimit cm-delimit-close">$</span> filters of shape (1,1) and a stride of (1,1). Its padding is "valid".  Use 0 as the `glorot_uniform` seed `kernel_initializer = initializer(seed=0)`.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The third BatchNorm is normalizing the 'channels' axis. Note that there is no ReLU activation function in this component. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Shortcut path:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The CONV2D has <span class="cm-delimit cm-delimit-open">$</span>F_3<span class="cm-delimit cm-delimit-close">$</span> filters of shape (1,1) and a stride of (s,s). Its padding is "valid".  Use 0 as the `glorot_uniform` seed `kernel_initializer = initializer(seed=0)`.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The BatchNorm is normalizing the 'channels' axis. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Final step: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The shortcut and the main path values are added together.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Then apply the ReLU activation function. This has no hyperparameters. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'ex-2'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">### Exercise 2 - convolutional_block</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Implement the convolutional block. The first component of the main path is already implemented; then it's your turn to implement the rest! As before, always use 0 as the seed for the random initialization, to ensure consistency with the grader.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- [Conv2D](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- [BatchNormalization](https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization) (axis: Integer, the axis that should be normalized (typically the features axis)) `BatchNormalization(axis = 3)(X, training = training)`. If training is set to False, its weights are not updated with the new examples. I.e when the model is used in prediction mode.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- For the activation, use:  `Activation('relu')(X)`</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- [Add](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">We have added the initializer argument to our functions. This parameter receives an initializer function like the ones included in the package [tensorflow.keras.initializers](https://www.tensorflow.org/api_docs/python/tf/keras/initializers) or any other custom initializer. By default it will be set to [random_uniform](https://www.tensorflow.org/api_docs/python/tf/keras/initializers/RandomUniform)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Remember that these functions accept a `seed` argument that can be any value you want, but that in this notebook must set to 0 for **grading purposes**.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 1253px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1288px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="3-2"></a></p>
<h3 id="3.2---The-Convolutional-Block">3.2 - The Convolutional Block<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#3.2---The-Convolutional-Block">¶</a></h3>
<p>The ResNet "convolutional block" is the second block type. You can use this type of block when the input and output dimensions don't match up. The difference with the identity block is that there is a CONV2D layer in the shortcut path: </p>
<img src="./convblock_kiank.png" style="width: 650px ; height: 150px">
<center> <u> <font color="purple"> <b>Figure 4</b> </font></u><font color="purple">  : <b>Convolutional block</b> </font></center>

<ul>
<li>The CONV2D layer in the shortcut path is used to resize the input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.47em, 2.462em, -999.997em); top: -2.28em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: STIXMathJax_Normal-italic;">𝑥</span></span><span style="display: inline-block; width: 0px; height: 2.286em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">x</script> to a different dimension, so that the dimensions match up in the final addition needed to add the shortcut value back to the main path. (This plays a similar role as the matrix <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 1.584em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.29em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 1.291em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1001.12em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: STIXMathJax_Normal-italic;">𝑊<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.179em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.94em;"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: STIXMathJax_Normal-italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mi>s</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">W_s</script> discussed in lecture.) </li>
<li>For example, to reduce the activation dimensions's height and width by a factor of 2, you can use a 1x1 convolution with a stride of 2. </li>
<li>The CONV2D layer on the shortcut path does not use any non-linear activation function. Its main role is to just apply a (learned) linear function that reduces the dimension of the input, so that the dimensions match up for the later addition step. </li>
<li>As for the previous exercise, the additional <code>initializer</code> argument is required for grading purposes, and it has been set by default to <a href="https://www.tensorflow.org/api_docs/python/tf/keras/initializers/GlorotUniform" target="_blank">glorot_uniform</a></li>
</ul>
<p>The details of the convolutional block are as follows. </p>
<p>First component of main path:</p>
<ul>
<li>The first CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="msubsup" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-54" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-55" style="font-size: 70.7%; font-family: STIXMathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">F_1</script> filters of shape (1,1) and a stride of (s,s). Its padding is "valid". Use 0 as the <code>glorot_uniform</code> seed <code>kernel_initializer = initializer(seed=0)</code>.</li>
<li>The first BatchNorm is normalizing the 'channels' axis.</li>
<li>Then apply the ReLU activation function. This has no hyperparameters. </li>
</ul>
<p>Second component of main path:</p>
<ul>
<li>The second CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="msubsup" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-60" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">F_2</script> filters of shape (f,f) and a stride of (1,1). Its padding is "same".  Use 0 as the <code>glorot_uniform</code> seed <code>kernel_initializer = initializer(seed=0)</code>.</li>
<li>The second BatchNorm is normalizing the 'channels' axis.</li>
<li>Then apply the ReLU activation function. This has no hyperparameters. </li>
</ul>
<p>Third component of main path:</p>
<ul>
<li>The third CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-61" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="msubsup" id="MathJax-Span-63"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-64" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-65" style="font-size: 70.7%; font-family: STIXMathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">F_3</script> filters of shape (1,1) and a stride of (1,1). Its padding is "valid".  Use 0 as the <code>glorot_uniform</code> seed <code>kernel_initializer = initializer(seed=0)</code>.</li>
<li>The third BatchNorm is normalizing the 'channels' axis. Note that there is no ReLU activation function in this component. </li>
</ul>
<p>Shortcut path:</p>
<ul>
<li>The CONV2D has <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.06em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: STIXMathJax_Normal-italic;">𝐹<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="mn" id="MathJax-Span-70" style="font-size: 70.7%; font-family: STIXMathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">F_3</script> filters of shape (1,1) and a stride of (s,s). Its padding is "valid".  Use 0 as the <code>glorot_uniform</code> seed <code>kernel_initializer = initializer(seed=0)</code>.</li>
<li>The BatchNorm is normalizing the 'channels' axis. </li>
</ul>
<p>Final step: </p>
<ul>
<li>The shortcut and the main path values are added together.</li>
<li>Then apply the ReLU activation function. This has no hyperparameters. </li>
</ul>
<p><a name="ex-2"></a>    </p>
<h3 id="Exercise-2---convolutional_block">Exercise 2 - convolutional_block<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#Exercise-2---convolutional_block">¶</a></h3>
<p>Implement the convolutional block. The first component of the main path is already implemented; then it's your turn to implement the rest! As before, always use 0 as the seed for the random initialization, to ensure consistency with the grader.</p>
<ul>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D" target="_blank">Conv2D</a></li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization" target="_blank">BatchNormalization</a> (axis: Integer, the axis that should be normalized (typically the features axis)) <code>BatchNormalization(axis = 3)(X, training = training)</code>. If training is set to False, its weights are not updated with the new examples. I.e when the model is used in prediction mode.</li>
<li>For the activation, use:  <code>Activation('relu')(X)</code></li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add" target="_blank">Add</a></li>
</ul>
<p>We have added the initializer argument to our functions. This parameter receives an initializer function like the ones included in the package <a href="https://www.tensorflow.org/api_docs/python/tf/keras/initializers" target="_blank">tensorflow.keras.initializers</a> or any other custom initializer. By default it will be set to <a href="https://www.tensorflow.org/api_docs/python/tf/keras/initializers/RandomUniform" target="_blank">random_uniform</a></p>
<p>Remember that these functions accept a <code>seed</code> argument that can be any value you want, but that in this notebook must set to 0 for <strong>grading purposes</strong>.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[51]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1213px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1212.64px; margin-bottom: -15px; border-right-width: 35px; min-height: 980px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># UNQ_C2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: convolutional_block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span>, <span class="cm-variable">filters</span>, <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">initializer</span><span class="cm-operator">=</span><span class="cm-variable">glorot_uniform</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Implementation of the convolutional block as defined in Figure 4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    X -- input tensor of shape (m, n_H_prev, n_W_prev, n_C_prev)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    f -- integer, specifying the shape of the middle CONV's window for the main path</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    filters -- python list of integers, defining the number of filters in the CONV layers of the main path</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    s -- Integer, specifying the stride to be used</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    training -- True: Behave in training mode</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">                False: Behave in inference mode</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    initializer -- to set up the initial weights of a layer. Equals to Glorot uniform initializer, </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">                   also called Xavier uniform initializer.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    X -- output of the convolutional block, tensor of shape (n_H, n_W, n_C)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Retrieve Filters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">F1</span>, <span class="cm-variable">F2</span>, <span class="cm-variable">F3</span> <span class="cm-operator">=</span> <span class="cm-variable">filters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Save the input value</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X_shortcut</span> <span class="cm-operator">=</span> <span class="cm-variable">X</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">##### MAIN PATH #####</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># First component of main path glorot_uniform(seed=0)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F1</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-variable">s</span>, <span class="cm-variable">s</span>), <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'valid'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-variable">training</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Second component of main path (≈3 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F2</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-variable">f</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'same'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-variable">training</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Third component of main path (≈2 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F3</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">1</span>, <span class="cm-number">1</span>), <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'valid'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-variable">training</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">##### SHORTCUT PATH ##### (≈2 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X_shortcut</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-variable">filters</span> <span class="cm-operator">=</span> <span class="cm-variable">F3</span>, <span class="cm-variable">kernel_size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>, <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-variable">s</span>, <span class="cm-variable">s</span>), <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'valid'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">initializer</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X_shortcut</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X_shortcut</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X_shortcut</span>, <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-variable">training</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Final step: Add shortcut value to main path (Use this order [X, X_shortcut]), and pass it through a RELU activation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Add</span>()([<span class="cm-variable">X</span>, <span class="cm-variable">X_shortcut</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">X</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 980px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1030px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[52]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 807.828px; margin-bottom: -15px; border-right-width: 35px; min-height: 368px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">outputs</span> <span class="cm-keyword">import</span> <span class="cm-variable">convolutional_block_output1</span>, <span class="cm-variable">convolutional_block_output2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#X = np.random.randn(3, 4, 4, 6).astype(np.float32)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X1</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X2</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X3</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">ones</span>((<span class="cm-number">1</span>, <span class="cm-number">4</span>, <span class="cm-number">4</span>, <span class="cm-number">3</span>)) <span class="cm-operator">*</span> <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">concatenate</span>((<span class="cm-variable">X1</span>, <span class="cm-variable">X2</span>, <span class="cm-variable">X3</span>), <span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>).<span class="cm-property">astype</span>(<span class="cm-variable">np</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">2</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>], <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-builtin">type</span>(<span class="cm-variable">A</span>) <span class="cm-operator">==</span> <span class="cm-variable">EagerTensor</span>, <span class="cm-string">"Use only tensorflow and keras functions"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-builtin">tuple</span>(<span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">A</span>).<span class="cm-property">numpy</span>()) <span class="cm-operator">==</span> (<span class="cm-number">3</span>, <span class="cm-number">2</span>, <span class="cm-number">2</span>, <span class="cm-number">6</span>), <span class="cm-string">"Wrong shape."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-variable">np</span>.<span class="cm-property">allclose</span>(<span class="cm-variable">A</span>.<span class="cm-property">numpy</span>(), <span class="cm-variable">convolutional_block_output1</span>), <span class="cm-string">"Wrong values when training=False."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">A</span>[<span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">B</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">2</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>], <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-variable">np</span>.<span class="cm-property">allclose</span>(<span class="cm-variable">B</span>.<span class="cm-property">numpy</span>(), <span class="cm-variable">convolutional_block_output2</span>), <span class="cm-string">"Wrong values when training=True."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'\033[92mAll tests passed!'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 403px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>tf.Tensor(
[[[0.         0.66683817 0.         0.         0.88853896 0.5274254 ]
  [0.         0.65053666 0.         0.         0.89592844 0.49965227]]

 [[0.         0.6312079  0.         0.         0.8636247  0.47643146]
  [0.         0.5688321  0.         0.         0.85534114 0.41709304]]], shape=(2, 2, 6), dtype=float32)
<span class="ansi-green-intense-fg">All tests passed!
</span></pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 181px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**Expected value**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">tf.Tensor(</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">[[[0. &nbsp; &nbsp; &nbsp; &nbsp; 0.66683817 0. &nbsp; &nbsp; &nbsp; &nbsp; 0. &nbsp; &nbsp; &nbsp; &nbsp; 0.88853896 0.5274254 ]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[0. &nbsp; &nbsp; &nbsp; &nbsp; 0.65053666 0. &nbsp; &nbsp; &nbsp; &nbsp; 0. &nbsp; &nbsp; &nbsp; &nbsp; 0.89592844 0.49965227]]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">[[0. &nbsp; &nbsp; &nbsp; &nbsp; 0.6312079  0. &nbsp; &nbsp; &nbsp; &nbsp; 0. &nbsp; &nbsp; &nbsp; &nbsp; 0.8636247  0.47643146]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">[0. &nbsp; &nbsp; &nbsp; &nbsp; 0.5688321  0. &nbsp; &nbsp; &nbsp; &nbsp; 0. &nbsp; &nbsp; &nbsp; &nbsp; 0.85534114 0.41709304]]], shape=(2, 2, 6), dtype=float32)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 216px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><strong>Expected value</strong></p>
<pre><code>tf.Tensor(
[[[0.         0.66683817 0.         0.         0.88853896 0.5274254 ]
  [0.         0.65053666 0.         0.         0.89592844 0.49965227]]

 [[0.         0.6312079  0.         0.         0.8636247  0.47643146]
  [0.         0.5688321  0.         0.         0.85534114 0.41709304]]], shape=(2, 2, 6), dtype=float32)</code></pre></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 898px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'4'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 4 - Building Your First ResNet Model (50 layers)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">You now have the necessary blocks to build a very deep ResNet. The following figure describes in detail the architecture of this neural network. "ID BLOCK" in the diagram stands for "Identity block," and "ID BLOCK x3" means you should stack 3 identity blocks together.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/resnet_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:850px;height:150px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 5<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>ResNet-50 model<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The details of this ResNet-50 model are:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Zero-padding pads the input with a pad of (3,3)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Stage 1:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The 2D Convolution has 64 filters of shape (7,7) and uses a stride of (2,2). </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - BatchNorm is applied to the 'channels' axis of the input.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - MaxPooling uses a (3,3) window and a (2,2) stride.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Stage 2:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The convolutional block uses three sets of filters of size [64,64,256], "f" is 3, and "s" is 1.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The 2 identity blocks use three sets of filters of size [64,64,256], and "f" is 3.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Stage 3:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The convolutional block uses three sets of filters of size [128,128,512], "f" is 3 and "s" is 2.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The 3 identity blocks use three sets of filters of size [128,128,512] and "f" is 3.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Stage 4:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The convolutional block uses three sets of filters of size [256, 256, 1024], "f" is 3 and "s" is 2.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The 5 identity blocks use three sets of filters of size [256, 256, 1024] and "f" is 3.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Stage 5:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The convolutional block uses three sets of filters of size [512, 512, 2048], "f" is 3 and "s" is 2.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  - The 2 identity blocks use three sets of filters of size [512, 512, 2048] and "f" is 3.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The 2D Average Pooling uses a window of shape (2,2).</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The 'flatten' layer doesn't have any hyperparameters.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- The Fully Connected (Dense) layer reduces its input to the number of classes using a softmax activation.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'ex-3'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span> &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">### Exercise 3 - ResNet50 </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Implement the ResNet with 50 layers described in the figure above. We have implemented Stages 1 and 2. Please implement the rest. (The syntax for implementing Stages 3-5 should be quite similar to that of Stage 2) Make sure you follow the naming convention in the text above. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">You'll need to use this function: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Average pooling [see reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/AveragePooling2D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Here are some other functions we used in the code below:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Conv2D: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- BatchNorm: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization) (axis: Integer, the axis that should be normalized (typically the features axis))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Zero padding: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/ZeroPadding2D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Max pooling: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPool2D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Fully connected layer: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Addition: [See reference](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add)</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 898px;"></div><div class="CodeMirror-gutters" style="display: none; height: 933px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="4"></a>  </p>
<h2 id="4---Building-Your-First-ResNet-Model-(50-layers)">4 - Building Your First ResNet Model (50 layers)<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#4---Building-Your-First-ResNet-Model-(50-layers)">¶</a></h2>
<p>You now have the necessary blocks to build a very deep ResNet. The following figure describes in detail the architecture of this neural network. "ID BLOCK" in the diagram stands for "Identity block," and "ID BLOCK x3" means you should stack 3 identity blocks together.</p>
<img src="./resnet_kiank.png" style="width: 850px ; height: 150px">
<center> <u> <font color="purple"> <b>Figure 5</b> </font></u><font color="purple">  : <b>ResNet-50 model</b> </font></center>

<p>The details of this ResNet-50 model are:</p>
<ul>
<li>Zero-padding pads the input with a pad of (3,3)</li>
<li>Stage 1:<ul>
<li>The 2D Convolution has 64 filters of shape (7,7) and uses a stride of (2,2). </li>
<li>BatchNorm is applied to the 'channels' axis of the input.</li>
<li>MaxPooling uses a (3,3) window and a (2,2) stride.</li>
</ul>
</li>
<li>Stage 2:<ul>
<li>The convolutional block uses three sets of filters of size [64,64,256], "f" is 3, and "s" is 1.</li>
<li>The 2 identity blocks use three sets of filters of size [64,64,256], and "f" is 3.</li>
</ul>
</li>
<li>Stage 3:<ul>
<li>The convolutional block uses three sets of filters of size [128,128,512], "f" is 3 and "s" is 2.</li>
<li>The 3 identity blocks use three sets of filters of size [128,128,512] and "f" is 3.</li>
</ul>
</li>
<li>Stage 4:<ul>
<li>The convolutional block uses three sets of filters of size [256, 256, 1024], "f" is 3 and "s" is 2.</li>
<li>The 5 identity blocks use three sets of filters of size [256, 256, 1024] and "f" is 3.</li>
</ul>
</li>
<li>Stage 5:<ul>
<li>The convolutional block uses three sets of filters of size [512, 512, 2048], "f" is 3 and "s" is 2.</li>
<li>The 2 identity blocks use three sets of filters of size [512, 512, 2048] and "f" is 3.</li>
</ul>
</li>
<li>The 2D Average Pooling uses a window of shape (2,2).</li>
<li>The 'flatten' layer doesn't have any hyperparameters.</li>
<li>The Fully Connected (Dense) layer reduces its input to the number of classes using a softmax activation.</li>
</ul>
<p><a name="ex-3"></a>      </p>
<h3 id="Exercise-3---ResNet50">Exercise 3 - ResNet50<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#Exercise-3---ResNet50">¶</a></h3>
<p>Implement the ResNet with 50 layers described in the figure above. We have implemented Stages 1 and 2. Please implement the rest. (The syntax for implementing Stages 3-5 should be quite similar to that of Stage 2) Make sure you follow the naming convention in the text above. </p>
<p>You'll need to use this function: </p>
<ul>
<li>Average pooling <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/AveragePooling2D" target="_blank">see reference</a></li>
</ul>
<p>Here are some other functions we used in the code below:</p>
<ul>
<li>Conv2D: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D" target="_blank">See reference</a></li>
<li>BatchNorm: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/BatchNormalization" target="_blank">See reference</a> (axis: Integer, the axis that should be normalized (typically the features axis))</li>
<li>Zero padding: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/ZeroPadding2D" target="_blank">See reference</a></li>
<li>Max pooling: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPool2D" target="_blank">See reference</a></li>
<li>Fully connected layer: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense" target="_blank">See reference</a></li>
<li>Addition: <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Add" target="_blank">See reference</a></li>
</ul>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[53]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 799.312px; margin-bottom: -15px; border-right-width: 35px; min-height: 1201px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># UNQ_C3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># GRADED FUNCTION: ResNet50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">ResNet50</span>(<span class="cm-variable">input_shape</span> <span class="cm-operator">=</span> (<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">3</span>), <span class="cm-variable">classes</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Stage-wise implementation of the architecture of the popular ResNet50:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    CONV2D -&gt; BATCHNORM -&gt; RELU -&gt; MAXPOOL -&gt; CONVBLOCK -&gt; IDBLOCK*2 -&gt; CONVBLOCK -&gt; IDBLOCK*3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    -&gt; CONVBLOCK -&gt; IDBLOCK*5 -&gt; CONVBLOCK -&gt; IDBLOCK*2 -&gt; AVGPOOL -&gt; FLATTEN -&gt; DENSE </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Arguments:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    input_shape -- shape of the images of the dataset</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    classes -- integer, number of classes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    Returns:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    model -- a Model() instance in Keras</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Define the input as a tensor with shape input_shape</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X_input</span> <span class="cm-operator">=</span> <span class="cm-variable">Input</span>(<span class="cm-variable">input_shape</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Zero-Padding</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">ZeroPadding2D</span>((<span class="cm-number">3</span>, <span class="cm-number">3</span>))(<span class="cm-variable">X_input</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Stage 1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Conv2D</span>(<span class="cm-number">64</span>, (<span class="cm-number">7</span>, <span class="cm-number">7</span>), <span class="cm-variable">strides</span> <span class="cm-operator">=</span> (<span class="cm-number">2</span>, <span class="cm-number">2</span>), <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">glorot_uniform</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">BatchNormalization</span>(<span class="cm-variable">axis</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Activation</span>(<span class="cm-string">'relu'</span>)(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">MaxPooling2D</span>((<span class="cm-number">3</span>, <span class="cm-number">3</span>), <span class="cm-variable">strides</span><span class="cm-operator">=</span>(<span class="cm-number">2</span>, <span class="cm-number">2</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Stage 2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">256</span>], <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">256</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">256</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### START CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Stage 3 (≈4 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">128</span>,<span class="cm-number">128</span>,<span class="cm-number">512</span>], <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">128</span>,<span class="cm-number">128</span>,<span class="cm-number">512</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">128</span>,<span class="cm-number">128</span>,<span class="cm-number">512</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">128</span>,<span class="cm-number">128</span>,<span class="cm-number">512</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Stage 4 (≈6 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>], <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">256</span>, <span class="cm-number">256</span>, <span class="cm-number">1024</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## Stage 5 (≈3 lines)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">convolutional_block</span>(<span class="cm-variable">X</span>, <span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>, <span class="cm-variable">filters</span> <span class="cm-operator">=</span> [<span class="cm-number">512</span>, <span class="cm-number">512</span>, <span class="cm-number">2048</span>], <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">512</span>, <span class="cm-number">512</span>, <span class="cm-number">2048</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">identity_block</span>(<span class="cm-variable">X</span>, <span class="cm-number">3</span>, [<span class="cm-number">512</span>, <span class="cm-number">512</span>, <span class="cm-number">2048</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">## AVGPOOL (≈1 line). Use "X = AveragePooling2D(...)(X)"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">AveragePooling2D</span>(<span class="cm-variable">pool_size</span><span class="cm-operator">=</span>(<span class="cm-number">2</span>, <span class="cm-number">2</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">### END CODE HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># output layer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Flatten</span>()(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-variable">Dense</span>(<span class="cm-variable">classes</span>, <span class="cm-variable">activation</span><span class="cm-operator">=</span><span class="cm-string">'softmax'</span>, <span class="cm-variable">kernel_initializer</span> <span class="cm-operator">=</span> <span class="cm-variable">glorot_uniform</span>(<span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">0</span>))(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># Create model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">Model</span>(<span class="cm-variable">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">X_input</span>, <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">model</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 1201px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1236px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Run the following code to build the model's graph. If your implementation is incorrect, you'll know it by checking your accuracy when running <span class="cm-comment">`model.fit(...)`</span> below.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 80px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>Run the following code to build the model's graph. If your implementation is incorrect, you'll know it by checking your accuracy when running <code>model.fit(...)</code> below.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[54]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 479.172px; margin-bottom: -15px; border-right-width: 35px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">ResNet50</span>(<span class="cm-variable">input_shape</span> <span class="cm-operator">=</span> (<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">3</span>), <span class="cm-variable">classes</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">model</span>.<span class="cm-property">summary</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 80px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to unscroll output; double click to hide"></div><div class="output output_scroll"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Model: "functional_29"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_15 (InputLayer)           [(None, 64, 64, 3)]  0                                            
__________________________________________________________________________________________________
zero_padding2d_14 (ZeroPadding2 (None, 70, 70, 3)    0           input_15[0][0]                   
__________________________________________________________________________________________________
conv2d_827 (Conv2D)             (None, 32, 32, 64)   9472        zero_padding2d_14[0][0]          
__________________________________________________________________________________________________
batch_normalization_827 (BatchN (None, 32, 32, 64)   256         conv2d_827[0][0]                 
__________________________________________________________________________________________________
activation_759 (Activation)     (None, 32, 32, 64)   0           batch_normalization_827[0][0]    
__________________________________________________________________________________________________
max_pooling2d_14 (MaxPooling2D) (None, 15, 15, 64)   0           activation_759[0][0]             
__________________________________________________________________________________________________
conv2d_828 (Conv2D)             (None, 15, 15, 64)   4160        max_pooling2d_14[0][0]           
__________________________________________________________________________________________________
batch_normalization_828 (BatchN (None, 15, 15, 64)   256         conv2d_828[0][0]                 
__________________________________________________________________________________________________
activation_760 (Activation)     (None, 15, 15, 64)   0           batch_normalization_828[0][0]    
__________________________________________________________________________________________________
conv2d_829 (Conv2D)             (None, 15, 15, 64)   36928       activation_760[0][0]             
__________________________________________________________________________________________________
batch_normalization_829 (BatchN (None, 15, 15, 64)   256         conv2d_829[0][0]                 
__________________________________________________________________________________________________
activation_761 (Activation)     (None, 15, 15, 64)   0           batch_normalization_829[0][0]    
__________________________________________________________________________________________________
conv2d_830 (Conv2D)             (None, 15, 15, 256)  16640       activation_761[0][0]             
__________________________________________________________________________________________________
conv2d_831 (Conv2D)             (None, 15, 15, 256)  16640       max_pooling2d_14[0][0]           
__________________________________________________________________________________________________
batch_normalization_830 (BatchN (None, 15, 15, 256)  1024        conv2d_830[0][0]                 
__________________________________________________________________________________________________
batch_normalization_831 (BatchN (None, 15, 15, 256)  1024        conv2d_831[0][0]                 
__________________________________________________________________________________________________
add_100 (Add)                   (None, 15, 15, 256)  0           batch_normalization_830[0][0]    
                                                                 batch_normalization_831[0][0]    
__________________________________________________________________________________________________
activation_762 (Activation)     (None, 15, 15, 256)  0           add_100[0][0]                    
__________________________________________________________________________________________________
conv2d_832 (Conv2D)             (None, 15, 15, 64)   16448       activation_762[0][0]             
__________________________________________________________________________________________________
batch_normalization_832 (BatchN (None, 15, 15, 64)   256         conv2d_832[0][0]                 
__________________________________________________________________________________________________
activation_763 (Activation)     (None, 15, 15, 64)   0           batch_normalization_832[0][0]    
__________________________________________________________________________________________________
conv2d_833 (Conv2D)             (None, 15, 15, 64)   36928       activation_763[0][0]             
__________________________________________________________________________________________________
batch_normalization_833 (BatchN (None, 15, 15, 64)   256         conv2d_833[0][0]                 
__________________________________________________________________________________________________
activation_764 (Activation)     (None, 15, 15, 64)   0           batch_normalization_833[0][0]    
__________________________________________________________________________________________________
conv2d_834 (Conv2D)             (None, 15, 15, 256)  16640       activation_764[0][0]             
__________________________________________________________________________________________________
batch_normalization_834 (BatchN (None, 15, 15, 256)  1024        conv2d_834[0][0]                 
__________________________________________________________________________________________________
add_101 (Add)                   (None, 15, 15, 256)  0           batch_normalization_834[0][0]    
                                                                 activation_762[0][0]             
__________________________________________________________________________________________________
activation_765 (Activation)     (None, 15, 15, 256)  0           add_101[0][0]                    
__________________________________________________________________________________________________
conv2d_835 (Conv2D)             (None, 15, 15, 64)   16448       activation_765[0][0]             
__________________________________________________________________________________________________
batch_normalization_835 (BatchN (None, 15, 15, 64)   256         conv2d_835[0][0]                 
__________________________________________________________________________________________________
activation_766 (Activation)     (None, 15, 15, 64)   0           batch_normalization_835[0][0]    
__________________________________________________________________________________________________
conv2d_836 (Conv2D)             (None, 15, 15, 64)   36928       activation_766[0][0]             
__________________________________________________________________________________________________
batch_normalization_836 (BatchN (None, 15, 15, 64)   256         conv2d_836[0][0]                 
__________________________________________________________________________________________________
activation_767 (Activation)     (None, 15, 15, 64)   0           batch_normalization_836[0][0]    
__________________________________________________________________________________________________
conv2d_837 (Conv2D)             (None, 15, 15, 256)  16640       activation_767[0][0]             
__________________________________________________________________________________________________
batch_normalization_837 (BatchN (None, 15, 15, 256)  1024        conv2d_837[0][0]                 
__________________________________________________________________________________________________
add_102 (Add)                   (None, 15, 15, 256)  0           batch_normalization_837[0][0]    
                                                                 activation_765[0][0]             
__________________________________________________________________________________________________
activation_768 (Activation)     (None, 15, 15, 256)  0           add_102[0][0]                    
__________________________________________________________________________________________________
conv2d_838 (Conv2D)             (None, 8, 8, 128)    32896       activation_768[0][0]             
__________________________________________________________________________________________________
batch_normalization_838 (BatchN (None, 8, 8, 128)    512         conv2d_838[0][0]                 
__________________________________________________________________________________________________
activation_769 (Activation)     (None, 8, 8, 128)    0           batch_normalization_838[0][0]    
__________________________________________________________________________________________________
conv2d_839 (Conv2D)             (None, 8, 8, 128)    147584      activation_769[0][0]             
__________________________________________________________________________________________________
batch_normalization_839 (BatchN (None, 8, 8, 128)    512         conv2d_839[0][0]                 
__________________________________________________________________________________________________
activation_770 (Activation)     (None, 8, 8, 128)    0           batch_normalization_839[0][0]    
__________________________________________________________________________________________________
conv2d_840 (Conv2D)             (None, 8, 8, 512)    66048       activation_770[0][0]             
__________________________________________________________________________________________________
conv2d_841 (Conv2D)             (None, 8, 8, 512)    131584      activation_768[0][0]             
__________________________________________________________________________________________________
batch_normalization_840 (BatchN (None, 8, 8, 512)    2048        conv2d_840[0][0]                 
__________________________________________________________________________________________________
batch_normalization_841 (BatchN (None, 8, 8, 512)    2048        conv2d_841[0][0]                 
__________________________________________________________________________________________________
add_103 (Add)                   (None, 8, 8, 512)    0           batch_normalization_840[0][0]    
                                                                 batch_normalization_841[0][0]    
__________________________________________________________________________________________________
activation_771 (Activation)     (None, 8, 8, 512)    0           add_103[0][0]                    
__________________________________________________________________________________________________
conv2d_842 (Conv2D)             (None, 8, 8, 128)    65664       activation_771[0][0]             
__________________________________________________________________________________________________
batch_normalization_842 (BatchN (None, 8, 8, 128)    512         conv2d_842[0][0]                 
__________________________________________________________________________________________________
activation_772 (Activation)     (None, 8, 8, 128)    0           batch_normalization_842[0][0]    
__________________________________________________________________________________________________
conv2d_843 (Conv2D)             (None, 8, 8, 128)    147584      activation_772[0][0]             
__________________________________________________________________________________________________
batch_normalization_843 (BatchN (None, 8, 8, 128)    512         conv2d_843[0][0]                 
__________________________________________________________________________________________________
activation_773 (Activation)     (None, 8, 8, 128)    0           batch_normalization_843[0][0]    
__________________________________________________________________________________________________
conv2d_844 (Conv2D)             (None, 8, 8, 512)    66048       activation_773[0][0]             
__________________________________________________________________________________________________
batch_normalization_844 (BatchN (None, 8, 8, 512)    2048        conv2d_844[0][0]                 
__________________________________________________________________________________________________
add_104 (Add)                   (None, 8, 8, 512)    0           batch_normalization_844[0][0]    
                                                                 activation_771[0][0]             
__________________________________________________________________________________________________
activation_774 (Activation)     (None, 8, 8, 512)    0           add_104[0][0]                    
__________________________________________________________________________________________________
conv2d_845 (Conv2D)             (None, 8, 8, 128)    65664       activation_774[0][0]             
__________________________________________________________________________________________________
batch_normalization_845 (BatchN (None, 8, 8, 128)    512         conv2d_845[0][0]                 
__________________________________________________________________________________________________
activation_775 (Activation)     (None, 8, 8, 128)    0           batch_normalization_845[0][0]    
__________________________________________________________________________________________________
conv2d_846 (Conv2D)             (None, 8, 8, 128)    147584      activation_775[0][0]             
__________________________________________________________________________________________________
batch_normalization_846 (BatchN (None, 8, 8, 128)    512         conv2d_846[0][0]                 
__________________________________________________________________________________________________
activation_776 (Activation)     (None, 8, 8, 128)    0           batch_normalization_846[0][0]    
__________________________________________________________________________________________________
conv2d_847 (Conv2D)             (None, 8, 8, 512)    66048       activation_776[0][0]             
__________________________________________________________________________________________________
batch_normalization_847 (BatchN (None, 8, 8, 512)    2048        conv2d_847[0][0]                 
__________________________________________________________________________________________________
add_105 (Add)                   (None, 8, 8, 512)    0           batch_normalization_847[0][0]    
                                                                 activation_774[0][0]             
__________________________________________________________________________________________________
activation_777 (Activation)     (None, 8, 8, 512)    0           add_105[0][0]                    
__________________________________________________________________________________________________
conv2d_848 (Conv2D)             (None, 8, 8, 128)    65664       activation_777[0][0]             
__________________________________________________________________________________________________
batch_normalization_848 (BatchN (None, 8, 8, 128)    512         conv2d_848[0][0]                 
__________________________________________________________________________________________________
activation_778 (Activation)     (None, 8, 8, 128)    0           batch_normalization_848[0][0]    
__________________________________________________________________________________________________
conv2d_849 (Conv2D)             (None, 8, 8, 128)    147584      activation_778[0][0]             
__________________________________________________________________________________________________
batch_normalization_849 (BatchN (None, 8, 8, 128)    512         conv2d_849[0][0]                 
__________________________________________________________________________________________________
activation_779 (Activation)     (None, 8, 8, 128)    0           batch_normalization_849[0][0]    
__________________________________________________________________________________________________
conv2d_850 (Conv2D)             (None, 8, 8, 512)    66048       activation_779[0][0]             
__________________________________________________________________________________________________
batch_normalization_850 (BatchN (None, 8, 8, 512)    2048        conv2d_850[0][0]                 
__________________________________________________________________________________________________
add_106 (Add)                   (None, 8, 8, 512)    0           batch_normalization_850[0][0]    
                                                                 activation_777[0][0]             
__________________________________________________________________________________________________
activation_780 (Activation)     (None, 8, 8, 512)    0           add_106[0][0]                    
__________________________________________________________________________________________________
conv2d_851 (Conv2D)             (None, 4, 4, 256)    131328      activation_780[0][0]             
__________________________________________________________________________________________________
batch_normalization_851 (BatchN (None, 4, 4, 256)    1024        conv2d_851[0][0]                 
__________________________________________________________________________________________________
activation_781 (Activation)     (None, 4, 4, 256)    0           batch_normalization_851[0][0]    
__________________________________________________________________________________________________
conv2d_852 (Conv2D)             (None, 4, 4, 256)    590080      activation_781[0][0]             
__________________________________________________________________________________________________
batch_normalization_852 (BatchN (None, 4, 4, 256)    1024        conv2d_852[0][0]                 
__________________________________________________________________________________________________
activation_782 (Activation)     (None, 4, 4, 256)    0           batch_normalization_852[0][0]    
__________________________________________________________________________________________________
conv2d_853 (Conv2D)             (None, 4, 4, 1024)   263168      activation_782[0][0]             
__________________________________________________________________________________________________
conv2d_854 (Conv2D)             (None, 4, 4, 1024)   525312      activation_780[0][0]             
__________________________________________________________________________________________________
batch_normalization_853 (BatchN (None, 4, 4, 1024)   4096        conv2d_853[0][0]                 
__________________________________________________________________________________________________
batch_normalization_854 (BatchN (None, 4, 4, 1024)   4096        conv2d_854[0][0]                 
__________________________________________________________________________________________________
add_107 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_853[0][0]    
                                                                 batch_normalization_854[0][0]    
__________________________________________________________________________________________________
activation_783 (Activation)     (None, 4, 4, 1024)   0           add_107[0][0]                    
__________________________________________________________________________________________________
conv2d_855 (Conv2D)             (None, 4, 4, 256)    262400      activation_783[0][0]             
__________________________________________________________________________________________________
batch_normalization_855 (BatchN (None, 4, 4, 256)    1024        conv2d_855[0][0]                 
__________________________________________________________________________________________________
activation_784 (Activation)     (None, 4, 4, 256)    0           batch_normalization_855[0][0]    
__________________________________________________________________________________________________
conv2d_856 (Conv2D)             (None, 4, 4, 256)    590080      activation_784[0][0]             
__________________________________________________________________________________________________
batch_normalization_856 (BatchN (None, 4, 4, 256)    1024        conv2d_856[0][0]                 
__________________________________________________________________________________________________
activation_785 (Activation)     (None, 4, 4, 256)    0           batch_normalization_856[0][0]    
__________________________________________________________________________________________________
conv2d_857 (Conv2D)             (None, 4, 4, 1024)   263168      activation_785[0][0]             
__________________________________________________________________________________________________
batch_normalization_857 (BatchN (None, 4, 4, 1024)   4096        conv2d_857[0][0]                 
__________________________________________________________________________________________________
add_108 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_857[0][0]    
                                                                 activation_783[0][0]             
__________________________________________________________________________________________________
activation_786 (Activation)     (None, 4, 4, 1024)   0           add_108[0][0]                    
__________________________________________________________________________________________________
conv2d_858 (Conv2D)             (None, 4, 4, 256)    262400      activation_786[0][0]             
__________________________________________________________________________________________________
batch_normalization_858 (BatchN (None, 4, 4, 256)    1024        conv2d_858[0][0]                 
__________________________________________________________________________________________________
activation_787 (Activation)     (None, 4, 4, 256)    0           batch_normalization_858[0][0]    
__________________________________________________________________________________________________
conv2d_859 (Conv2D)             (None, 4, 4, 256)    590080      activation_787[0][0]             
__________________________________________________________________________________________________
batch_normalization_859 (BatchN (None, 4, 4, 256)    1024        conv2d_859[0][0]                 
__________________________________________________________________________________________________
activation_788 (Activation)     (None, 4, 4, 256)    0           batch_normalization_859[0][0]    
__________________________________________________________________________________________________
conv2d_860 (Conv2D)             (None, 4, 4, 1024)   263168      activation_788[0][0]             
__________________________________________________________________________________________________
batch_normalization_860 (BatchN (None, 4, 4, 1024)   4096        conv2d_860[0][0]                 
__________________________________________________________________________________________________
add_109 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_860[0][0]    
                                                                 activation_786[0][0]             
__________________________________________________________________________________________________
activation_789 (Activation)     (None, 4, 4, 1024)   0           add_109[0][0]                    
__________________________________________________________________________________________________
conv2d_861 (Conv2D)             (None, 4, 4, 256)    262400      activation_789[0][0]             
__________________________________________________________________________________________________
batch_normalization_861 (BatchN (None, 4, 4, 256)    1024        conv2d_861[0][0]                 
__________________________________________________________________________________________________
activation_790 (Activation)     (None, 4, 4, 256)    0           batch_normalization_861[0][0]    
__________________________________________________________________________________________________
conv2d_862 (Conv2D)             (None, 4, 4, 256)    590080      activation_790[0][0]             
__________________________________________________________________________________________________
batch_normalization_862 (BatchN (None, 4, 4, 256)    1024        conv2d_862[0][0]                 
__________________________________________________________________________________________________
activation_791 (Activation)     (None, 4, 4, 256)    0           batch_normalization_862[0][0]    
__________________________________________________________________________________________________
conv2d_863 (Conv2D)             (None, 4, 4, 1024)   263168      activation_791[0][0]             
__________________________________________________________________________________________________
batch_normalization_863 (BatchN (None, 4, 4, 1024)   4096        conv2d_863[0][0]                 
__________________________________________________________________________________________________
add_110 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_863[0][0]    
                                                                 activation_789[0][0]             
__________________________________________________________________________________________________
activation_792 (Activation)     (None, 4, 4, 1024)   0           add_110[0][0]                    
__________________________________________________________________________________________________
conv2d_864 (Conv2D)             (None, 4, 4, 256)    262400      activation_792[0][0]             
__________________________________________________________________________________________________
batch_normalization_864 (BatchN (None, 4, 4, 256)    1024        conv2d_864[0][0]                 
__________________________________________________________________________________________________
activation_793 (Activation)     (None, 4, 4, 256)    0           batch_normalization_864[0][0]    
__________________________________________________________________________________________________
conv2d_865 (Conv2D)             (None, 4, 4, 256)    590080      activation_793[0][0]             
__________________________________________________________________________________________________
batch_normalization_865 (BatchN (None, 4, 4, 256)    1024        conv2d_865[0][0]                 
__________________________________________________________________________________________________
activation_794 (Activation)     (None, 4, 4, 256)    0           batch_normalization_865[0][0]    
__________________________________________________________________________________________________
conv2d_866 (Conv2D)             (None, 4, 4, 1024)   263168      activation_794[0][0]             
__________________________________________________________________________________________________
batch_normalization_866 (BatchN (None, 4, 4, 1024)   4096        conv2d_866[0][0]                 
__________________________________________________________________________________________________
add_111 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_866[0][0]    
                                                                 activation_792[0][0]             
__________________________________________________________________________________________________
activation_795 (Activation)     (None, 4, 4, 1024)   0           add_111[0][0]                    
__________________________________________________________________________________________________
conv2d_867 (Conv2D)             (None, 4, 4, 256)    262400      activation_795[0][0]             
__________________________________________________________________________________________________
batch_normalization_867 (BatchN (None, 4, 4, 256)    1024        conv2d_867[0][0]                 
__________________________________________________________________________________________________
activation_796 (Activation)     (None, 4, 4, 256)    0           batch_normalization_867[0][0]    
__________________________________________________________________________________________________
conv2d_868 (Conv2D)             (None, 4, 4, 256)    590080      activation_796[0][0]             
__________________________________________________________________________________________________
batch_normalization_868 (BatchN (None, 4, 4, 256)    1024        conv2d_868[0][0]                 
__________________________________________________________________________________________________
activation_797 (Activation)     (None, 4, 4, 256)    0           batch_normalization_868[0][0]    
__________________________________________________________________________________________________
conv2d_869 (Conv2D)             (None, 4, 4, 1024)   263168      activation_797[0][0]             
__________________________________________________________________________________________________
batch_normalization_869 (BatchN (None, 4, 4, 1024)   4096        conv2d_869[0][0]                 
__________________________________________________________________________________________________
add_112 (Add)                   (None, 4, 4, 1024)   0           batch_normalization_869[0][0]    
                                                                 activation_795[0][0]             
__________________________________________________________________________________________________
activation_798 (Activation)     (None, 4, 4, 1024)   0           add_112[0][0]                    
__________________________________________________________________________________________________
conv2d_870 (Conv2D)             (None, 2, 2, 512)    524800      activation_798[0][0]             
__________________________________________________________________________________________________
batch_normalization_870 (BatchN (None, 2, 2, 512)    2048        conv2d_870[0][0]                 
__________________________________________________________________________________________________
activation_799 (Activation)     (None, 2, 2, 512)    0           batch_normalization_870[0][0]    
__________________________________________________________________________________________________
conv2d_871 (Conv2D)             (None, 2, 2, 512)    2359808     activation_799[0][0]             
__________________________________________________________________________________________________
batch_normalization_871 (BatchN (None, 2, 2, 512)    2048        conv2d_871[0][0]                 
__________________________________________________________________________________________________
activation_800 (Activation)     (None, 2, 2, 512)    0           batch_normalization_871[0][0]    
__________________________________________________________________________________________________
conv2d_872 (Conv2D)             (None, 2, 2, 2048)   1050624     activation_800[0][0]             
__________________________________________________________________________________________________
conv2d_873 (Conv2D)             (None, 2, 2, 2048)   2099200     activation_798[0][0]             
__________________________________________________________________________________________________
batch_normalization_872 (BatchN (None, 2, 2, 2048)   8192        conv2d_872[0][0]                 
__________________________________________________________________________________________________
batch_normalization_873 (BatchN (None, 2, 2, 2048)   8192        conv2d_873[0][0]                 
__________________________________________________________________________________________________
add_113 (Add)                   (None, 2, 2, 2048)   0           batch_normalization_872[0][0]    
                                                                 batch_normalization_873[0][0]    
__________________________________________________________________________________________________
activation_801 (Activation)     (None, 2, 2, 2048)   0           add_113[0][0]                    
__________________________________________________________________________________________________
conv2d_874 (Conv2D)             (None, 2, 2, 512)    1049088     activation_801[0][0]             
__________________________________________________________________________________________________
batch_normalization_874 (BatchN (None, 2, 2, 512)    2048        conv2d_874[0][0]                 
__________________________________________________________________________________________________
activation_802 (Activation)     (None, 2, 2, 512)    0           batch_normalization_874[0][0]    
__________________________________________________________________________________________________
conv2d_875 (Conv2D)             (None, 2, 2, 512)    2359808     activation_802[0][0]             
__________________________________________________________________________________________________
batch_normalization_875 (BatchN (None, 2, 2, 512)    2048        conv2d_875[0][0]                 
__________________________________________________________________________________________________
activation_803 (Activation)     (None, 2, 2, 512)    0           batch_normalization_875[0][0]    
__________________________________________________________________________________________________
conv2d_876 (Conv2D)             (None, 2, 2, 2048)   1050624     activation_803[0][0]             
__________________________________________________________________________________________________
batch_normalization_876 (BatchN (None, 2, 2, 2048)   8192        conv2d_876[0][0]                 
__________________________________________________________________________________________________
add_114 (Add)                   (None, 2, 2, 2048)   0           batch_normalization_876[0][0]    
                                                                 activation_801[0][0]             
__________________________________________________________________________________________________
activation_804 (Activation)     (None, 2, 2, 2048)   0           add_114[0][0]                    
__________________________________________________________________________________________________
conv2d_877 (Conv2D)             (None, 2, 2, 512)    1049088     activation_804[0][0]             
__________________________________________________________________________________________________
batch_normalization_877 (BatchN (None, 2, 2, 512)    2048        conv2d_877[0][0]                 
__________________________________________________________________________________________________
activation_805 (Activation)     (None, 2, 2, 512)    0           batch_normalization_877[0][0]    
__________________________________________________________________________________________________
conv2d_878 (Conv2D)             (None, 2, 2, 512)    2359808     activation_805[0][0]             
__________________________________________________________________________________________________
batch_normalization_878 (BatchN (None, 2, 2, 512)    2048        conv2d_878[0][0]                 
__________________________________________________________________________________________________
activation_806 (Activation)     (None, 2, 2, 512)    0           batch_normalization_878[0][0]    
__________________________________________________________________________________________________
conv2d_879 (Conv2D)             (None, 2, 2, 2048)   1050624     activation_806[0][0]             
__________________________________________________________________________________________________
batch_normalization_879 (BatchN (None, 2, 2, 2048)   8192        conv2d_879[0][0]                 
__________________________________________________________________________________________________
add_115 (Add)                   (None, 2, 2, 2048)   0           batch_normalization_879[0][0]    
                                                                 activation_804[0][0]             
__________________________________________________________________________________________________
activation_807 (Activation)     (None, 2, 2, 2048)   0           add_115[0][0]                    
__________________________________________________________________________________________________
average_pooling2d_14 (AveragePo (None, 1, 1, 2048)   0           activation_807[0][0]             
__________________________________________________________________________________________________
flatten_14 (Flatten)            (None, 2048)         0           average_pooling2d_14[0][0]       
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 6)            12294       flatten_14[0][0]                 
==================================================================================================
Total params: 23,600,006
Trainable params: 23,546,886
Non-trainable params: 53,120
__________________________________________________________________________________________________
None
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[56]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.5938px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 479.172px; margin-bottom: -15px; border-right-width: 35px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 4px; top: 85px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">outputs</span> <span class="cm-keyword">import</span> <span class="cm-variable">ResNet50_summary</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">ResNet50</span>(<span class="cm-variable">input_shape</span> <span class="cm-operator">=</span> (<span class="cm-number">64</span>, <span class="cm-number">64</span>, <span class="cm-number">3</span>), <span class="cm-variable">classes</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">comparator</span>(<span class="cm-variable">summary</span>(<span class="cm-variable">model</span>), <span class="cm-variable">ResNet50_summary</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre><span class="ansi-green-fg">All tests passed!</span>
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">As shown in the Keras Tutorial Notebook, prior to training a model, you need to configure the learning process by compiling the model.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 80px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>As shown in the Keras Tutorial Notebook, prior to training a model, you need to configure the learning process by compiling the model.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[57]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 732px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">compile</span>(<span class="cm-variable">optimizer</span><span class="cm-operator">=</span><span class="cm-string">'adam'</span>, <span class="cm-variable">loss</span><span class="cm-operator">=</span><span class="cm-string">'categorical_crossentropy'</span>, <span class="cm-variable">metrics</span><span class="cm-operator">=</span>[<span class="cm-string">'accuracy'</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The model is now ready to be trained. The only thing you need now is a dataset!</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>The model is now ready to be trained. The only thing you need now is a dataset!</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Let's load your old friend, the SIGNS dataset.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"images/signs_data_kiank.png"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:450px;height:250px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">caption</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">center</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">u</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Figure 6<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">u</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span>=<span class="cm-string">'purple'</span><span class="cm-tag cm-bracket">&gt;</span>  : <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>SIGNS dataset<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">center</span><span class="cm-tag cm-bracket cm-error">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag cm-error">caption</span><span class="cm-tag cm-bracket cm-error">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>Let's load your old friend, the SIGNS dataset.</p>
<img src="./signs_data_kiank.png" style="width: 450px ; height: 250px">
<center> <u> <font color="purple"> <b>Figure 6</b> </font></u><font color="purple">  : <b>SIGNS dataset</b> </font></center>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[58]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5938px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 664.531px; margin-bottom: -15px; border-right-width: 35px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 4px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_train_orig</span>, <span class="cm-variable">Y_train_orig</span>, <span class="cm-variable">X_test_orig</span>, <span class="cm-variable">Y_test_orig</span>, <span class="cm-variable">classes</span> <span class="cm-operator">=</span> <span class="cm-variable">load_dataset</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Normalize image vectors</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_train</span> <span class="cm-operator">=</span> <span class="cm-variable">X_train_orig</span> <span class="cm-operator">/</span> <span class="cm-number">255.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X_test</span> <span class="cm-operator">=</span> <span class="cm-variable">X_test_orig</span> <span class="cm-operator">/</span> <span class="cm-number">255.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Convert training and test labels to one hot matrices</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Y_train</span> <span class="cm-operator">=</span> <span class="cm-variable">convert_to_one_hot</span>(<span class="cm-variable">Y_train_orig</span>, <span class="cm-number">6</span>).<span class="cm-property">T</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Y_test</span> <span class="cm-operator">=</span> <span class="cm-variable">convert_to_one_hot</span>(<span class="cm-variable">Y_test_orig</span>, <span class="cm-number">6</span>).<span class="cm-property">T</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"number of training examples = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_train</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"number of test examples = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_test</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"X_train shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_train</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Y_train shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">Y_train</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"X_test shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">X_test</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Y_test shape: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">Y_test</span>.<span class="cm-property">shape</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 318px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>number of training examples = 1080
number of test examples = 120
X_train shape: (1080, 64, 64, 3)
Y_train shape: (1080, 6)
X_test shape: (120, 64, 64, 3)
Y_test shape: (120, 6)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Run the following cell to train your model on 10 epochs with a batch size of 32. On a GPU, it should take less than 2 minutes. </span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 80px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>Run the following cell to train your model on 10 epochs with a batch size of 32. On a GPU, it should take less than 2 minutes. </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[59]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 197.906px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 487.594px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 197.906px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">Y_train</span>, <span class="cm-variable">epochs</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>, <span class="cm-variable">batch_size</span> <span class="cm-operator">=</span> <span class="cm-number">32</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Epoch 1/10
34/34 [==============================] - 1s 25ms/step - loss: 1.9451 - accuracy: 0.4815
Epoch 2/10
34/34 [==============================] - 1s 24ms/step - loss: 0.9733 - accuracy: 0.6806
Epoch 3/10
34/34 [==============================] - 1s 23ms/step - loss: 0.4787 - accuracy: 0.8407
Epoch 4/10
34/34 [==============================] - 1s 23ms/step - loss: 0.3216 - accuracy: 0.8880
Epoch 5/10
34/34 [==============================] - 1s 23ms/step - loss: 0.1430 - accuracy: 0.9630
Epoch 6/10
34/34 [==============================] - 1s 23ms/step - loss: 0.2122 - accuracy: 0.9324
Epoch 7/10
34/34 [==============================] - 1s 24ms/step - loss: 0.3528 - accuracy: 0.8981
Epoch 8/10
34/34 [==============================] - 1s 24ms/step - loss: 0.5785 - accuracy: 0.8324
Epoch 9/10
34/34 [==============================] - 1s 23ms/step - loss: 0.4982 - accuracy: 0.8731
Epoch 10/10
34/34 [==============================] - 1s 24ms/step - loss: 0.3476 - accuracy: 0.8935
</pre></div></div><div class="output_area"><div class="run_this_cell"></div><div class="prompt output_prompt"><bdi>Out[59]:</bdi></div><div class="output_subarea output_text output_result" dir="auto"><pre>&lt;tensorflow.python.keras.callbacks.History at 0x7f0df41b6e80&gt;</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 470px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 1/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 1s 34ms/step - loss: 1.9241 - accuracy: 0.4620</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 2/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 57ms/step - loss: 0.6403 - accuracy: 0.7898</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 3/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 1s 24ms/step - loss: 0.3744 - accuracy: 0.8731</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 4/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 44ms/step - loss: 0.2220 - accuracy: 0.9231</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 5/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 57ms/step - loss: 0.1333 - accuracy: 0.9583</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 6/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 52ms/step - loss: 0.2243 - accuracy: 0.9444</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 7/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 48ms/step - loss: 0.2913 - accuracy: 0.9102</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 8/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 1s 30ms/step - loss: 0.2269 - accuracy: 0.9306</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 9/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 46ms/step - loss: 0.1113 - accuracy: 0.9630</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">Epoch 10/10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">34/34 [==============================] - 2s 57ms/step - loss: 0.0709 - accuracy: 0.9778</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">The exact values could not match, but don't worry about that. The important thing that you must see is that the loss value decreases, and the accuracy increases for the firsts 5 epochs.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 470px;"></div><div class="CodeMirror-gutters" style="display: none; height: 505px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><strong>Expected Output</strong>:</p>
<pre><code>Epoch 1/10
34/34 [==============================] - 1s 34ms/step - loss: 1.9241 - accuracy: 0.4620
Epoch 2/10
34/34 [==============================] - 2s 57ms/step - loss: 0.6403 - accuracy: 0.7898
Epoch 3/10
34/34 [==============================] - 1s 24ms/step - loss: 0.3744 - accuracy: 0.8731
Epoch 4/10
34/34 [==============================] - 2s 44ms/step - loss: 0.2220 - accuracy: 0.9231
Epoch 5/10
34/34 [==============================] - 2s 57ms/step - loss: 0.1333 - accuracy: 0.9583
Epoch 6/10
34/34 [==============================] - 2s 52ms/step - loss: 0.2243 - accuracy: 0.9444
Epoch 7/10
34/34 [==============================] - 2s 48ms/step - loss: 0.2913 - accuracy: 0.9102
Epoch 8/10
34/34 [==============================] - 1s 30ms/step - loss: 0.2269 - accuracy: 0.9306
Epoch 9/10
34/34 [==============================] - 2s 46ms/step - loss: 0.1113 - accuracy: 0.9630
Epoch 10/10
34/34 [==============================] - 2s 57ms/step - loss: 0.0709 - accuracy: 0.9778</code></pre><p>The exact values could not match, but don't worry about that. The important thing that you must see is that the loss value decreases, and the accuracy increases for the firsts 5 epochs.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Let's see how this model (trained on only two epochs) performs on the test set.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>Let's see how this model (trained on only two epochs) performs on the test set.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[60]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5938px; left: 282.25px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 361.109px; margin-bottom: -15px; border-right-width: 35px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 282.25px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">preds</span> <span class="cm-operator">=</span> <span class="cm-variable">model</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">X_test</span>, <span class="cm-variable">Y_test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Loss = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Test Accuracy = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">1</span>]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>4/4 [==============================] - 0s 8ms/step - loss: 0.4264 - accuracy: 0.9083
Loss = 0.4264197051525116
Test Accuracy = 0.9083333611488342
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 232px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**Expected Output**</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span>Test Accuracy<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &gt;0.80</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 232px;"></div><div class="CodeMirror-gutters" style="display: none; height: 267px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><strong>Expected Output</strong>:</p>
<table>
    <tbody><tr>
        <td>
            <b>Test Accuracy</b>
        </td>
        <td>
           &gt;0.80
        </td>
    </tr>

</tbody></table></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">For the purposes of this assignment, you've been asked to train the model for just two epochs. You can see that it performs pretty poorly, but that's ok! The online grader will only run your code for a small number of epochs as well. Please go ahead and submit your assignment as is. </span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>For the purposes of this assignment, you've been asked to train the model for just two epochs. You can see that it performs pretty poorly, but that's ok! The online grader will only run your code for a small number of epochs as well. Please go ahead and submit your assignment as is. </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">After you have finished this official (graded) part of this assignment, you can also optionally train the ResNet for more iterations, if you want. It tends to get much better performance when trained for ~20 epochs, but this does take more than an hour when training on a CPU. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Using a GPU, this ResNet50 model's weights were trained on the SIGNS dataset. You can load and run the trained model on the test set in the cells below. It may take ≈1min to load the model. Have fun! </span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>After you have finished this official (graded) part of this assignment, you can also optionally train the ResNet for more iterations, if you want. It tends to get much better performance when trained for ~20 epochs, but this does take more than an hour when training on a CPU. </p>
<p>Using a GPU, this ResNet50 model's weights were trained on the SIGNS dataset. You can load and run the trained model on the test set in the cells below. It may take ≈1min to load the model. Have fun! </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[61]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 492.953px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 521.266px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 492.953px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pre_trained_model</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">models</span>.<span class="cm-property">load_model</span>(<span class="cm-string">'resnet50.h5'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[62]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 358.109px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 428.531px; margin-bottom: -15px; border-right-width: 35px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 358.109px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">preds</span> <span class="cm-operator">=</span> <span class="cm-variable">pre_trained_model</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">X_test</span>, <span class="cm-variable">Y_test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Loss = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"Test Accuracy = "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">preds</span>[<span class="cm-number">1</span>]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 97px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>4/4 [==============================] - 0s 7ms/step - loss: 0.1596 - accuracy: 0.9500
Loss = 0.15958674252033234
Test Accuracy = 0.949999988079071
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 113px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**Congratulations**</span> on finishing this assignment! You've now implemented a state-of-the-art image classification system! Woo hoo! </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ResNet50 is a powerful model for image classification when it's trained for an adequate number of iterations. Hopefully, from this point, you can use what you've learned and apply it to your own classification problem to perform state-of-the-art accuracy.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 148px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><strong>Congratulations</strong> on finishing this assignment! You've now implemented a state-of-the-art image classification system! Woo hoo! </p>
<p>ResNet50 is a powerful model for image classification when it's trained for an adequate number of iterations. Hopefully, from this point, you can use what you've learned and apply it to your own classification problem to perform state-of-the-art accuracy.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 164px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">font</span> <span class="cm-attribute">color</span> = <span class="cm-string">'blue'</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">**What you should remember**:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Very deep "plain" networks don't work in practice because vanishing gradients make them hard to train. &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Skip connections help address the Vanishing Gradient problem. They also make it easy for a ResNet block to learn an identity function. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- There are two main types of blocks: The **identity block** and the **convolutional block**. </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- Very deep Residual Networks are built by stacking these blocks together.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 199px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><font color="blue">

<p><strong>What you should remember</strong>:</p>
<ul>
<li>Very deep "plain" networks don't work in practice because vanishing gradients make them hard to train.  </li>
<li>Skip connections help address the Vanishing Gradient problem. They also make it easy for a ResNet block to learn an identity function. </li>
<li>There are two main types of blocks: The <strong>identity block</strong> and the <strong>convolutional block</strong>. </li>
<li>Very deep Residual Networks are built by stacking these blocks together.</li>
</ul>
</font></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 48px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'5'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 5 - Test on Your Own Image (Optional/Ungraded)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 48px;"></div><div class="CodeMirror-gutters" style="display: none; height: 83px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="5"></a>  </p>
<h2 id="5---Test-on-Your-Own-Image-(Optional/Ungraded)">5 - Test on Your Own Image (Optional/Ungraded)<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#5---Test-on-Your-Own-Image-(Optional/Ungraded)">¶</a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">If you wish, you can also take a picture of your own hand and see the output of the model. To do this:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  1. Click on "File" in the upper bar of this notebook, then click "Open" to go on your Coursera Hub.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  2. Add your image to this Jupyter Notebook's directory, in the "images" folder</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  3. Write your image's name in the following code</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  4. Run the code and check if the algorithm is right! </span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 131px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>If you wish, you can also take a picture of your own hand and see the output of the model. To do this:
    1. Click on "File" in the upper bar of this notebook, then click "Open" to go on your Coursera Hub.
    2. Add your image to this Jupyter Notebook's directory, in the "images" folder
    3. Write your image's name in the following code
    4. Run the code and check if the algorithm is right! </p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[63]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.5938px; left: 96.7812px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 715.062px; margin-bottom: -15px; border-right-width: 35px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 96.7812px; top: 68px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">img_path</span> <span class="cm-operator">=</span> <span class="cm-string">'images/my_image.jpg'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">img</span> <span class="cm-operator">=</span> <span class="cm-variable">image</span>.<span class="cm-property">load_img</span>(<span class="cm-variable">img_path</span>, <span class="cm-variable">target_size</span><span class="cm-operator">=</span>(<span class="cm-number">64</span>, <span class="cm-number">64</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">image</span>.<span class="cm-property">img_to_array</span>(<span class="cm-variable">img</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">expand_dims</span>(<span class="cm-variable">x</span>, <span class="cm-variable">axis</span><span class="cm-operator">=</span><span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span><span class="cm-operator">/</span><span class="cm-number">255.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Input image shape:'</span>, <span class="cm-variable">x</span>.<span class="cm-property">shape</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">imshow</span>(<span class="cm-variable">img</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">prediction</span> <span class="cm-operator">=</span> <span class="cm-variable">pre_trained_model</span>.<span class="cm-property">predict</span>(<span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Class prediction vector [p(0), p(1), p(2), p(3), p(4), p(5)] = "</span>, <span class="cm-variable">prediction</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">"Class:"</span>, <span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">prediction</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 233px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Input image shape: (1, 64, 64, 3)
Class prediction vector [p(0), p(1), p(2), p(3), p(4), p(5)] =  [[9.2633592e-05 4.2629361e-02 9.2548835e-01 4.1606423e-04 3.1337947e-02
  3.5633515e-05]]
Class: 2
</pre></div></div><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_png" dir="auto"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD7CAYAAACscuKmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/Il7ecAAAACXBIWXMAAAsTAAALEwEAmpwYAAA+5klEQVR4nO19a7Bk11nd+s7p7vuaO3dmpNF4JBmNjG0ZYbAhijGBUMbEYGOC48Rx8SiiBIPyMJQJEGxDioIUpEwevAJxUGGDK3EwBtvYpfAyil2EKmN7/MS2LEsIyRq9RqOZq5m5j+4+5+z8uH17r2/17Z5rzUxfof5W1dTsvnuffXafc3af77k+SykhEAg89VHs9QICgcB0EJs9EJgRxGYPBGYEsdkDgRlBbPZAYEYQmz0QmBFc1GY3s5ea2Z1mdreZveFSLSoQCFx62BP1s5tZCeALAF4C4ASAjwL47pTS5y7d8gKBwKVC6yKOfQGAu1NK9wCAmb0DwCsAjN3shw4eSNdec/Xgk/7IGLV9X3KjjD9g3MDdzy7jdM7xC6E/+4P8p/ErSdJnY/t0/vF9/otO+tYTruMYjA6j9cpLwyZeyF3CxnyY9IIaeSbGXINJl23CpKbP5iWJSZtwP3c9bqvv/hMP4PTpMztOcjGb/RoA99PnEwC+btIB115zNW77/f8FAGhQu74tQWELKfm+psntsszjUMi2qvPARm5Ky/JX7dH8pVyWVpHn1zkSrcNIAWpQunElHdfYhM0+YYP4vkLG0ULk3EWLNwXdXrmmRsdZ6efnc/OaDA38wDy/3rNWa9yj5c/VNNWO5wKAosXfLR+X6gpjIc+EpXxcTTewEAW24Psiz0RNf2gX/hrU1c7XakRipntmcs/qRN+nyXMUssjEe0au1fb5Xvbyf4xxuOwGOjO7xcyOm9nx02fOXO7TBQKBMbiYN/sDAJ5On68d/M0hpXQrgFsB4Kuee2PKv67y1jR62xZ+WU3Ty236e13Lm8Af5T7V9KvYpjdZ0/hxFa1Lf5x5fn7LQ37tG/er69fI59Nf/1Z7Lq+j38/Tj/wkk/Qh60dF3y3l64bSX1OWPgqVMOhjSSdP+sozfqvpG1vWNRw3XprRNxkavhd03WQZhdepxp6vmCAhe2nfSyklSQeN7/KSDx2XVBqje+be5IB70Pg6NjKOr09qRIIZkSBHcTFv9o8CeJaZXW9mHQDfBeB9FzFfIBC4jHjCb/aUUmVmPwTgT7D1qnlrSumzl2xlgUDgkuJixHiklP4QwB9eorUEAoHLiIva7F86EtLAKjmiYpAOUplY48lkbqQLlup+KNiiP97CXFVZly3EPlBV+dydlreaNqRDlq3xej8NQ5HUOkw6ZKvt+uo+W2zJsyDqL+vRpei5tRtLVmR1801QYKsm2wsanqNUWwpZ0kvVCPkzfy+xYdC9bRq1MOd7wVZ1tMQ+QI9LY17PbSWyb5A+XIhNx9lSRhRzsuKrFbzZ2T5jabwdR699Q8+IuXON17LVc1HvwgcY4bKBwIwgNnsgMCOYshiPoYxrhbpqSGQT0bogES4VLPbt7N4BRoN2eI6KgysqcW+0KQij8vOz6DTp3KjJlaIBK0Wpo4dolxyMk69BJevggAp1wTj34IRAjsJ5q/wcbQ6IIemwX/fcOA5wqmu53u5DnqRWdYLcp+quYlcTH1fU491OZaPXm0R3esZqEbNLJzL7a8Wqh7q43OUn/a0ZCZii86nvkObn40zmSE1eV1GKqhFifCAQ2EZs9kBgRhCbPRCYEUxXZ09ZnU2i4zlIokPV7KyPaHhl0xufVGGUINLmpBvR8Qr+rAkRbs350pmENXK4byW6oVdZNaR3599eTuLZWgfrdf7cRu7CgpN6ZBx5zVC2On5+Tu4gO8JINOuEJJaq7tPA3Gy11CWaP/sEH28XKVmPLkSXJX21kdDlgq4Vq8qluLWM5pRoWZcQlfpix2GbDNtIxDbDSVrW0meCbQLjbTpWsntQMyHLYWsc4s0eCMwIYrMHAjOCqbvetiOL1AXFLo1GRetiZ1Gy6osbhMW+UqPfdnaVaUSUO0azn2hOc64rf64+R+i15lyfF4X1e+bbwSJy1UiWFJ98xIWZv2eL1qVztEh012vDLjuSgtES0bEhsbJI8iiR+G8cHSkamYuClHW02znC8K7f+Y1hu08ZgQBww/f9m7xGE5XEeOx4HoBJ8Ori+CxGvp9149fo+BpGNNhdU6vk+cUF2Blx540i3uyBwIwgNnsgMCOYrhhvGCarFGo1ZDFEfoLYGp9c0oMXZQrmmDK12O68pFqTHibAWlkUbmqKzBJuKxXd/TpcyJXr6/Y38xwkZo5Elrmv6fta5HXgCMC20ETVJH6qJb2khJdEVvUkKgNbyGuxpFu9c/Se1SrH0ziJNvzEr/1snh9ZPO+0vQj+oV/9mWH7ha/9aT8/XSy+9urgcZFx+gqkh64R74pTvcCqi1jj6QEsxeLuIh2ZvGJClGZL7kU18BRNIpCNN3sgMCOIzR4IzAhiswcCM4KpR9BtRxKppsyqrOodBes4iaOUJIqIFTGloyadtRgTkTdybtH7KUAPbdLTNZqpwXiqYx/F5S9/q8iuJs5+akS3N5pEVPax1MYjWWklE334OSqKtvOuSSHKoDnNPBGHz94abx/gT7Xo8ycfPTtsr6ysDNv99a5fr9O3d6ZYVtSFZDs24997PL2SbnI2Hke4ySOBgsZVaiciW4WRjUSvKa9D7+cw+nCCBy7e7IHAjCA2eyAwI5i6623bvdJUfenjCiUS3USiWCKRViOR2DWkXouCxNvEXOLFeJWh7wndUJK41WcuORGzmShDI/n6LMJNCOLi6h9CyYeC3WiV73TXwEVjaUkt5o3363dunZqTaZSQgZJuRuoAsOuQXFcifrJ7qdPx0W98XEWuzk7pxdtWymL9SDQgifV8q01VL0qg0T6OWCxE9WK3GUcHFkkjG8erdv58O3P3bZ2LxH2R14uBa1L/7scEAoGZQGz2QGBGEJs9EJgRTNn1lnIFTsl6a5hkQJVx7nOulfEVUpWXnnUrtg8oMUZit5OEJPaJuGCOSCI0k6sp2OXldbX5dtZLexOqkXLYZCV66L3vuDXPv+mvVZt+v7/iB3I2WL8vpBGkJ1qhOnDu6yHbVmrRB1tMlDjCnU/EFlwrTZyu7YKy74T8MyVyRXLYroTmnj9/jk6sIb3swuTQWXFnUo08nb9wddq828/V2nXf05Nz+urT/tlnPtGWqwCs+jc/mxL+PLjeWgacccE3u5m91cxOmtln6G+HzOz9ZnbX4P+DF5onEAjsLXYjxv82gJfK394A4PaU0rMA3D74HAgEnsS4oBifUvpzMzsmf34FgBcN2m8D8EEAr7/w6Qzbvy8aSVUYi+rj3RbsFhpJWONMK+X35igoVzZ5Ave8iPgsfDneDFE7zHGK+e/Jorv2+XPncWfuvMv1Pfbo6WH7wIoXqjbW14ftT7z5l4btG2/5t/4EE7Lv1jezyFyS2qE8dhz5VQlZA79Hmv4GzeGvVUXXY3FpwfXV5A7jRLei7R/bNpd1En431i74XmvWZU1kG6VGCjq32fiyYo6+UNQJdolVEinIpb5AbkV1iRr1cRnzrVWVg7nG44ka6I6klB4atB8GcOQJzhMIBKaEi7bGp62ftrFWATO7xcyOm9nx02dWL/Z0gUDgCeKJWuMfMbOjKaWHzOwogJPjBqaUbgVwKwA89yufk7YrtJqU8OFotY4IIyzNuKQHEQk5wigJVTAHbnHUnCYUsCAkBk+XPNL0slVWxcqaLMctqQTL0YFNpSLnzhx6B5/9DDfuY+9aHbbPn9twfYeWlobtpX15ji+84y1u3Fd89w/ueF4AKIgAI5GY3dbvwiqJcNBVdSbiSFRZteqJlbpD59IkGbrV54nXb16i02qS8efE0r1Oqof7nqIqFj4Ty/WxqG4SvQe61y5CTz059BCXhaqOPJbWq2WoOOp0xBq/TV6BsXiib/b3Abh50L4ZwHuf4DyBQGBK2I3r7XcAfAjADWZ2wsxeA+BNAF5iZncB+AeDz4FA4EmM3Vjjv3tM17dc4rUEAoHLiCnzxtuwpK56vFqsYyuRJOk/7D4Z5Z5nNkrN0NqZ+7vdEfK/hqOs/Bwuko3LGI2QaPB6xY1INgLlrGebQJf04ZZ8l3P0uaUer1bWKZkcY/OxU27Yxpn8eW7lkF8j2HaQ59PSROyQasT1VlJmXn8z2zf0mna7ZPuQCLoe6ahFNgGgv+Sz40A2k/W+j3AzitBzFaQke431eXUPOhep2jfoWXWZkGIz6ve4loCUzy7YVUskK+ISrdilKxmZZhfWyCM2PhCYEcRmDwRmBFMv/7QNlTo4qq2Wsk6JEy4m8HtzIoImBLCY1uaosAlkChrgViZym1GyhObtsFimnhB29SXloCNeO06I2OhtunEv+eHXDdt/+d//m+tbX1sbtpfniWt9ed6N+8K73jpsf+X3/zu/fpDozlFbcq3axC+v2kRd5TVzkhOL7Tp/S8grsJDXPDefufit9Netd+78sF0KP35FqgHfzm7lXZbz8/lctbiFk4uIFHcpXRImRTFJclro5PWru7d2ql0+TusFuBJS8mQN+RgnRGXGmz0QmBHEZg8EZgSx2QOBGcGUdfY0JC/oi57L7o00wfUGV5LYoyF3RI3xc1SO7HK8jqOhh31Wzik2UnkjPfe8EgMSsaaETdYua4/0RKmB1pojAoyW13PXe1kXXX0868MLK+I262bdcF5COzfZ5kD6ZCn3pWb/qaYg1ju7sjTbjN2Pc3LBS9KPOXS0EiPJ3P59NJ9aSXYmcGy3fT2+HrvGCtWVmchUi8TRmfg4cbkySUopoa5M1sJEIqlRMo+dS5cDuR7DpHjZeLMHAjOC2OyBwIxg6uWftqXwckR8JhIAEUW0/NE2Rnjdac6ORCnp2OFZJZTPi0qSGTUm0kl51VhyTyMRV3SckNdxBB3781oi9nW72a31ba/7Edf3/l/7r3mKjVw+qej6OVaW9w/bH3/7r7i+534PzdniLEOMhUbXsRrFGYgjWYYU8feu3/gvfo0UIdnbyN+5tbzPjXO8cOfWXV9aXBy2mZRCVQHOXKwkkq9Fx40SjrC7lO6tkP2b99GNm8KRlmipKbdHhNs+jRRUG0W82QOBGUFs9kBgRjD18k/bkvEIf9wE3rY0hgJYSytx9FstotjYRAFNYuFzqahEIn6diKetHJ9Mo9bbghNoxHLM87PF1ky436ivL26NU6uZVvkARZNdcaXnqqsouk4JGYoqi8JNK/PCqVhpzL+WhBONVCBWr5jTDvCcgvvLJdfXJp61okPcbOqtIRXi//zPX3d9L/nBH89r5JJX8Gj6O/McAqN8howeqSU1l4kao3oCO5UV42efouTEW+Opqj0KU5/QKOLNHgjMCGKzBwIzgtjsgcCMYPqut0FGUYJmD1HGUEt+g1j/Jr1I3TgNGQJaLa+Hepda/tpMDrk1PZdFkvWz643UuLovulWpLhMaS3qj6oasE1f03dSG0Wrx+v01+Kc/8VPD9u2/mfXXRo0kZHNo+l6PvuO23x62b3zVv8qH6Nei+9T0xX7Sp+vKNQFEX63JRdUkn93H9QNUf2V0u1m3b+R+unJhlInWyM1taZlwAntPR+odcKRc4og/Dz5MS5IbHWcUmVlI9h27fotivD1pHOLNHgjMCGKzBwIzgqmK8VvVJLZEFhU72H01InK6BAP+s0S4uQgjP0dJhAcu8WBCsr/C8Y6T+FZIogoogUO5zuo+iZxzXnxm1aBDRA5CtY6y5AQU5SnLn9foGhRScqjDXPyaVEGVYT//7v8xbN/wytf6cRQBWIgUWZMg6wlBxoubLYmqLHnopFJZdIF64i41cn02FJFXyDitxOvmSJwM5NXDvuP6ZzF7fLKLlnVi9chxFMrzzYlHVo+wv4xbfp7vgiMCgcBTArHZA4EZQWz2QGBGMGXXW0IzII5IQhrIrqA6jddHWI8xLWnLoYbikkpj67uNsFbSaUUPonUxOaSWMmbOcLVNsNssiaJYOZJCrg0m3PMcSlvK9yRd9J/8yI8O23/4yz6zrUff+/w5bxRYWqJw3C4plP01N65p5YyyUdcP2TSYMFSyswrSPTfPnnd9nYUcPluS/UGqIaNP121D/INONWdyENGpmfe+LfUIOFy7L0SSpXOzMsmFhmuPDwevXCnp8c8OxhGvQso+j8Fuyj893cw+YGafM7PPmtnrBn8/ZGbvN7O7Bv8fvNBcgUBg77AbMb4C8GMppRsBvBDAa83sRgBvAHB7SulZAG4ffA4EAk9S7KbW20MAHhq0z5nZHQCuAfAKAC8aDHsbgA8CeP3EyQzAoLxuIb8zvrKSF3OYm63P2UmtERa6vG4Vc5z7h/jMhJGh5Cw15RggEb8icdRGiASYN368qqFxVi2OSJtQXti7KSVjjaLQuut5jX25Hj0qyVRItOHmZp6/pHvx6Xf/phv3Va/+oTxf34utDbkY+xRNp6pRogi6uaUF19deIL6+mogh1HVFcn0jYjwTUbB43pOsSJbGG30HJiaUkC5jtdL5Cv04V7ZMXIwsnpOLTks28xpVTd12TU6Ko/uSDHRmdgzA1wD4MIAjgx8CAHgYwJEvZa5AIDBd7Hqzm9k+AO8C8CMppbPcl7YsCTv+qJjZLWZ23MyOn1l9/KIWGwgEnjh2tdnNrI2tjf72lNK7B39+xMyODvqPAji507EppVtTSjellG46eGDlUqw5EAg8AVxQZ7ctP8FbANyRUvpF6nofgJsBvGnw/3t3dcZtVUOSjArStWoJdWUWDq6wXI+4JjhcVuvFMQsMhy6qq4ay75K4YDhqtxqv2/vwULE/MFuKMr+Q/re5mfnfTcgzOQQ0CXFidzPrl91eZpzZkAu+SCGmi8obf/pMnn8jkzu25ryufOf73zNsP+0FL/ZrJJ1yYyO77DY2vfuuSFRLTvT5zbVsf1iYz264ERaiufE10FhnT/S0K3c7lwyvJ/C1q1eYryrfCc1o9GuSjE9+5pjtRuwspbqrCdthyJOCv3fjZ/8GAN8H4K/M7JODv/0ktjb5O83sNQDuA/DqXcwVCAT2CLuxxv8Fxv9gfMulXU4gELhcmHL5J8sRcCqCs6jaE4IDzt7izCIRg3tcikfOzIlpHEGnpZXAInIh4iK5fziqTXnu2UUHUQXYbVZ1feQau6i6VXaNNRt+HTX99lqjYnwW/3skBt/00pe5cZ9+z7uG7X1yHbkU89Grr8xz93yZ440zD9Inf8/Wu1mF6FGZ5t6GJ5coCs5AFDIPLvXMLrSWd9GxutIu5dkhdaskQbtoj3f9qmuvpnW10gT1kIlVZBxHEarLmMcaPVcjpJgu61LUz4E6p2qMX0MgEJgJxGYPBGYEU0+ESQOec01msHq8xdMcDztHIvnIL6NkGo06Y6mHRXeTkzG3uElChE82YNO8iHYNkSS0pfJpj6LJ5Lg+ieRM1dYX9ora8eiLCkHkCpVl8bbfFe75+SwK9xsvWi+v5O926vQDw/ZC2/O6F6RuPfyRP3d9K1/xtcP2Jn1ntbjXyOsq1JJOnoY2mdJZ3QGAFonkyj3Y9DmBhso/Sd6IOa+GWMFpjVpFzHHLOc+LWNypraQUrEM0tDEq83Mw390IF97Au2AT7PHxZg8EZgSx2QOBGUFs9kBgRjD1Wm9p4DqzMa4DAEiaEcd6NEc6VV6XHc2Cy3D115hAcEQvp/NKJhfXRKsnkSgSU2KtxIDk/tHMK16j1ZzBJ3poL7vURvT+PpUvnlBq+Jl//5uH7RMf+CPX1zmf52wvZOLLwjxB5gKVOW6dfRgeRL5B96wPsR3UrG/LfScmzIaU7M6iH3ee3XyV1AugoWwv8KM8R30pddNcDT6J/OQIRibZLCVisSH9Own5J3PAc+TnSNkC/i6S9LZd1vySZb0FAoG/vYjNHgjMCKZe/mm7/I+WEmIChUbKKdXsFiERS0slc9LDCOc2iZKFK/HkBZ+GIq5UROZSUYnEfy0c5JJkhCOOyStMLz+VPWaxW5MquhQBuLnpSyaVHVY1KDpN3ZRlvlZP/6aXuL5HP/SBYXuln9exSaWcAaCzkpNk1s/6dVSf+H/DdnH9V+YOKWmUSKxXHjUm/rDOXJ671kQpjmwUEZzE/4quaankFUwIoiXD+XlRN6t7kPm5kjkqvhf+fvLjwj1Foc831yPwfdvuyElloOLNHgjMCGKzBwIzgtjsgcCMYMpZb1kXVddbnwgQoZlozEHOIaWinrCerjaBxKV8SX+vlBt+h7Vuw4XqMgnFSG1n0inF08THKbFmr2IXI5em7rpxTu8XYgvO6GNXZK/W7Lusw/dbfpFn1rNuXpKuCSEE6fWznr5/cdH1zS+Q26zHblUf6tq55+PD9tK8D8etijx2dS1n3O3bt9+N49pp3aS12IjQkqwrmpXGd2KEFJOG6j1jHZltDn15OJmnXl21JXPF07NTq4uO6yKMqZU4ibwi3uyBwIwgNnsgMCOYuhi/LV83ktHjRU7lWqesIC67VHkXTHKkAyrHkwuGx4lYxiQDtZAYsJrA5240co/CtmqJaerQ+mvo/LntCDbEzWKWxe5S5u+RCMrnnm/76LcuieTW8uv48pe8fNj+69vePWwvKb88ccs1Gz6a8crDh4btp1eZ5GKj78d98VxWUZbmPCkFFrJqcOjI0WH77Lon0TDK6OtUwslOKqGXfDWCk+oRSJltVisrCV1rcyYdl3ESFZPdbSPOMeK843tmWkKKt6uqAttrnlDaOt7sgcCMIDZ7IDAjmKoYn5BQDa3iWgaIZVg1s+dmt0vVNtuSIMKiqchRbP2vyeJZJn8JGkemILFxLkkhz1dNiMZS662r+NqMF7l8NNl4daItKsT6+in6lL/nVX1X1wOL81msP/3g/a7vkSufOWw/4+WvHLYfvO0P3LilpWw939eZd32ba9mif88d9+QVVT7SrtPOkXHtllc1XJFbSnpamJeSV2WO5Nu/4T0XFalbbVZl5L60bLylvuBEGPG8VA335Tn6SodO7VITpwhGz5xa7RvnyRFylktRxTUQCDw1EJs9EJgRxGYPBGYE03e9DTH+d2YkII3Qocgv5Wt3UUUj/N6U8cSuMfOuIFeOSMLfWA1zGXcjpaY4yk/L/7K+rRlgpDcSR32r9PPXxCnfq/36Obtq7sx9w/ZGa86NW+wsD9tHjz3b9T320b/M89+QM9Y2571O/YIbrssfhLTy1COrw3Z7MZ+r6vrMuauuPZzXLiaMpTaXBCPXrPDtV1xnoCf2k3ExZX2vUzPnhUZOMloyX4/0aPbUdsSWwtGXI5Fx7IxzSXR+XJtcgkkv1gQ7QD7PBWBm82b2ETP7lJl91sx+dvD3683sw2Z2t5n9rpnQmAQCgScVdiPGdwG8OKX0PADPB/BSM3shgF8A8EsppWcCOAPgNZdtlYFA4KKxm1pvCcD5wcf24F8C8GIA3zP4+9sA/AyAN19gsiEBRCkRXSySF6YJIkxKoVQRNEfDyf2+z0XhcRKLuNdqFkdFBOdPrDJotBTLYh2NOutlEbxuRBiiyLgWqQl1oyWTiDhDVIE5uq79tXxcccAnqpzfyC6w+XmfWHLdlx8bth8+8VCe42lH3Lg+S5/ifpwj7jqOllTXVY848Tc3vXi+sJAj6mwuHzc35x/bU2eIVKQU9x2du6A1lnNy7emBUe51vte9ND5JJtEcVRIVkA4r5fmuSCRv8TWVZ50jOlXVSNs65sWSV5hZOajgehLA+wH8NYDVlIbf6ASAa3YzVyAQ2BvsarOnlOqU0vMBXAvgBQCes9sTmNktZnbczI6fWT174QMCgcBlwZfkeksprQL4AICvB3DAbGgevBbAA2OOuTWldFNK6aaDB/bvNCQQCEwBF9TZzewwgH5KadXMFgC8BFvGuQ8AeBWAdwC4GcB7LzRXgmWXgbirWMeupRAXu7nqCeGmHEY6WvOK9B0Oe9XaYNzWcEXWz1zZZ69bsRo9KZR2RBcnd01DdevqrpBXUCnpK1e/6Pruuetvhu25+ZU8h7h7KsosrPp+/vmVXKb55Kc/k9cn9+yqa75q2H74Qb+OtuUQ1vOrjw3bSXTNLmXBNZIR18yRu7DO37mq/GPLfPPn14WLn75n0aGsRQgcYYV/B1oxwW1WsLuUsynlPVqwi05db3wyIqiQRTLxiZJXbJuXJjngduNnPwrgbbaVZ1kAeGdK6TYz+xyAd5jZzwH4BIC37GKuQCCwR9iNNf7TAL5mh7/fgy39PRAI/C3AVCPozLLINcIRx2JJqS4vEl9IDGzUv8ZilLikOPqNz11L+V935qRifP7MEVJ94THv0zq0JJX73uLaY05yL356NWHteC6PvN7y2WbHjh0btu+7595he/+yJ4ZI9eqwffLx866vf/7ksH1o+eCw/dAD3ixz+kwet77u52COu7PnMslFe96voyQiivV1nxHHXP9pg8Tzef+dDx7M2Xebyc/BvPFcj6Asx4vjpTxWzFNYluMj4/gZVhGcM+KKCTx2nL2mc7C7rUmSVTdQDWyCIB+x8YHAjCA2eyAwI5h++adtDjqRUZhQwsTK3jjxJf+9JaFrFX1uhMeOEyL6FYvjUmKHo/DEosoVZHtVFv+1DBWL6qqusIW/I1VL6/7OIuG9t3tHx+JCtrKvLPkElz5dg5UryNW5Lgk/dH3WJDnl3JncbrfzfNff+Dw3boMs5Fc965mub+VwXuPBR7I1/r5PfMGN26SElFOrp1xf3c7X57pn5KSb+QVPOX3ufFYT9q0IfyFd44Y43UZTOehZkuePOQALuaFMusIkF8mU4pvURVFTmXSFyU40IYwdGUUjvITDscFBFwjMPGKzBwIzgtjsgcCMYLo6u2Ud1iQrqEilG8dI5GZoWXbpVMm7zdj1VpRCSkgKT2pyxFgjpX68/uSn7xPpIbtgtIwvB1mlpBF0RECguiG5g0rKxnvuS7/HjfurP8tc7svqnkHWReeWMmnE+XWvl/fP5Wu3Wfn1z1+Zs9vmC+KGb/sL0t+g6y03bYPmBxFnXP2Vz3Lj7v/sHXnt8/5xnFsiOwu53s6cfsSNWyb7wJy4M0t6xAvyqWkEGt93aNlnuodJXFt8uoazFoVw0tgFK2WrW21yD1JfId+FI/TKUl3Lg1LoGI94swcCM4LY7IHAjGDqHHTDaDhxfXDkkCYpsLjbsLtN3A+uPJOK1tQuictLKerZvTHCH86uOBbfRhJySBSbQIQAKYGV6p3n36i9urK2ntWQzU0vnreJ/eDRx3JU26nTD7px+9ZyJFsp/Pupl+dszWdVYOPM427c0RueNmxfd50Xzx85tzps909kVeD8uk+6OXLDjflcX7zT9T3j2jznmcey+25hn4/Ca1NiEBNeAMAdH/i9Yfu53/Zdw3bS8DSupCrRaaxXanJU3SfR3SUy+fkrGtcW11vdY/E8P9NaIo155FWdaLUHVVyj/FMgEIjNHgjMCGKzBwIzginr7DZ0a9S16kU0SsJgmRSyz7rQhKQ3zSxyNdacfqZ6OelnjToydualL5UEs9hx2OAPubMvGXesr3HNr5aE4971UA4rNfM68GFk4on18zmj7FMf+6wb9/V/9/l5SUKwUa9nHX6jynr/whU+2+ws6d93fN7r2+vn8nGP3f/osD1/0LMVra3lNc4f/TLX9+iD+bj2Yj53R/jrlxZz+GzRW3N9BXx55+F8xYRsxAkOLOVr5xpx3h4jmZujrKR5KIeDY7x7sCzGP1jbz5Ie49YwticQCDylEJs9EJgRTDnrrUE94BnTbDBG0/OdzNXmXBMS/cauMjP5alqGaYf5AKCmTC7llrMx5AS1lInyX04zqMZnRpVFFp+T+y5+ju/6l68dtt/88290fVfN52i1fUsH8nwtLz7/5cc/N2wfveqw6zu0cmjY3lilaMNHvMqwsrKyYxsACooEW7wiz1dVPvuuu5YZhxsVn5ez6N6m6LpWKaWb6kxYce5x7x4Elfhm7kHlBiza47eC0c1OIp4ndsV5ZpKx8zXi72W+eeY2bMm5WKtUkgrbxXs73uyBwIwgNnsgMCOYvjV+8PtiSaODSDwXfjAulzNJvGWhWJNTChLJez1WC1SfoM+iJvCMfh0i2tFAVgsAoE3Rao2KtESuUJAaUojlmK/VD77x51zfW//zfxy2Tz+6ms8r5Y6++GC2Wt9xvyeUuO7qA8P2wZVs6dbAslNn8vxPu+ppru/QwTwHFWPFgnDQcVSiRq6tb2ZL+uYmi7pyX7p5XGvBq0aPk0fCicvirWmTR6UvSSxM8V1V471I3pMjKiaJ56o6OoruYrw13j2Bwm24nVg2QTuON3sgMCuIzR4IzAhiswcCM4KpZ71lSOYPl6OVkQ25NDiIqJE5mklReeRq6RCnfNWM5NjlY8Q1VrnS0UxkKOSW5MbRrDd2AZpkP3E5Y9bx6tq7vDiKq9v1POn/6OYfGLZv/fmsv6trbN7y/O39B13f3fdlPvjl5WxXWOhI1NZa1vt7lZR1IpfXVVflqD51eSXSj1vCFrKwkN2IHSrT3BNbx7k6f05CWmLkpuNMN5PoSL7emlHGa27JM9E4e81IUal8Pmd3Gp9x19D1UHcae4+VHGOytq5nuQAGZZs/YWa3DT5fb2YfNrO7zex3bZSuMxAIPInwpYjxrwNwB33+BQC/lFJ6JoAzAF5zKRcWCAQuLXYlxpvZtQBeDuDnAfyobckkLwawTY72NgA/A+DNk+ZJyFFSpl4FStTXZAMWjxJx1WkCh0s2GBHPiVgAO6sFANAQj3kt/HEY41opRYRqiNOtgXCR0fdU12EzRjhS0ZdFx40Nn+hx9ty5Yfvw048O26cePO3GOT6z5AkwuNoUV406fdqfq2jlSq0nJXLNOlkET8RBd0CIJxYXF/M4eKxvZFWAXZaluDqXlrJ7sBFXam8uf88uXavOiufbd2uX+8IeMC27xGQWrLLpHKyy6aarSKVwbmadgz5XWv5p8CBfCg66XwbwE8i77goAqykz8Z0AcM0u5woEAnuAC252M/sOACdTSh97Iicws1vM7LiZHV9dffzCBwQCgcuC3Yjx3wDgO83s2wHMA9gP4FcAHDCz1uDtfi2AB3Y6OKV0K4BbAeArnvPsSVJGIBC4jNhNffY3AngjAJjZiwD8eErpe83s9wC8CsA7ANwM4L3j5qDJhqGOSqZXlFlfTaJvM5ED1+tShdu5LcQFw2lqTGCpIYk2Ej5L85M+z/pTLQYIF6qr+h/rym2vN/J3Y1fQ5qZ3NfX73R3HAV7PW1wmd9vGvW5ci85di9vsykM5C67q5nMdPLTPjWPe+LWz3iV1up0LxjFxSGfOh9W2evkRnF/wNgvWzVl/X1j093Zjk8KfO1pcL9+Lk/fePWyvPO/vuGHeNaZ2FuL6VxsMh0bT86dcFVxzrj9iayLSElq+2rWce3rkMb3we/Rigmpejy1j3d3Y0uHfchFzBQKBy4wvKagmpfRBAB8ctO8B8IJLv6RAIHA5sAcRdFuiiEaWNSTaJJGBHO0cRzCNlM/l0royR+LIJCorpFlpdElM1sjZSiz+j5YSGp/hxNlWvb53ZXU381pY9FX32uZaFlvVS7m+lkX+ozc8Z9i2jXNunJFKstnz6187myPj1siNuC7RejWVrb7iuutd36NfvGvYXiJCjY1z3ki7RNl4qfbXamEhk1cwX9/jZ/z12CBVpp0ko4zCzu777EeG7S9/7te6cf6ZU9cbie61ZmvmseUE1Q4coSddDbmWC87+VBWTllXCf8/eQLULDrpAIBCbPRCYFUy9iut2pE89kgxA1lCpKsqiMFufRyKdwNFvQu88pryPziG27TErlJkLXUfGJJ682hvZsblJYjJ5K7qbflXdfj5Qo+t6vdzHPHCNRJ0dpsqnHaHC5vOdOHFi2F7r+e9ypsr8cY984XOu76u++oZhe55C8gqpBDtHkXGF3AummV45kCPv1k+dd+PYe7MpFVKNS4dRMo3eFyasKMTL46ie5VoVdLcdIUajqt140pWCbm/F3qYR/kL6LK/p4b4IMT4QCMRmDwRmBLHZA4EZwdRdb9uugUJcB4mz3jQbjPQr5yIRtZ9JGkdK54wpZZvk944JBZU3nkdWE3SjlNg+IJGC1O6blH+izp4jNhxPXtgT1yGroqxfLl3jXWMbj31x2F5YXnZ9h1ayftzfzHzzlWTltYhJ8tGT3h127NixYfv82RxN1+t79935bnbzXbF0leuryTbx0MnVYXuz540dXKZ5c93r86257L5LPXbvumEuK01druxua4t9piZdnEt3q02gcESSfnqu+M3kpSNZkc3ObQDoDLIMTdM4eQ1jewKBwFMKsdkDgRnBlMs/sctNxBzmmRMxahzntnJ/G8k2ShpRNUxeR8koI5xl4xNhmK/OuWdEpuLIp0JcNb1eTizRIKsWcYFvbI53r7VLdiGJ6w1ZNWC++YUFL6qfSvl7P630j8E111w9bB+iqqv3P/iwrPfIsD0/57/nI49mHrujR/J8XXjV5b47Pz9sb/T9dzl86Iphe44IKmxOEmHWswuwJXzqGxtZTbB2VkP0LWcV3Vvhwqucx0sJR1it5Guvrl93lP/E5BUlR4H6o7jUlLp7h2Mn5MPEmz0QmBHEZg8EZgSx2QOBGcHUw2XLgXusUt5rdnONuC3oN4nTvEbqxRHhn4ZNMlkGzVeLbs/qlJbnZTUsufq5flybiQFF32bXShJCS8dLT3OoHtpvsj6v3PYdJgEhnvd+2+u5S1dmysB+dcb1NcRTv7ycdeUrD3ru+f3LWUddObDo+h59POvR3X4mtDx8xdVu3Ikq6+wr+3xZ6SuO5rGJuOKT8OivbWRSjfN0XgDosI7dytdqY927AOeXsvtu5Nmh21tPUIpdLQF5rFzmnNYLKHd+56pNqiS7Uy3huK3BHGM8zFvrG98VCASeSojNHgjMCKZesnk7UqlUwoeasodEVOJoOCaGGHW9jS//5EvssIvOgyPt1HnC0zcUuaaRdjynrpG1Bo2QYl56R3rR9+4qMElHMb6UEM8/v+j52jnD7r6HHnN9T7viwLC9fy4fd+QKL8avns0icyPfc/XE6rC9sJTdfq2zXmX4smc/e9huz/k13vP5XJNkmaL8WpI5Nz+XVYiO8Nh1u17kH54Lol4xQYq4X/lprGsRn2loRSrmSMRmOd4Vx3UH+FlXfkFzLjqvlm2TewR5RSAQiM0eCMwKphxBl9AMeMtMoraMxfhGxCiyuhflGMs8gD7JyJ3C0zTXZMF20U0ilrG1XDnAEllbnagn6gMLiBKMhYoprSckyfC522JJr4j1wlr+GrhKqA2VYBKr/dJytmD3r77B9Z09uzps75vPYvHKkqeSZlXg7JpPQOk9lstN/U0/r/EKsehzNGAxP+/6Nuusvhw5kI9b6Ph7u04lr2pNHiELfNXN1+0vbvsdN+4bX/n9w7aKyKyYtUZKQ1HkJ1nc6xEPTW7LI+e8MNaiMlfqbeLISdUAh8/meHN8vNkDgRlBbPZAYEYQmz0QmBFMPYJuW8VRzcKpOKorM0EAKTyaWFQyyaRp1ltud0jPLUohhiCNuxQ9t3bsAXn+keLQFPGWREErSdefFF3X7uR2b1PKBRFJR0u/J0feEdFjsyZUmuTmWt7vySAefjATW+zfn/X0+ZZ3Y11JejRH9QHA9V923bB9z5nsbqtED22TjnrytHfLLbSzDn/mdNbLz5XePsDlsLqVX2OPXZ29bAOoe36ci36T0mRaktv10f1MFOFmWtOAlWzJVGT3LJNnJrEFFW22D/itWw/sG+q2Zuy2Pvu9AM5hy0tcpZRuMrNDAH4XwDEA9wJ4dUrpzLg5AoHA3uJLEeO/OaX0/JTSTYPPbwBwe0rpWQBuH3wOBAJPUlyMGP8KAC8atN+GrRpwr594RAJsm/xLAvlrKkeURgRjghNbxX1HImy/70WgFotpjmdOfWN0bomkKok8oB7zdwAwcsEozzgn+cx3fLRXn7jOmmq8660hUa2u/PycGNPvZddYsyBiXzfPMT/vE1C6B44N26unHx22D0p0Wo9E8uU57w675uiVw/aD5ygppuu56szycU1v3fU1tKzmXL4XWsW1Ia669a6PNjx7LpNXHNmXVZde5dUO1tBKKfGU2lQSTHxejmuOySW0HgFFXKprj5N8SENDMnm+HVmd7JExyTSM3b7ZE4A/NbOPmdktg78dSSk9NGg/DODIzocGAoEnA3b7Zv/GlNIDZnYVgPeb2ee5M6WUzJRkaQuDH4dbAOBpRw7vNCQQCEwBu3qzp5QeGPx/EsB7sFWq+REzOwoAg/9Pjjn21pTSTSmlmw6srOw0JBAITAEXfLOb2RKAIqV0btD+VgD/AcD7ANwM4E2D/9974dMlIkj0vzPs7mipnku6oeP3UxcGuT5KCVdksSORfpNkDubdrpK4q0ifT608o9ZKq8ntkqSgW6JcOiUg6NC5C3LfbQrJxUKRXVKVuA7Lcmd7R5O8rsy8/f16zfV1FrKy/Nij9wzb+894vXwfZdIluVaLC3nsPOnUax0fcrtKobnzbW8TSOezi+38eSKOFE8YuzrXNzwpRYfIKZ3rNKm9hx8ssdVQV5IsQ/YkOi+rjmN9XksxE4m9W2Ia73JtoM/3BKbJAXYjxh8B8J6B8asF4H+nlP7YzD4K4J1m9hoA9wF49S7mCgQCe4QLbvaU0j0AnrfD3x8D8C2XY1GBQODSY6oRdAk5ud5KL3bMObFSRSUSn+nvI+WZSHRKGsHEXO4UJdcVvos288wJeUDhSgRl9CoRnZ1bROsM5TnbSnpB35NF0znzpA594lfX8sIpZddTp5PnKAs/x/kmR5AtznvxGeS+OndNzoj74v13umHHjmZe9/PnfVTb8oFMNvHsG545bH/6/gfcuE4rr2ttU2pYU7mmNRLPTWs3EcF6knJYVx/OLsC19Tx/s+HPdfxP3jls/71/+M9cnyOEmMDxxk+nlmfibDlVeQrKzDM6VxL6FCYIKTRyctvVHLzxgUAgNnsgMCOIzR4IzAimX7J5oHZoJlGv4jBH/xvkiBlZPxMXRt0nvbwt2WZU94xV8bZmvbk6baIPszuP9PQRRpE2X1YlLxyv9LEuxzYHJabstNi+4XU31tM5q66ROebIJaXxUL2FfFynyWSO64ePuXEPPfI3w/a+fd4mcPrM48P2yqFDuS0MQqeI7eZhKssMAIfoOMfmIrrsPLkwl/Z5/voWPS8UgYyljn/0e2uUwyUuUU6mLNRlTPfMSGEuxWYEp7NLKC1nWrrnQ+q5sW1IOeW37T/BGx8IBGKzBwIzgqmK8QYbRm6pKMPlhVU8dzzvFKbUEjEbLplIXVI7i/+FZBYVLp9No9FItCYCjFpdQTS/VoBOzOs+QiiYv0CfxNa2RJY15HZJWi6aCA/YfaeU+o1ltUnvBXPWz3WyWFzN+4yyvz6VRfXD6xKFt5ij/DZ7OXPuqmuvdOPOPnBq2D56+IDr2+jmOZeJIFMjFpfm8/fUDEF2n/ZZDF7wz1h3PbsihQsVRucrJpX0dgTzuysTBQAFqVE9vn+lRBRSe4RQY/DVLAgnA4FAbPZAYEYw/SqugwSSplZRnayapoQMXJKJrdRijacEhgnSFlxRWEk2YM64JIQAnMDAvO5lod4DsgD3fKQWR0tplBV/ZBG8Ur406lNRrylYXicLduGvVZtFYYlmdFzrZZ6PRXoA2H/sOcP2Fz7+Udd3eDlb5xeX83FnH3zUjVujaMmq8fd930I+bj8l1qDlRXVWO1LtVY3uJnskct+c3NtD8/ka/MW73+b6vuGVN+cPorJxVdeC1SEt+0XQBC4jrv8WJeio1wHE86eJMOWE8lLDJV1wRCAQeEogNnsgMCOIzR4IzAimXOsNSAO9rBZSB9bTk5LpaTTSAOrdKF2Uku/0ajXP53/vWq187p5GUpFWzettRPnmSDitadc4vvnxehfbKZLoqOyyM9H/2K0zR8cpR32isLCyVDcRzUHc810/BfbtPzhsrzz9Wtf3+MMPDdtnmQRSSDYPX5WpykayB3m9dLMbyYo08nkliI+R0GG7RcvPcZYy7nonH3J9jSMj8fO3uUYAzV+PPBO5TyMim/7O9ip9rjh6T0uBa3nnnRBv9kBgRhCbPRCYEUydvGJb3Bgp2cyiqSbtkwuJOdN1HLvbKpFMfQTdeLcIE2eoSw10vkliWbIsPjdJ/Wtjyj4DSERKwWJaM/Jdxq+xrPNxPcuiqbpm2q0s9vVEXOSyUUbllhdLL8f3yA01v/+A66s2cvTbPLkDNcLNrV2uxyaVa2pRdOGCjDu4PxNldLveTbnR48i4fFxbovC4DHa/K1GJVGegEJWn5uQlxx83XjXSx4qfVaN7oeW4WX0x5WkcqpgTIvfG9gQCgacUYrMHAjOC2OyBwIxgullvlsNAa9VlXRiiui2YaI943fteh+RoS62nxW4M1nk1A4n1JNPsO7YRcCbeiF5Ox2kNLgqlTeJCYneNlvxltMqdbQeAz4hjW0Iha+yQzaRvPsS0cLYJum7i7llaWhq2NzaWXN/m8oG8jl4ut3xAdHsOO+6LcaJHuvLa+TzHyhUH3biD+6l0dNdn36126Z716XvKdSsp1LrV9vrwH731Pw3br/jXP+nXz1lq5NJtWv6+c+lBdd+5s/FhWmSJwpgl+hn9Zut+TrJHxZs9EJgRxGYPBGYE04+g2xafNDqtccMc2CXDXqK2iFvOgyTzs2uvIZGtEZWBg/ekChAajs5yUWx+YJ/nlKgwjvJTl51bhxPhxhNxKDqkvlSc3Vd50ZED6toinqcWu/2odHQtGXZ0jZf3e9F6jco0g9SExQWvXi3NE8mFROi156isUycf1xH33dq5zB938KBfR2F5zWebPK5Tqgswf5dF6Tu/QaWkRQTnskt9vi9KzrLjmbbAKqbL8Ezj73ujEaLDWS/S9WZmB8zs983s82Z2h5l9vZkdMrP3m9ldg/8PXnimQCCwV9itGP8rAP44pfQcbJWCugPAGwDcnlJ6FoDbB58DgcCTFLup4roC4JsA/HMASCn1APTM7BUAXjQY9jYAHwTw+guecSDemP7OcOkmMW73exw5NH5qJoZQi37VZ262LNopkQAflYS4zSWnsOVVEnfazGsnX4a1iwr+3C2y3LNKorwELMFpZFyP5PMWieeVRtp1cl+nmXd9dZ2jztotJo3wVntG1fMU0XyNuxuUTLPuI9wO7c8VY1PyfQeX2MKf199f9xVpN4l8sN/1CVYtqrbL16rdlkefvQJ9TS7Kx50+9aBf41U5AcgJ0CJmT+rj78aaXV+JAwltVe0G5vkJmuGu3uzXA3gUwG+Z2SfM7DcHpZuPpJS204Mexla110Ag8CTFbjZ7C8DXAnhzSulrAKxBRPa0ZTnY0TJgZreY2XEzO776+NmdhgQCgSlgN5v9BIATKaUPDz7/PrY2/yNmdhQABv+f3OnglNKtKaWbUko3HVjZv9OQQCAwBeymPvvDZna/md2QUroTWzXZPzf4dzOANw3+f+8F5wJQD3Rk08gypyx7xcPxn3OWkeonTAyhif+UieYi18QIwNFpvb64zcqdue010KmidaibjIktWiOZS6yzs+4p3Paki/f7Xo92xYOYyGLO69Q9KoecWn7+ubn8vedoTWuSZdhfzy6ppeVl17dMn5lYYaO76tdLU7Yl6qyiEsvLC0TEOLfPjQOV/dKSzVwOa1+broFc+naRbQwaUdhs5PV/6D2/5fpedsu/z+P4mVO3Gd0YfWzZlsBz6JuYIxjHue8meGV37Wf/YQBvN7MOgHsA/IvBWt5pZq8BcB+AV+9yrkAgsAfY1WZPKX0SwE07dH3LJV1NIBC4bJhy+SdyX4lXgcUPLbHjkmZccgdkHHF4aw0fjj7iZBRNJCF5S91avAyOHtM5KhIlCxGRS4roqkXkNHLhcYLOqEpS7jhuaw6K0CNBsCz8HHNUMkkj+fjS8RKV56xpsmrU6/lrwMkqrLqsPXzGjVs9k422K/vFptMmNyItsd0R7nYjfnz5Li4ijZ6rpOQVUj+Awc/BxoZ3D7bpWWoosm/kWjmdczx/nN5PmWTYnJDvMhYRGx8IzAhiswcCM4LY7IHAjGDKhJNpqH/60FYgUXaYRLA67xjrr5WSAIzJjlMwKUUSHwzrTyO6rHFIJZEhSvZdSeWnG82SoqHKe896aWr4d1hILqp8bnVhOjdOonFaVpqmnJvzWV4bFJ68SOGyI6WG6fOaZP6lxax/b8zn0s7rUn56g2rhaRQGuwv7ZDxoyTuqT99TXZFz5HrjdiNKb5eyAhcXffjwOQqf7cj1/tO3/+qw/c3f87rcIde7JANTJZmQ/Jg5+49mbtK5KwnDLib53LbHXHBEIBB4SiA2eyAwI7BJRAiX/GRmj2IrAOdKAKemduKd8WRYAxDrUMQ6PL7UdVyXUjq8U8dUN/vwpGbHU0o7BenM1BpiHbGOaa4jxPhAYEYQmz0QmBHs1Wa/dY/Oy3gyrAGIdShiHR6XbB17orMHAoHpI8T4QGBGMNXNbmYvNbM7zexuM5saG62ZvdXMTprZZ+hvU6fCNrOnm9kHzOxzZvZZM3vdXqzFzObN7CNm9qnBOn528PfrzezDg/vzuwP+gssOMysH/Ia37dU6zOxeM/srM/ukmR0f/G0vnpHLRts+tc1uZiWAXwfwMgA3AvhuM7txSqf/bQAvlb/tBRV2BeDHUko3AnghgNcOrsG019IF8OKU0vMAPB/AS83shQB+AcAvpZSeCeAMgNdc5nVs43XYoiffxl6t45tTSs8nV9dePCOXj7Y9pTSVfwC+HsCf0Oc3AnjjFM9/DMBn6POdAI4O2kcB3DmttdAa3gvgJXu5FgCLAD4O4OuwFbzR2ul+XcbzXzt4gF8M4DZsJXvvxTruBXCl/G2q9wXACoC/wcCWdqnXMU0x/hoA99PnE4O/7RX2lArbzI4B+BoAH96LtQxE509iiyj0/QD+GsBqSkMWh2ndn18G8BPIqTlX7NE6EoA/NbOPmdktg79N+75cVtr2MNBhMhX25YCZ7QPwLgA/klJy/NrTWktKqU4pPR9bb9YXAHjO5T6nwsy+A8DJlNLHpn3uHfCNKaWvxZaa+Voz+ybunNJ9uSja9gthmpv9AQBPp8/XDv62V9gVFfalhpm1sbXR355SevdergUAUkqrAD6ALXH5gNmwnM007s83APhOM7sXwDuwJcr/yh6sAymlBwb/nwTwHmz9AE77vlwUbfuFMM3N/lEAzxpYWjsAvgvA+6Z4fsX7sEWBDeySCvtiYVsJ8m8BcEdK6Rf3ai1mdtjMDgzaC9iyG9yBrU3/qmmtI6X0xpTStSmlY9h6Hv5vSul7p70OM1sys+XtNoBvBfAZTPm+pJQeBnC/md0w+NM2bfulWcflNnyIoeHbAXwBW/rhT03xvL8D4CEAfWz9er4GW7rh7QDuAvBnAA5NYR3fiC0R7NMAPjn49+3TXguArwbwicE6PgPgpwd/fwaAjwC4G8DvAZib4j16EYDb9mIdg/N9avDvs9vP5h49I88HcHxwb/4AwMFLtY6IoAsEZgRhoAsEZgSx2QOBGUFs9kBgRhCbPRCYEcRmDwRmBLHZA4EZQWz2QGBGEJs9EJgR/H9QETF0Wm8m7QAAAABJRU5ErkJggg=="></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">You can also print a summary of your model by running the following code.</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p>You can also print a summary of your model by running the following code.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[64]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 231.609px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 234.625px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 231.609px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pre_trained_model</span>.<span class="cm-property">summary</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to unscroll output; double click to hide"></div><div class="output output_scroll"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Model: "ResNet50"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 64, 64, 3)]  0                                            
__________________________________________________________________________________________________
zero_padding2d (ZeroPadding2D)  (None, 70, 70, 3)    0           input_1[0][0]                    
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 32, 32, 64)   9472        zero_padding2d[0][0]             
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, 32, 32, 64)   256         conv2d_7[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 32, 64)   0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 15, 15, 64)   0           activation_6[0][0]               
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 15, 15, 64)   4160        max_pooling2d[0][0]              
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 15, 15, 64)   256         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 15, 15, 64)   0           batch_normalization_7[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 15, 15, 64)   36928       activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 15, 15, 64)   256         conv2d_9[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 15, 15, 64)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 15, 15, 256)  16640       activation_8[0][0]               
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 15, 15, 256)  16640       max_pooling2d[0][0]              
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 15, 15, 256)  1024        conv2d_10[0][0]                  
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 15, 15, 256)  1024        conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_2 (Add)                     (None, 15, 15, 256)  0           batch_normalization_9[0][0]      
                                                                 batch_normalization_10[0][0]     
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 15, 15, 256)  0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 15, 15, 64)   16448       activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 15, 15, 64)   256         conv2d_12[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 15, 15, 64)   0           batch_normalization_11[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 15, 15, 64)   36928       activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 15, 15, 64)   256         conv2d_13[0][0]                  
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 15, 15, 64)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 15, 15, 256)  16640       activation_11[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 15, 15, 256)  1024        conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_3 (Add)                     (None, 15, 15, 256)  0           batch_normalization_13[0][0]     
                                                                 activation_9[0][0]               
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 15, 15, 256)  0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 15, 15, 64)   16448       activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 15, 15, 64)   256         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 15, 15, 64)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 15, 15, 64)   36928       activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 15, 15, 64)   256         conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 15, 15, 64)   0           batch_normalization_15[0][0]     
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 15, 15, 256)  16640       activation_14[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 15, 15, 256)  1024        conv2d_17[0][0]                  
__________________________________________________________________________________________________
add_4 (Add)                     (None, 15, 15, 256)  0           batch_normalization_16[0][0]     
                                                                 activation_12[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 15, 15, 256)  0           add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 8, 8, 128)    32896       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 8, 8, 128)    512         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 8, 8, 128)    0           batch_normalization_17[0][0]     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 8, 8, 128)    147584      activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 8, 8, 128)    512         conv2d_19[0][0]                  
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 8, 8, 128)    0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 8, 8, 512)    66048       activation_17[0][0]              
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 8, 8, 512)    131584      activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 8, 8, 512)    2048        conv2d_20[0][0]                  
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 8, 8, 512)    2048        conv2d_21[0][0]                  
__________________________________________________________________________________________________
add_5 (Add)                     (None, 8, 8, 512)    0           batch_normalization_19[0][0]     
                                                                 batch_normalization_20[0][0]     
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 8, 8, 512)    0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 8, 8, 128)    65664       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 8, 8, 128)    512         conv2d_22[0][0]                  
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 8, 8, 128)    0           batch_normalization_21[0][0]     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 8, 8, 128)    147584      activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 8, 8, 128)    512         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 8, 8, 128)    0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 8, 8, 512)    66048       activation_20[0][0]              
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 8, 8, 512)    2048        conv2d_24[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 8, 8, 512)    0           batch_normalization_23[0][0]     
                                                                 activation_18[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 8, 8, 512)    0           add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 8, 8, 128)    65664       activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 8, 8, 128)    512         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 8, 8, 128)    0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 8, 8, 128)    147584      activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 8, 8, 128)    512         conv2d_26[0][0]                  
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 8, 8, 128)    0           batch_normalization_25[0][0]     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 8, 8, 512)    66048       activation_23[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 8, 8, 512)    2048        conv2d_27[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 8, 8, 512)    0           batch_normalization_26[0][0]     
                                                                 activation_21[0][0]              
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 8, 8, 512)    0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 8, 8, 128)    65664       activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 8, 8, 128)    512         conv2d_28[0][0]                  
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 8, 8, 128)    0           batch_normalization_27[0][0]     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 8, 8, 128)    147584      activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 8, 8, 128)    512         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 8, 8, 128)    0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 8, 8, 512)    66048       activation_26[0][0]              
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 8, 8, 512)    2048        conv2d_30[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 8, 8, 512)    0           batch_normalization_29[0][0]     
                                                                 activation_24[0][0]              
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 8, 8, 512)    0           add_8[0][0]                      
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 4, 4, 256)    131328      activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 4, 4, 256)    1024        conv2d_31[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 4, 4, 256)    0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 4, 4, 256)    590080      activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 4, 4, 256)    1024        conv2d_32[0][0]                  
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 4, 4, 256)    0           batch_normalization_31[0][0]     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 4, 4, 1024)   263168      activation_29[0][0]              
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 4, 4, 1024)   525312      activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 4, 4, 1024)   4096        conv2d_33[0][0]                  
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 4, 4, 1024)   4096        conv2d_34[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 4, 4, 1024)   0           batch_normalization_32[0][0]     
                                                                 batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 4, 4, 1024)   0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 4, 4, 256)    262400      activation_30[0][0]              
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 4, 4, 256)    1024        conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 4, 4, 256)    0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 4, 4, 256)    590080      activation_31[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 4, 4, 256)    1024        conv2d_36[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 4, 4, 256)    0           batch_normalization_35[0][0]     
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 4, 4, 1024)   263168      activation_32[0][0]              
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 4, 4, 1024)   4096        conv2d_37[0][0]                  
__________________________________________________________________________________________________
add_10 (Add)                    (None, 4, 4, 1024)   0           batch_normalization_36[0][0]     
                                                                 activation_30[0][0]              
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 4, 4, 1024)   0           add_10[0][0]                     
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 4, 4, 256)    262400      activation_33[0][0]              
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 4, 4, 256)    1024        conv2d_38[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 4, 4, 256)    0           batch_normalization_37[0][0]     
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 4, 4, 256)    590080      activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 4, 4, 256)    1024        conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 4, 4, 256)    0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 4, 4, 1024)   263168      activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 4, 4, 1024)   4096        conv2d_40[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 4, 4, 1024)   0           batch_normalization_39[0][0]     
                                                                 activation_33[0][0]              
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 4, 4, 1024)   0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 4, 4, 256)    262400      activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 4, 4, 256)    1024        conv2d_41[0][0]                  
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 4, 4, 256)    0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 4, 4, 256)    590080      activation_37[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 4, 4, 256)    1024        conv2d_42[0][0]                  
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 4, 4, 256)    0           batch_normalization_41[0][0]     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 4, 4, 1024)   263168      activation_38[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 4, 4, 1024)   4096        conv2d_43[0][0]                  
__________________________________________________________________________________________________
add_12 (Add)                    (None, 4, 4, 1024)   0           batch_normalization_42[0][0]     
                                                                 activation_36[0][0]              
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 4, 4, 1024)   0           add_12[0][0]                     
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 4, 4, 256)    262400      activation_39[0][0]              
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 4, 4, 256)    1024        conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 4, 4, 256)    0           batch_normalization_43[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 4, 4, 256)    590080      activation_40[0][0]              
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 4, 4, 256)    1024        conv2d_45[0][0]                  
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 4, 4, 256)    0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 4, 4, 1024)   263168      activation_41[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 4, 4, 1024)   4096        conv2d_46[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 4, 4, 1024)   0           batch_normalization_45[0][0]     
                                                                 activation_39[0][0]              
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 4, 4, 1024)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 4, 4, 256)    262400      activation_42[0][0]              
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 4, 4, 256)    1024        conv2d_47[0][0]                  
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 4, 4, 256)    0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 4, 4, 256)    590080      activation_43[0][0]              
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 4, 4, 256)    1024        conv2d_48[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 4, 4, 256)    0           batch_normalization_47[0][0]     
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 4, 4, 1024)   263168      activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 4, 4, 1024)   4096        conv2d_49[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 4, 4, 1024)   0           batch_normalization_48[0][0]     
                                                                 activation_42[0][0]              
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 4, 4, 1024)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 2, 2, 512)    524800      activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 2, 2, 512)    2048        conv2d_50[0][0]                  
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 2, 2, 512)    0           batch_normalization_49[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 2, 2, 512)    2359808     activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 2, 2, 512)    2048        conv2d_51[0][0]                  
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 2, 2, 512)    0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 2, 2, 2048)   1050624     activation_47[0][0]              
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 2, 2, 2048)   2099200     activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 2, 2, 2048)   8192        conv2d_52[0][0]                  
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 2, 2, 2048)   8192        conv2d_53[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 2, 2, 2048)   0           batch_normalization_51[0][0]     
                                                                 batch_normalization_52[0][0]     
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 2, 2, 2048)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 2, 2, 512)    1049088     activation_48[0][0]              
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 2, 2, 512)    2048        conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 2, 2, 512)    0           batch_normalization_53[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 2, 2, 512)    2359808     activation_49[0][0]              
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 2, 2, 512)    2048        conv2d_55[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 2, 2, 512)    0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 2, 2, 2048)   1050624     activation_50[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 2, 2, 2048)   8192        conv2d_56[0][0]                  
__________________________________________________________________________________________________
add_16 (Add)                    (None, 2, 2, 2048)   0           batch_normalization_55[0][0]     
                                                                 activation_48[0][0]              
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 2, 2, 2048)   0           add_16[0][0]                     
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 2, 2, 512)    1049088     activation_51[0][0]              
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, 2, 2, 512)    2048        conv2d_57[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 2, 2, 512)    0           batch_normalization_56[0][0]     
__________________________________________________________________________________________________
conv2d_58 (Conv2D)              (None, 2, 2, 512)    2359808     activation_52[0][0]              
__________________________________________________________________________________________________
batch_normalization_57 (BatchNo (None, 2, 2, 512)    2048        conv2d_58[0][0]                  
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 2, 2, 512)    0           batch_normalization_57[0][0]     
__________________________________________________________________________________________________
conv2d_59 (Conv2D)              (None, 2, 2, 2048)   1050624     activation_53[0][0]              
__________________________________________________________________________________________________
batch_normalization_58 (BatchNo (None, 2, 2, 2048)   8192        conv2d_59[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 2, 2, 2048)   0           batch_normalization_58[0][0]     
                                                                 activation_51[0][0]              
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 2, 2, 2048)   0           add_17[0][0]                     
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 1, 1, 2048)   0           activation_54[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 2048)         0           average_pooling2d[0][0]          
__________________________________________________________________________________________________
fc6 (Dense)                     (None, 6)            12294       flatten[0][0]                    
==================================================================================================
Total params: 23,600,006
Trainable params: 23,546,886
Non-trainable params: 53,120
__________________________________________________________________________________________________
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit Markup Text here"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 35px; min-height: 184px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">name</span>=<span class="cm-string">'6'</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line">&nbsp;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## 6 - Bibliography</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">This notebook presents the ResNet algorithm from He et al. (2015). The implementation here also took significant inspiration and follows the structure given in the GitHub repository of Francois Chollet: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun - </span><span class="cm-link cm-variable-2">[Deep Residual Learning for Image Recognition (2015)]</span><span class="cm-string cm-url cm-variable-2">(https://arxiv.org/abs/1512.03385)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-2">- Francois Chollet's GitHub repository: </span><span class="cm-variable-2 cm-link">https://github.com/fchollet/deep-learning-models/blob/master/resnet50.py</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 219px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1" dir="ltr"><p><a name="6"></a>  </p>
<h2 id="6---Bibliography">6 - Bibliography<a class="anchor-link" href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#6---Bibliography">¶</a></h2>
<p>This notebook presents the ResNet algorithm from He et al. (2015). The implementation here also took significant inspiration and follows the structure given in the GitHub repository of Francois Chollet: </p>
<ul>
<li>Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun - <a href="https://arxiv.org/abs/1512.03385" target="_blank">Deep Residual Learning for Image Recognition (2015)</a></li>
<li>Francois Chollet's GitHub repository: <a href="https://github.com/fchollet/deep-learning-models/blob/master/resnet50.py" target="_blank">https://github.com/fchollet/deep-learning-models/blob/master/resnet50.py</a></li>
</ul>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 7px; margin-bottom: -15px; border-right-width: 35px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="button" class="ui-button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="https://zbwlncob.labs.coursera.org/notebooks/W2A1/Residual_Networks.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "6.1.5", "notebook_path": "/usr/local/lib/python3.6/dist-packages/notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.6.9 (default, Oct  8 2020, 12:12:24) \n[GCC 8.4.0]", "sys_executable": "/usr/bin/python3", "sys_platform": "linux", "platform": "Linux-5.4.0-1048-aws-x86_64-with-Ubuntu-18.04-bionic", "os_name": "posix", "default_encoding": "UTF-8"};
</script>

<script src="./encoding.js" charset="utf-8"></script>

<script src="./main.min.js" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>
<script>
        var historyWrapper = function(functionType) {
          var whichFunc = history[functionType];
          return function() {
            var response = whichFunc.apply(this, arguments);
            var eventRes = new Event(functionType);
            eventRes.arguments = arguments;
            window.dispatchEvent(eventRes);
            return response;
          };
        };
        history.pushState = historyWrapper("pushState");
        history.replaceState = historyWrapper("replaceState");
        ["pushState", "replaceState", "popstate","hashchange"].forEach( function(eventType) {
          window.addEventListener(eventType, function() {
            window.parent.postMessage({'innerFrameUrl': window.location.href, 'fromInnerFrame': true}, "https://www.coursera.org");
          });
        });
        </script>
<script>window.parent.postMessage({'innerFrameUrl': window.location.href, 'fromInnerFrame': true}, "https://www.coursera.org");</script>
<script>require(['base/js/namespace'],function(Jupyter){Jupyter._target='_self';});</script>
<style>#ipython_notebook img{display:inline;background:none;width:inherit; padding-left:0;}</style>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXMathJax_Main, sans-serif;"></div></div></body></html>